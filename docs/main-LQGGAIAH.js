import{a as Kh,b as Qh,c as Jh,d as Yh,e as Xh}from"./chunk-BFP457WQ.js";import{$ as Et,$a as ne,A as ar,Aa as ta,Ab as Mt,B as Zy,Ba as S,Bb as ll,C as Yo,Ca as le,Cb as ul,D as Xr,Da as Lh,Db as wv,E as ev,Ea as uv,Eb as Ev,F as tv,Fa as il,Fb as Ci,G as Zr,Ga as cs,Gb as dl,H as Sn,Ha as Uh,I as kh,Ia as Re,J as nv,Ja as dv,K as tl,Ka as hv,L as es,La as Ti,M as Xo,Ma as fv,N as ts,Na as pv,O as Ce,Oa as rl,P as ns,Pa as ge,Q as iv,Qa as bt,R as ot,Ra as mv,S as Ge,Sa as ni,T as is,Ta as me,U as ue,Ua as Ye,V as Be,Va as Xe,W as rv,Wa as Ze,X as te,Xa as p,Y as Oh,Ya as m,Z as j,Za as W,_ as Q,_a as gt,a as Gy,aa as Zo,ab as Z,b as Hy,ba as ea,bb as pn,c as wt,ca as De,cb as y,d as Rh,da as qe,db as de,e as Ph,ea as Qt,eb as $e,f as Xn,fa as cr,fb as sl,g as on,ga as sv,gb as oe,h as Zc,ha as ov,hb as ae,i as Ky,ia as rs,ib as ce,j as An,ja as Zn,jb as ls,k as mt,ka as nl,kb as Me,l as Dt,la as ye,lb as gv,m as be,ma as ve,mb as na,n as X,na as ss,nb as ol,o as Jo,oa as os,ob as us,p as Qy,pa as Ii,pb as al,q as Jy,qa as ei,qb as jh,r as se,ra as Nh,rb as cl,s as Dh,sa as as,sb as Bh,t as $t,ta as ti,tb as qh,u as el,ua as av,ub as ds,v as Mh,va as Vh,vb as _v,w as Yy,wa as cv,wb as $h,x as Xy,xa as dt,xb as hs,y as Kt,ya as lv,yb as yv,z as bi,za as Fh,zb as vv}from"./chunk-YZ4EPUD7.js";import{a as xh}from"./chunk-EU2KAMEK.js";import{a as Av}from"./chunk-PWK4WGJW.js";import{A as Ae,B as mn,C as Rn,D as ml,E as Tv,G as lr,H as gl,J as _l,K as Cv,L as fs,M as yl,N as ht,O as tt,a as bv,d as zh,f as Wh,g as hl,h as ia,o as Gh,p as fl,s as pl,t as Iv,v as Hh}from"./chunk-XQTAZVN5.js";import{a as Y,b as je,e as Xc,f as E}from"./chunk-FO65GQC2.js";var sa=class{},wl=class{},ur=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let i=t.indexOf(":");if(i>0){let r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,i)=>{this.setHeaderEntries(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let o=this.headers.get(t);if(!o)return;o=o.filter(c=>s.indexOf(c)===-1),o.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}break}}setHeaderEntries(e,t){let i=(Array.isArray(t)?t:[t]).map(s=>s.toString()),r=e.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var ef=class{encodeKey(e){return Sv(e)}encodeValue(e){return Sv(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function HA(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let s=r.indexOf("="),[o,c]=s==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(c),t.set(o,l)}),t}var KA=/%(\d[a-f0-9])/gi,QA={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Sv(n){return encodeURIComponent(n).replace(KA,(e,t)=>QA[t]??e)}function vl(n){return`${n}`}var Ai=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ef,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=HA(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let i=e.fromObject[t],r=Array.isArray(i)?i.map(vl):[vl(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(i=>{let r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(vl(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let i=this.map.get(e.param)||[],r=i.indexOf(vl(e.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var tf=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function JA(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Rv(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function Pv(n){return typeof Blob<"u"&&n instanceof Blob}function xv(n){return typeof FormData<"u"&&n instanceof FormData}function YA(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var ra=class n{constructor(e,t,i,r){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(JA(this.method)||r?(this.body=i!==void 0?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ur,this.context??=new tf,!this.params)this.params=new Ai,this.urlWithParams=t;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Rv(this.body)||Pv(this.body)||xv(this.body)||YA(this.body)?this.body:this.body instanceof Ai?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||xv(this.body)?null:Pv(this.body)?this.body.type||null:Rv(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Ai?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=e.transferCache??this.transferCache,o=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,u=e.headers||this.headers,h=e.params||this.params,g=e.context??this.context;return e.setHeaders!==void 0&&(u=Object.keys(e.setHeaders).reduce((v,b)=>v.set(b,e.setHeaders[b]),u)),e.setParams&&(h=Object.keys(e.setParams).reduce((v,b)=>v.set(b,e.setParams[b]),h)),new n(t,i,o,{params:h,headers:u,context:g,reportProgress:l,responseType:r,withCredentials:c,transferCache:s})}},ps=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(ps||{}),oa=class{constructor(e,t=Il.Ok,i="OK"){this.headers=e.headers||new ur,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},nf=class n extends oa{constructor(e={}){super(e),this.type=ps.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},El=class n extends oa{constructor(e={}){super(e),this.type=ps.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},bl=class extends oa{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Il=function(n){return n[n.Continue=100]="Continue",n[n.SwitchingProtocols=101]="SwitchingProtocols",n[n.Processing=102]="Processing",n[n.EarlyHints=103]="EarlyHints",n[n.Ok=200]="Ok",n[n.Created=201]="Created",n[n.Accepted=202]="Accepted",n[n.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",n[n.NoContent=204]="NoContent",n[n.ResetContent=205]="ResetContent",n[n.PartialContent=206]="PartialContent",n[n.MultiStatus=207]="MultiStatus",n[n.AlreadyReported=208]="AlreadyReported",n[n.ImUsed=226]="ImUsed",n[n.MultipleChoices=300]="MultipleChoices",n[n.MovedPermanently=301]="MovedPermanently",n[n.Found=302]="Found",n[n.SeeOther=303]="SeeOther",n[n.NotModified=304]="NotModified",n[n.UseProxy=305]="UseProxy",n[n.Unused=306]="Unused",n[n.TemporaryRedirect=307]="TemporaryRedirect",n[n.PermanentRedirect=308]="PermanentRedirect",n[n.BadRequest=400]="BadRequest",n[n.Unauthorized=401]="Unauthorized",n[n.PaymentRequired=402]="PaymentRequired",n[n.Forbidden=403]="Forbidden",n[n.NotFound=404]="NotFound",n[n.MethodNotAllowed=405]="MethodNotAllowed",n[n.NotAcceptable=406]="NotAcceptable",n[n.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",n[n.RequestTimeout=408]="RequestTimeout",n[n.Conflict=409]="Conflict",n[n.Gone=410]="Gone",n[n.LengthRequired=411]="LengthRequired",n[n.PreconditionFailed=412]="PreconditionFailed",n[n.PayloadTooLarge=413]="PayloadTooLarge",n[n.UriTooLong=414]="UriTooLong",n[n.UnsupportedMediaType=415]="UnsupportedMediaType",n[n.RangeNotSatisfiable=416]="RangeNotSatisfiable",n[n.ExpectationFailed=417]="ExpectationFailed",n[n.ImATeapot=418]="ImATeapot",n[n.MisdirectedRequest=421]="MisdirectedRequest",n[n.UnprocessableEntity=422]="UnprocessableEntity",n[n.Locked=423]="Locked",n[n.FailedDependency=424]="FailedDependency",n[n.TooEarly=425]="TooEarly",n[n.UpgradeRequired=426]="UpgradeRequired",n[n.PreconditionRequired=428]="PreconditionRequired",n[n.TooManyRequests=429]="TooManyRequests",n[n.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",n[n.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",n[n.InternalServerError=500]="InternalServerError",n[n.NotImplemented=501]="NotImplemented",n[n.BadGateway=502]="BadGateway",n[n.ServiceUnavailable=503]="ServiceUnavailable",n[n.GatewayTimeout=504]="GatewayTimeout",n[n.HttpVersionNotSupported=505]="HttpVersionNotSupported",n[n.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",n[n.InsufficientStorage=507]="InsufficientStorage",n[n.LoopDetected=508]="LoopDetected",n[n.NotExtended=510]="NotExtended",n[n.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",n}(Il||{});function Zh(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var gn=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof ra)s=t;else{let l;r.headers instanceof ur?l=r.headers:l=new ur(r.headers);let u;r.params&&(r.params instanceof Ai?u=r.params:u=new Ai({fromObject:r.params})),s=new ra(t,i,r.body!==void 0?r.body:null,{headers:l,context:r.context,params:u,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let o=X(s).pipe(ar(l=>this.handler.handle(l)));if(t instanceof ra||r.observe==="events")return o;let c=o.pipe(Kt(l=>l instanceof El));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(se(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(se(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(se(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(se(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:new Ai().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,Zh(r,i))}post(t,i,r={}){return this.request("POST",t,Zh(r,i))}put(t,i,r={}){return this.request("PUT",t,Zh(r,i))}static{this.\u0275fac=function(i){return new(i||n)(j(sa))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})();function XA(n,e){return e(n)}function ZA(n,e,t){return(i,r)=>Zn(t,()=>e(i,s=>n(s,r)))}var kv=new te(""),eS=new te(""),tS=new te("");var Dv=(()=>{class n extends sa{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null,this.pendingTasks=Q(rl);let r=Q(tS,{optional:!0});this.backend=r??t}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(kv),...this.injector.get(eS,[])]));this.chain=r.reduceRight((s,o)=>ZA(s,o,this.injector),XA)}let i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(Zr(()=>this.pendingTasks.remove(i)))}static{this.\u0275fac=function(i){return new(i||n)(j(wl),j(rs))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})();var nS=/^\)\]\}',?\n/;function iS(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var Mv=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new Ge(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?be(i.\u0275loadImpl()):X(null)).pipe(Ce(()=>new wt(s=>{let o=i.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((M,x)=>o.setRequestHeader(M,x.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let M=t.detectContentTypeHeader();M!==null&&o.setRequestHeader("Content-Type",M)}if(t.responseType){let M=t.responseType.toLowerCase();o.responseType=M!=="json"?M:"text"}let c=t.serializeBody(),l=null,u=()=>{if(l!==null)return l;let M=o.statusText||"OK",x=new ur(o.getAllResponseHeaders()),B=iS(o)||t.url;return l=new nf({headers:x,status:o.status,statusText:M,url:B}),l},h=()=>{let{headers:M,status:x,statusText:B,url:H}=u(),F=null;x!==Il.NoContent&&(F=typeof o.response>"u"?o.responseText:o.response),x===0&&(x=F?Il.Ok:0);let G=x>=200&&x<300;if(t.responseType==="json"&&typeof F=="string"){let re=F;F=F.replace(nS,"");try{F=F!==""?JSON.parse(F):null}catch(ee){F=re,G&&(G=!1,F={error:ee,text:F})}}G?(s.next(new El({body:F,headers:M,status:x,statusText:B,url:H||void 0})),s.complete()):s.error(new bl({error:F,headers:M,status:x,statusText:B,url:H||void 0}))},g=M=>{let{url:x}=u(),B=new bl({error:M,status:o.status||0,statusText:o.statusText||"Unknown Error",url:x||void 0});s.error(B)},v=!1,b=M=>{v||(s.next(u()),v=!0);let x={type:ps.DownloadProgress,loaded:M.loaded};M.lengthComputable&&(x.total=M.total),t.responseType==="text"&&o.responseText&&(x.partialText=o.responseText),s.next(x)},O=M=>{let x={type:ps.UploadProgress,loaded:M.loaded};M.lengthComputable&&(x.total=M.total),s.next(x)};return o.addEventListener("load",h),o.addEventListener("error",g),o.addEventListener("timeout",g),o.addEventListener("abort",g),t.reportProgress&&(o.addEventListener("progress",b),c!==null&&o.upload&&o.upload.addEventListener("progress",O)),o.send(c),s.next({type:ps.Sent}),()=>{o.removeEventListener("error",g),o.removeEventListener("abort",g),o.removeEventListener("load",h),o.removeEventListener("timeout",g),t.reportProgress&&(o.removeEventListener("progress",b),c!==null&&o.upload&&o.upload.removeEventListener("progress",O)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(i){return new(i||n)(j(dl))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),Ov=new te(""),rS="XSRF-TOKEN",sS=new te("",{providedIn:"root",factory:()=>rS}),oS="X-XSRF-TOKEN",aS=new te("",{providedIn:"root",factory:()=>oS}),Tl=class{},cS=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=ul(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(i){return new(i||n)(j(Mt),j(dt),j(sS))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})();function lS(n,e){let t=n.url.toLowerCase();if(!Q(Ov)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let i=Q(Tl).getToken(),r=Q(aS);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),e(n)}function Nv(...n){let e=[gn,Mv,Dv,{provide:sa,useExisting:Dv},{provide:wl,useExisting:Mv},{provide:kv,useValue:lS,multi:!0},{provide:Ov,useValue:!0},{provide:Tl,useClass:cS}];for(let t of n)e.push(...t.\u0275providers);return cr(e)}var of=class extends vv{constructor(){super(...arguments),this.supportsDOMEvents=!0}},af=class n extends of{static makeCurrent(){yv(new n)}onAndCancel(e,t,i){return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=dS();return t==null?null:hS(t)}resetBaseElement(){aa=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ul(document.cookie,e)}},aa=null;function dS(){return aa=aa||document.querySelector("base"),aa?aa.getAttribute("href"):null}function hS(n){return new URL(n,document.baseURI).pathname}var fS=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),Al=new te(""),Lv=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(s=>s.supports(t)),!i)throw new Ge(5101,!1);return this._eventNameToPlugin.set(t,i),i}static{this.\u0275fac=function(i){return new(i||n)(j(Al),j(Re))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),ca=class{constructor(e){this._doc=e}},rf="ng-app-id",Uv=(()=>{class n{constructor(t,i,r,s={}){this.doc=t,this.appId=i,this.nonce=r,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ci(s),this.resetHostNodes()}addStyles(t){for(let i of t)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(t){for(let i of t)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(i=>i.remove()),t.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){let i=this.styleRef;i.get(t)?.elements?.forEach(r=>r.remove()),i.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${rf}="${this.appId}"]`);if(t?.length){let i=new Map;return t.forEach(r=>{r.textContent!=null&&i.set(r.textContent,r)}),i}return null}changeUsageCount(t,i){let r=this.styleRef;if(r.has(t)){let s=r.get(t);return s.usage+=i,s.usage}return r.set(t,{usage:i,elements:[]}),i}getStyleElement(t,i){let r=this.styleNodesInDOM,s=r?.get(i);if(s?.parentNode===t)return r.delete(i),s.removeAttribute(rf),s;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(rf,this.appId),t.appendChild(o),o}}addStyleToHost(t,i){let r=this.getStyleElement(t,i),s=this.styleRef,o=s.get(i)?.elements;o?o.push(r):s.set(i,{elements:[r],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(i){return new(i||n)(j(Mt),j(Vh),j(Fh,8),j(dt))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),sf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},uf=/%COMP%/g,jv="%COMP%",pS=`_nghost-${jv}`,mS=`_ngcontent-${jv}`,gS=!0,_S=new te("",{providedIn:"root",factory:()=>gS});function yS(n){return mS.replace(uf,n)}function vS(n){return pS.replace(uf,n)}function Bv(n,e){return e.map(t=>t.replace(uf,n))}var Sl=(()=>{class n{constructor(t,i,r,s,o,c,l,u=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Ci(c),this.defaultRenderer=new la(t,o,l,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Zo.ShadowDom&&(i=je(Y({},i),{encapsulation:Zo.Emulated}));let r=this.getOrCreateRenderer(t,i);return r instanceof Rl?r.applyToHost(t):r instanceof ua&&r.applyStyles(),r}getOrCreateRenderer(t,i){let r=this.rendererByCompId,s=r.get(i.id);if(!s){let o=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case Zo.Emulated:s=new Rl(l,u,i,this.appId,h,o,c,g);break;case Zo.ShadowDom:return new cf(l,u,t,i,o,c,this.nonce,g);default:s=new ua(l,u,i,h,o,c,g);break}r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(i){return new(i||n)(j(Lv),j(Uv),j(Vh),j(_S),j(Mt),j(dt),j(Re),j(Fh))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),la=class{constructor(e,t,i,r){this.eventManager=e,this.doc=t,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(sf[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Vv(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(Vv(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i=typeof e=="string"?this.doc.querySelector(e):e;if(!i)throw new Ge(-5104,!1);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;let s=sf[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){let r=sf[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(ta.DashCase|ta.Important)?e.style.setProperty(t,i,r&ta.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&ta.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e!=null&&(e[t]=i)}setValue(e,t){e.nodeValue=t}listen(e,t,i){if(typeof e=="string"&&(e=hs().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(i))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Vv(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var cf=class extends la{constructor(e,t,i,r,s,o,c,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=Bv(r.id,r.styles);for(let h of u){let g=document.createElement("style");c&&g.setAttribute("nonce",c),g.textContent=h,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ua=class extends la{constructor(e,t,i,r,s,o,c,l){super(e,s,o,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?Bv(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Rl=class extends ua{constructor(e,t,i,r,s,o,c,l){let u=r+"-"+i.id;super(e,t,i,s,o,c,l,u),this.contentAttr=yS(u),this.hostAttr=vS(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}},wS=(()=>{class n extends ca{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static{this.\u0275fac=function(i){return new(i||n)(j(Mt))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),Fv=["alt","control","meta","shift"],ES={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},bS={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},IS=(()=>{class n extends ca{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,i,r){let s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hs().onAndCancel(t,s.domEventName,o))}static parseEventName(t){let i=t.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let s=n._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),Fv.forEach(u=>{let h=i.indexOf(u);h>-1&&(i.splice(h,1),o+=u+".")}),o+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=r,l.fullKey=o,l}static matchEventFullKeyCode(t,i){let r=ES[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Fv.forEach(o=>{if(o!==r){let c=bS[o];c(t)&&(s+=o+".")}}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(i){return new(i||n)(j(Mt))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})();function qv(n,e){return _v(Y({rootComponent:n},TS(e)))}function TS(n){return{appProviders:[...PS,...n?.providers??[]],platformProviders:RS}}function CS(){af.makeCurrent()}function AS(){return new Nh}function SS(){return av(document),document}var RS=[{provide:dt,useValue:Ev},{provide:cv,useValue:CS,multi:!0},{provide:Mt,useFactory:SS,deps:[]}];var PS=[{provide:ov,useValue:"root"},{provide:Nh,useFactory:AS,deps:[]},{provide:Al,useClass:wS,multi:!0,deps:[Mt,Re,dt]},{provide:Al,useClass:IS,multi:!0,deps:[Mt]},Sl,Uv,Lv,{provide:il,useExisting:Sl},{provide:dl,useClass:fS,deps:[]},[]];var $v=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(i){return new(i||n)(j(Mt))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var xS={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0,doubletap:!0},lf=new te("HammerGestureConfig"),zv=new te("HammerLoader"),DS=(()=>{class n{constructor(){this.events=[],this.overrides={}}buildHammer(t){let i=new Hammer(t,this.options);i.get("pinch").set({enable:!0}),i.get("rotate").set({enable:!0});for(let r in this.overrides)i.get(r).set(this.overrides[r]);return i}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),MS=(()=>{class n extends ca{constructor(t,i,r,s){super(t),this._config=i,this.console=r,this.loader=s,this._loaderPromise=null}supports(t){return!(!xS.hasOwnProperty(t.toLowerCase())&&!this.isCustomEvent(t)||!window.Hammer&&!this.loader)}addEventListener(t,i,r){let s=this.manager.getZone();if(i=i.toLowerCase(),!window.Hammer&&this.loader){this._loaderPromise=this._loaderPromise||s.runOutsideAngular(()=>this.loader());let o=!1,c=()=>{o=!0};return s.runOutsideAngular(()=>this._loaderPromise.then(()=>{if(!window.Hammer){c=()=>{};return}o||(c=this.addEventListener(t,i,r))}).catch(()=>{c=()=>{}})),()=>{c()}}return s.runOutsideAngular(()=>{let o=this._config.buildHammer(t),c=function(l){s.runGuarded(function(){r(l)})};return o.on(i,c),()=>{o.off(i,c),typeof o.destroy=="function"&&o.destroy()}})}isCustomEvent(t){return this._config.events.indexOf(t)>-1}static{this.\u0275fac=function(i){return new(i||n)(j(Mt),j(lf),j(us),j(zv,8))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),Wv=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=qe({type:n})}static{this.\u0275inj=Be({providers:[{provide:Al,useClass:MS,multi:!0,deps:[Mt,lf,us,[new Et,zv]]},{provide:lf,useClass:DS,deps:[]}]})}}return n})();var pe="primary",Ca=Symbol("RouteTitle"),mf=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function vs(n){return new mf(n)}function NS(n,e,t){let i=t.path.split("/");if(i.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||i.length<n.length))return null;let r={};for(let s=0;s<i.length;s++){let o=i[s],c=n[s];if(o.startsWith(":"))r[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function VS(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Pn(n[t],e[t]))return!1;return!0}function Pn(n,e){let t=n?gf(n):void 0,i=e?gf(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!Yv(n[r],e[r]))return!1;return!0}function gf(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Yv(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}else return n===e}function Xv(n){return n.length>0?n[n.length-1]:null}function Pi(n){return Qy(n)?n:al(n)?be(Promise.resolve(n)):X(n)}var FS={exact:ew,subset:tw},Zv={exact:LS,subset:US,ignored:()=>!0};function Gv(n,e,t){return FS[t.paths](n.root,e.root,t.matrixParams)&&Zv[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function LS(n,e){return Pn(n,e)}function ew(n,e,t){if(!hr(n.segments,e.segments)||!Dl(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let i in e.children)if(!n.children[i]||!ew(n.children[i],e.children[i],t))return!1;return!0}function US(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Yv(n[t],e[t]))}function tw(n,e,t){return nw(n,e,e.segments,t)}function nw(n,e,t,i){if(n.segments.length>t.length){let r=n.segments.slice(0,t.length);return!(!hr(r,t)||e.hasChildren()||!Dl(r,t,i))}else if(n.segments.length===t.length){if(!hr(n.segments,t)||!Dl(n.segments,t,i))return!1;for(let r in e.children)if(!n.children[r]||!tw(n.children[r],e.children[r],i))return!1;return!0}else{let r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!hr(n.segments,r)||!Dl(n.segments,r,i)||!n.children[pe]?!1:nw(n.children[pe],e,s,i)}}function Dl(n,e,t){return e.every((i,r)=>Zv[t](n[r].parameters,i.parameters))}var Si=class{constructor(e=new Pe([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=vs(this.queryParams),this._queryParamMap}toString(){return qS.serialize(this)}},Pe=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ml(this)}},dr=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=vs(this.parameters),this._parameterMap}toString(){return rw(this)}};function jS(n,e){return hr(n,e)&&n.every((t,i)=>Pn(t.parameters,e[i].parameters))}function hr(n,e){return n.length!==e.length?!1:n.every((t,i)=>t.path===e[i].path)}function BS(n,e){let t=[];return Object.entries(n.children).forEach(([i,r])=>{i===pe&&(t=t.concat(e(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==pe&&(t=t.concat(e(r,i)))}),t}var qf=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:()=>new Ol,providedIn:"root"})}}return n})(),Ol=class{parse(e){let t=new yf(e);return new Si(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${da(e.root,!0)}`,i=WS(e.queryParams),r=typeof e.fragment=="string"?`#${$S(e.fragment)}`:"";return`${t}${i}${r}`}},qS=new Ol;function Ml(n){return n.segments.map(e=>rw(e)).join("/")}function da(n,e){if(!n.hasChildren())return Ml(n);if(e){let t=n.children[pe]?da(n.children[pe],!1):"",i=[];return Object.entries(n.children).forEach(([r,s])=>{r!==pe&&i.push(`${r}:${da(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}else{let t=BS(n,(i,r)=>r===pe?[da(n.children[pe],!1)]:[`${r}:${da(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[pe]!=null?`${Ml(n)}/${t[0]}`:`${Ml(n)}/(${t.join("//")})`}}function iw(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pl(n){return iw(n).replace(/%3B/gi,";")}function $S(n){return encodeURI(n)}function _f(n){return iw(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function kl(n){return decodeURIComponent(n)}function Hv(n){return kl(n.replace(/\+/g,"%20"))}function rw(n){return`${_f(n.path)}${zS(n.parameters)}`}function zS(n){return Object.entries(n).map(([e,t])=>`;${_f(e)}=${_f(t)}`).join("")}function WS(n){let e=Object.entries(n).map(([t,i])=>Array.isArray(i)?i.map(r=>`${Pl(t)}=${Pl(r)}`).join("&"):`${Pl(t)}=${Pl(i)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var GS=/^[^\/()?;#]+/;function df(n){let e=n.match(GS);return e?e[0]:""}var HS=/^[^\/()?;=#]+/;function KS(n){let e=n.match(HS);return e?e[0]:""}var QS=/^[^=?&#]+/;function JS(n){let e=n.match(QS);return e?e[0]:""}var YS=/^[^&#]+/;function XS(n){let e=n.match(YS);return e?e[0]:""}var yf=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Pe([],{}):new Pe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[pe]=new Pe(e,t)),i}parseSegment(){let e=df(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Ge(4009,!1);return this.capture(e),new dr(kl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=KS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let r=df(this.remaining);r&&(i=r,this.capture(i))}e[kl(t)]=kl(i)}parseQueryParam(e){let t=JS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){let o=XS(this.remaining);o&&(i=o,this.capture(i))}let r=Hv(t),s=Hv(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=df(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new Ge(4010,!1);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=pe);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[pe]:new Pe([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Ge(4011,!1)}};function sw(n){return n.segments.length>0?new Pe([],{[pe]:n}):n}function ow(n){let e={};for(let[i,r]of Object.entries(n.children)){let s=ow(r);if(i===pe&&s.segments.length===0&&s.hasChildren())for(let[o,c]of Object.entries(s.children))e[o]=c;else(s.segments.length>0||s.hasChildren())&&(e[i]=s)}let t=new Pe(n.segments,e);return ZS(t)}function ZS(n){if(n.numberOfChildren===1&&n.children[pe]){let e=n.children[pe];return new Pe(n.segments.concat(e.segments),e.children)}return n}function ws(n){return n instanceof Si}function e1(n,e,t=null,i=null){let r=aw(n);return cw(r,e,t,i)}function aw(n){let e;function t(s){let o={};for(let l of s.children){let u=t(l);o[l.outlet]=u}let c=new Pe(s.url,o);return s===n&&(e=c),c}let i=t(n.root),r=sw(i);return e??r}function cw(n,e,t,i){let r=n;for(;r.parent;)r=r.parent;if(e.length===0)return hf(r,r,r,t,i);let s=t1(e);if(s.toRoot())return hf(r,r,new Pe([],{}),t,i);let o=n1(s,r,n),c=o.processChildren?pa(o.segmentGroup,o.index,s.commands):uw(o.segmentGroup,o.index,s.commands);return hf(r,o.segmentGroup,c,t,i)}function Nl(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function _a(n){return typeof n=="object"&&n!=null&&n.outlets}function hf(n,e,t,i,r){let s={};i&&Object.entries(i).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(h=>`${h}`):`${u}`});let o;n===e?o=t:o=lw(n,e,t);let c=sw(ow(o));return new Si(c,s,r)}function lw(n,e,t){let i={};return Object.entries(n.children).forEach(([r,s])=>{s===e?i[r]=t:i[r]=lw(s,e,t)}),new Pe(n.segments,i)}var Vl=class{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Nl(i[0]))throw new Ge(4003,!1);let r=i.find(_a);if(r&&r!==Xv(i))throw new Ge(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function t1(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Vl(!0,0,n);let e=0,t=!1,i=n.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,u])=>{c[l]=typeof u=="string"?u.split("/"):u}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&r.push(c))}),r):[...r,s]},[]);return new Vl(t,e,i)}var _s=class{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}};function n1(n,e,t){if(n.isAbsolute)return new _s(e,!0,0);if(!t)return new _s(e,!1,NaN);if(t.parent===null)return new _s(t,!0,0);let i=Nl(n.commands[0])?0:1,r=t.segments.length-1+i;return i1(t,r,n.numberOfDoubleDots)}function i1(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Ge(4005,!1);r=i.segments.length}return new _s(i,!1,r-s)}function r1(n){return _a(n[0])?n[0].outlets:{[pe]:n}}function uw(n,e,t){if(n??=new Pe([],{}),n.segments.length===0&&n.hasChildren())return pa(n,e,t);let i=s1(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let s=new Pe(n.segments.slice(0,i.pathIndex),{});return s.children[pe]=new Pe(n.segments.slice(i.pathIndex),n.children),pa(s,0,r)}else return i.match&&r.length===0?new Pe(n.segments,{}):i.match&&!n.hasChildren()?vf(n,e,t):i.match?pa(n,0,r):vf(n,e,t)}function pa(n,e,t){if(t.length===0)return new Pe(n.segments,{});{let i=r1(t),r={};if(Object.keys(i).some(s=>s!==pe)&&n.children[pe]&&n.numberOfChildren===1&&n.children[pe].segments.length===0){let s=pa(n.children[pe],e,t);return new Pe(n.segments,s.children)}return Object.entries(i).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=uw(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{i[s]===void 0&&(r[s]=o)}),new Pe(n.segments,r)}}function s1(n,e,t){let i=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;let o=n.segments[r],c=t[i];if(_a(c))break;let l=`${c}`,u=i<t.length-1?t[i+1]:null;if(r>0&&l===void 0)break;if(l&&u&&typeof u=="object"&&u.outlets===void 0){if(!Qv(l,u,o))return s;i+=2}else{if(!Qv(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function vf(n,e,t){let i=n.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(_a(s)){let l=o1(s.outlets);return new Pe(i,l)}if(r===0&&Nl(t[0])){let l=n.segments[e];i.push(new dr(l.path,Kv(t[0]))),r++;continue}let o=_a(s)?s.outlets[pe]:`${s}`,c=r<t.length-1?t[r+1]:null;o&&c&&Nl(c)?(i.push(new dr(o,Kv(c))),r+=2):(i.push(new dr(o,{})),r++)}return new Pe(i,{})}function o1(n){let e={};return Object.entries(n).forEach(([t,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(e[t]=vf(new Pe([],{}),0,i))}),e}function Kv(n){let e={};return Object.entries(n).forEach(([t,i])=>e[t]=`${i}`),e}function Qv(n,e,t){return n==t.path&&Pn(e,t.parameters)}var ma="imperative",It=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(It||{}),an=class{constructor(e,t){this.id=e,this.url=t}},ya=class extends an{constructor(e,t,i="imperative",r=null){super(e,t),this.type=It.NavigationStart,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},fr=class extends an{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=It.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Yt=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Yt||{}),wf=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(wf||{}),Ri=class extends an{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=It.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},pr=class extends an{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=It.NavigationSkipped}},va=class extends an{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=It.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Fl=class extends an{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=It.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ef=class extends an{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=It.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bf=class extends an{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=It.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},If=class extends an{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=It.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tf=class extends an{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=It.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cf=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Af=class{constructor(e){this.route=e,this.type=It.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Sf=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Rf=class{constructor(e){this.snapshot=e,this.type=It.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pf=class{constructor(e){this.snapshot=e,this.type=It.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xf=class{constructor(e){this.snapshot=e,this.type=It.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var wa=class{},Ea=class{constructor(e){this.url=e}};var Df=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new $l,this.attachRef=null}},$l=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){let r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){let i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new Df,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ll=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Mf(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){let t=Mf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=kf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return kf(e,this._root).map(t=>t.value)}};function Mf(n,e){if(n===e.value)return e;for(let t of e.children){let i=Mf(n,t);if(i)return i}return null}function kf(n,e){if(n===e.value)return[e];for(let t of e.children){let i=kf(n,t);if(i.length)return i.unshift(e),i}return[]}var Jt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function gs(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Ul=class extends Ll{constructor(e,t){super(e),this.snapshot=t,zf(this,e)}toString(){return this.snapshot.toString()}};function dw(n){let e=a1(n),t=new on([new dr("",{})]),i=new on({}),r=new on({}),s=new on({}),o=new on(""),c=new xn(t,i,s,o,r,pe,n,e.root);return c.snapshot=e.root,new Ul(new Jt(c,[]),e)}function a1(n){let e={},t={},i={},r="",s=new ba([],e,i,r,t,pe,n,null,{});return new jl("",new Jt(s,[]))}var xn=class{constructor(e,t,i,r,s,o,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(se(u=>u[Ca]))??X(void 0),this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(se(e=>vs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(se(e=>vs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $f(n,e,t="emptyOnly"){let i,{routeConfig:r}=n;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?i={params:Y(Y({},e.params),n.params),data:Y(Y({},e.data),n.data),resolve:Y(Y(Y(Y({},n.data),e.data),r?.data),n._resolvedData)}:i={params:Y({},n.params),data:Y({},n.data),resolve:Y(Y({},n.data),n._resolvedData??{})},r&&fw(r)&&(i.resolve[Ca]=r.title),i}var ba=class{get title(){return this.data?.[Ca]}constructor(e,t,i,r,s,o,c,l,u){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=c,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=vs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=vs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(i=>i.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},jl=class extends Ll{constructor(e,t){super(t),this.url=e,zf(this,t)}toString(){return hw(this._root)}};function zf(n,e){e.value._routerState=n,e.children.forEach(t=>zf(n,t))}function hw(n){let e=n.children.length>0?` { ${n.children.map(hw).join(", ")} } `:"";return`${n.value}${e}`}function ff(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Pn(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Pn(e.params,t.params)||n.paramsSubject.next(t.params),VS(e.url,t.url)||n.urlSubject.next(t.url),Pn(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Of(n,e){let t=Pn(n.params,e.params)&&jS(n.url,e.url),i=!n.parent!=!e.parent;return t&&!i&&(!n.parent||Of(n.parent,e.parent))}function fw(n){return typeof n.title=="string"||n.title===null}var Wf=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new ti,this.deactivateEvents=new ti,this.attachEvents=new ti,this.detachEvents=new ti,this.parentContexts=Q($l),this.location=Q(dv),this.changeDetector=Q(ds),this.environmentInjector=Q(rs),this.inputBinder=Q(Gf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ge(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Ge(4013,!1);this._activatedRoute=t;let r=this.location,o=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Nf(t,c,r.injector);this.activated=r.createComponent(o,{index:r.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275dir=Qt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[nl]})}}return n})(),Nf=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===xn?this.route:e===$l?this.childContexts:this.parent.get(e,t)}},Gf=new te("");function c1(n,e,t){let i=Ia(n,e._root,t?t._root:void 0);return new Ul(i,e)}function Ia(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let i=t.value;i._futureSnapshot=e.value;let r=l1(n,e,t);return new Jt(i,r)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>Ia(n,c)),o}}let i=u1(e.value),r=e.children.map(s=>Ia(n,s));return new Jt(i,r)}}function l1(n,e,t){return e.children.map(i=>{for(let r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return Ia(n,i,r);return Ia(n,i)})}function u1(n){return new xn(new on(n.url),new on(n.params),new on(n.queryParams),new on(n.fragment),new on(n.data),n.outlet,n.component,n)}var pw="ngNavigationCancelingError";function mw(n,e){let{redirectTo:t,navigationBehaviorOptions:i}=ws(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=gw(!1,Yt.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function gw(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[pw]=!0,t.cancellationCode=e,t}function d1(n){return _w(n)&&ws(n.url)}function _w(n){return!!n&&n[pw]}var h1=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["ng-component"]],standalone:!0,features:[Me],decls:1,vars:0,template:function(i,r){i&1&&W(0,"router-outlet")},dependencies:[Wf],encapsulation:2})}}return n})();function f1(n,e){return n.providers&&!n._injector&&(n._injector=pv(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Hf(n){let e=n.children&&n.children.map(Hf),t=e?je(Y({},n),{children:e}):Y({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==pe&&(t.component=h1),t}function Dn(n){return n.outlet||pe}function p1(n,e){let t=n.filter(i=>Dn(i)===e);return t.push(...n.filter(i=>Dn(i)!==e)),t}function Aa(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var m1=(n,e,t,i)=>se(r=>(new Vf(e,r.targetRouterState,r.currentRouterState,t,i).activate(n),r)),Vf=class{constructor(e,t,i,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),ff(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){let r=gs(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=gs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(i&&i.outlet){let o=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=gs(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(e,t,i){let r=gs(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new xf(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Rf(e.value.snapshot))}activateRoutes(e,t,i){let r=e.value,s=t?t.value:null;if(ff(r),r===s)if(r.component){let o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){let o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),ff(c.route.value),this.activateChildRoutes(e,null,o.children)}else{let c=Aa(r.snapshot);o.attachRef=null,o.route=r,o.injector=c,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}},Bl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ys=class{constructor(e,t){this.component=e,this.route=t}};function g1(n,e,t){let i=n._root,r=e?e._root:null;return ha(i,r,t,[i.value])}function _1(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function bs(n,e){let t=Symbol(),i=e.get(n,t);return i===t?typeof n=="function"&&!rv(n)?n:e.get(n):i}function ha(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=gs(e);return n.children.forEach(o=>{y1(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,c])=>ga(c,t.getContext(o),r)),r}function y1(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=v1(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Bl(i)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ha(n,e,c?c.children:null,i,r):ha(n,e,t,i,r),l&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new ys(c.outlet.component,o))}else o&&ga(e,c,r),r.canActivateChecks.push(new Bl(i)),s.component?ha(n,null,c?c.children:null,i,r):ha(n,null,t,i,r);return r}function v1(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!hr(n.url,e.url);case"pathParamsOrQueryParamsChange":return!hr(n.url,e.url)||!Pn(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Of(n,e)||!Pn(n.queryParams,e.queryParams);case"paramsChange":default:return!Of(n,e)}}function ga(n,e,t){let i=gs(n),r=n.value;Object.entries(i).forEach(([s,o])=>{r.component?e?ga(o,e.children.getContext(s),t):ga(o,null,t):ga(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ys(e.outlet.component,r)):t.canDeactivateChecks.push(new ys(null,r)):t.canDeactivateChecks.push(new ys(null,r))}function Sa(n){return typeof n=="function"}function w1(n){return typeof n=="boolean"}function E1(n){return n&&Sa(n.canLoad)}function b1(n){return n&&Sa(n.canActivate)}function I1(n){return n&&Sa(n.canActivateChild)}function T1(n){return n&&Sa(n.canDeactivate)}function C1(n){return n&&Sa(n.canMatch)}function yw(n){return n instanceof Jy||n?.name==="EmptyError"}var xl=Symbol("INITIAL_VALUE");function Es(){return Ce(n=>Dh(n.map(e=>e.pipe(Xr(1),ts(xl)))).pipe(se(e=>{for(let t of e)if(t!==!0){if(t===xl)return xl;if(t===!1||t instanceof Si)return t}return!0}),Kt(e=>e!==xl),Xr(1)))}function A1(n,e){return $t(t=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?X(je(Y({},t),{guardsResult:!0})):S1(o,i,r,n).pipe($t(c=>c&&w1(c)?R1(i,s,n,e):X(c)),se(c=>je(Y({},t),{guardsResult:c})))})}function S1(n,e,t,i){return be(n).pipe($t(r=>k1(r.component,r.route,t,e,i)),Sn(r=>r!==!0,!0))}function R1(n,e,t,i){return be(e).pipe(ar(r=>el(x1(r.route.parent,i),P1(r.route,i),M1(n,r.path,t),D1(n,r.route,t))),Sn(r=>r!==!0,!0))}function P1(n,e){return n!==null&&e&&e(new Pf(n)),X(!0)}function x1(n,e){return n!==null&&e&&e(new Sf(n)),X(!0)}function D1(n,e,t){let i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||i.length===0)return X(!0);let r=i.map(s=>Mh(()=>{let o=Aa(e)??t,c=bs(s,o),l=b1(c)?c.canActivate(e,n):Zn(o,()=>c(e,n));return Pi(l).pipe(Sn())}));return X(r).pipe(Es())}function M1(n,e,t){let i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>_1(o)).filter(o=>o!==null).map(o=>Mh(()=>{let c=o.guards.map(l=>{let u=Aa(o.node)??t,h=bs(l,u),g=I1(h)?h.canActivateChild(i,n):Zn(u,()=>h(i,n));return Pi(g).pipe(Sn())});return X(c).pipe(Es())}));return X(s).pipe(Es())}function k1(n,e,t,i,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return X(!0);let o=s.map(c=>{let l=Aa(e)??r,u=bs(c,l),h=T1(u)?u.canDeactivate(n,e,t,i):Zn(l,()=>u(n,e,t,i));return Pi(h).pipe(Sn())});return X(o).pipe(Es())}function O1(n,e,t,i){let r=e.canLoad;if(r===void 0||r.length===0)return X(!0);let s=r.map(o=>{let c=bs(o,n),l=E1(c)?c.canLoad(e,t):Zn(n,()=>c(e,t));return Pi(l)});return X(s).pipe(Es(),vw(i))}function vw(n){return Hy(ot(e=>{if(ws(e))throw mw(n,e)}),se(e=>e===!0))}function N1(n,e,t,i){let r=e.canMatch;if(!r||r.length===0)return X(!0);let s=r.map(o=>{let c=bs(o,n),l=C1(c)?c.canMatch(e,t):Zn(n,()=>c(e,t));return Pi(l)});return X(s).pipe(Es(),vw(i))}var Ta=class{constructor(e){this.segmentGroup=e||null}},ql=class extends Error{constructor(e){super(),this.urlTree=e}};function ms(n){return Jo(new Ta(n))}function V1(n){return Jo(new Ge(4e3,!1))}function F1(n){return Jo(gw(!1,Yt.GuardRejected))}var Ff=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return X(i);if(r.numberOfChildren>1||!r.children[pe])return V1(e.redirectTo);r=r.children[pe]}}applyRedirectCommands(e,t,i){let r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i);if(t.startsWith("/"))throw new ql(r);return r}applyRedirectCreateUrlTree(e,t,i,r){let s=this.createSegmentGroup(e,t.root,i,r);return new Si(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let i={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s.startsWith(":")){let c=s.substring(1);i[r]=t[c]}else i[r]=s}),i}createSegmentGroup(e,t,i,r){let s=this.createSegments(e,t.segments,i,r),o={};return Object.entries(t.children).forEach(([c,l])=>{o[c]=this.createSegmentGroup(e,l,i,r)}),new Pe(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){let r=i[t.path.substring(1)];if(!r)throw new Ge(4001,!1);return r}findOrReturn(e,t){let i=0;for(let r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}},Lf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function L1(n,e,t,i,r){let s=Kf(n,e,t);return s.matched?(i=f1(e,i),N1(i,e,t,r).pipe(se(o=>o===!0?s:Y({},Lf)))):X(s)}function Kf(n,e,t){if(e.path==="**")return U1(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?Y({},Lf):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||NS)(t,n,e);if(!r)return Y({},Lf);let s={};Object.entries(r.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let o=r.consumed.length>0?Y(Y({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function U1(n){return{matched:!0,parameters:n.length>0?Xv(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Jv(n,e,t,i){return t.length>0&&q1(n,t,i)?{segmentGroup:new Pe(e,B1(i,new Pe(t,n.children))),slicedSegments:[]}:t.length===0&&$1(n,t,i)?{segmentGroup:new Pe(n.segments,j1(n,t,i,n.children)),slicedSegments:t}:{segmentGroup:new Pe(n.segments,n.children),slicedSegments:t}}function j1(n,e,t,i){let r={};for(let s of t)if(zl(n,e,s)&&!i[Dn(s)]){let o=new Pe([],{});r[Dn(s)]=o}return Y(Y({},i),r)}function B1(n,e){let t={};t[pe]=e;for(let i of n)if(i.path===""&&Dn(i)!==pe){let r=new Pe([],{});t[Dn(i)]=r}return t}function q1(n,e,t){return t.some(i=>zl(n,e,i)&&Dn(i)!==pe)}function $1(n,e,t){return t.some(i=>zl(n,e,i))}function zl(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function z1(n,e,t,i){return Dn(n)!==i&&(i===pe||!zl(e,t,n))?!1:Kf(e,n,t).matched}function W1(n,e,t){return e.length===0&&!n.children[t]}var Uf=class{};function G1(n,e,t,i,r,s,o="emptyOnly"){return new jf(n,e,t,i,r,o,s).recognize()}var H1=31,jf=class{constructor(e,t,i,r,s,o,c){this.injector=e,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new Ff(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Ge(4002,`'${e.segmentGroup}'`)}recognize(){let e=Jv(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(se(t=>{let i=new ba([],Object.freeze({}),Object.freeze(Y({},this.urlTree.queryParams)),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),r=new Jt(i,t),s=new jl("",r),o=e1(i,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,pe).pipe(bi(i=>{if(i instanceof ql)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Ta?this.noMatchError(i):i}))}inheritParamsAndData(e,t){let i=e.value,r=$f(i,t,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,i))}processSegmentGroup(e,t,i,r){return i.segments.length===0&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r,!0).pipe(se(s=>s instanceof Jt?[s]:[]))}processChildren(e,t,i){let r=[];for(let s of Object.keys(i.children))s==="primary"?r.unshift(s):r.push(s);return be(r).pipe(ar(s=>{let o=i.children[s],c=p1(t,s);return this.processSegmentGroup(e,c,o,s)}),es((s,o)=>(s.push(...o),s)),Yo(null),nv(),$t(s=>{if(s===null)return ms(i);let o=ww(s);return K1(o),X(o)}))}processSegment(e,t,i,r,s,o){return be(t).pipe(ar(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,i,r,s,o).pipe(bi(l=>{if(l instanceof Ta)return X(null);throw l}))),Sn(c=>!!c),bi(c=>{if(yw(c))return W1(i,r,s)?X(new Uf):ms(i);throw c}))}processSegmentAgainstRoute(e,t,i,r,s,o,c){return z1(i,r,s,o)?i.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,i,s,o):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,i,s,o):ms(r):ms(r)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){let{matched:c,consumedSegments:l,positionalParamSegments:u,remainingSegments:h}=Kf(t,r,s);if(!c)return ms(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>H1&&(this.allowRedirects=!1));let g=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,u);return this.applyRedirects.lineralizeSegments(r,g).pipe($t(v=>this.processSegment(e,i,t,v.concat(h),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){let o=L1(t,i,r,e,this.urlSerializer);return i.path==="**"&&(t.children={}),o.pipe(Ce(c=>c.matched?(e=i._injector??e,this.getChildConfig(e,i,r).pipe(Ce(({routes:l})=>{let u=i._loadedInjector??e,{consumedSegments:h,remainingSegments:g,parameters:v}=c,b=new ba(h,v,Object.freeze(Y({},this.urlTree.queryParams)),this.urlTree.fragment,J1(i),Dn(i),i.component??i._loadedComponent??null,i,Y1(i)),{segmentGroup:O,slicedSegments:M}=Jv(t,h,g,l);if(M.length===0&&O.hasChildren())return this.processChildren(u,l,O).pipe(se(B=>B===null?null:new Jt(b,B)));if(l.length===0&&M.length===0)return X(new Jt(b,[]));let x=Dn(i)===s;return this.processSegment(u,l,O,M,x?pe:s,!0).pipe(se(B=>new Jt(b,B instanceof Jt?[B]:[])))}))):ms(t)))}getChildConfig(e,t,i){return t.children?X({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?X({routes:t._loadedRoutes,injector:t._loadedInjector}):O1(e,t,i,this.urlSerializer).pipe($t(r=>r?this.configLoader.loadChildren(e,t).pipe(ot(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):F1(t))):X({routes:[],injector:e})}};function K1(n){n.sort((e,t)=>e.value.outlet===pe?-1:t.value.outlet===pe?1:e.value.outlet.localeCompare(t.value.outlet))}function Q1(n){let e=n.value.routeConfig;return e&&e.path===""}function ww(n){let e=[],t=new Set;for(let i of n){if(!Q1(i)){e.push(i);continue}let r=e.find(s=>i.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...i.children),t.add(r)):e.push(i)}for(let i of t){let r=ww(i.children);e.push(new Jt(i.value,r))}return e.filter(i=>!t.has(i))}function J1(n){return n.data||{}}function Y1(n){return n.resolve||{}}function X1(n,e,t,i,r,s){return $t(o=>G1(n,e,t,i,o.extractedUrl,r,s).pipe(se(({state:c,tree:l})=>je(Y({},o),{targetSnapshot:c,urlAfterRedirects:l}))))}function Z1(n,e){return $t(t=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return X(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let u of Ew(l))o.add(u);let c=0;return be(o).pipe(ar(l=>s.has(l)?eR(l,i,n,e):(l.data=$f(l,l.parent,n).resolve,X(void 0))),ot(()=>c++),kh(1),$t(l=>c===o.size?X(t):An))})}function Ew(n){let e=n.children.map(t=>Ew(t)).flat();return[n,...e]}function eR(n,e,t,i){let r=n.routeConfig,s=n._resolve;return r?.title!==void 0&&!fw(r)&&(s[Ca]=r.title),tR(s,n,e,i).pipe(se(o=>(n._resolvedData=o,n.data=$f(n,n.parent,t).resolve,null)))}function tR(n,e,t,i){let r=gf(n);if(r.length===0)return X({});let s={};return be(r).pipe($t(o=>nR(n[o],e,t,i).pipe(Sn(),ot(c=>{s[o]=c}))),kh(1),ev(s),bi(o=>yw(o)?An:Jo(o)))}function nR(n,e,t,i){let r=Aa(e)??i,s=bs(n,r),o=s.resolve?s.resolve(e,t):Zn(r,()=>s(e,t));return Pi(o)}function pf(n){return Ce(e=>{let t=n(e);return t?be(t).pipe(se(()=>e)):X(e)})}var bw=(()=>{class n{buildTitle(t){let i,r=t.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===pe);return i}getResolvedTitleForRoute(t){return t.data[Ca]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:()=>Q(iR),providedIn:"root"})}}return n})(),iR=(()=>{class n extends bw{constructor(t){super(),this.title=t}updateTitle(t){let i=this.buildTitle(t);i!==void 0&&this.title.setTitle(i)}static{this.\u0275fac=function(i){return new(i||n)(j($v))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Qf=new te("",{providedIn:"root",factory:()=>({})}),Jf=new te(""),rR=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Q(Bh)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return X(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let i=Pi(t.loadComponent()).pipe(se(Iw),ot(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Zr(()=>{this.componentLoaders.delete(t)})),r=new Ph(i,()=>new Xn).pipe(Rh());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return X({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=sR(i,this.compiler,t,this.onLoadEndListener).pipe(Zr(()=>{this.childrenLoaders.delete(i)})),o=new Ph(s,()=>new Xn).pipe(Rh());return this.childrenLoaders.set(i,o),o}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function sR(n,e,t,i){return Pi(n.loadChildren()).pipe(se(Iw),$t(r=>r instanceof fv||Array.isArray(r)?X(r):be(e.compileModuleAsync(r))),se(r=>{i&&i(n);let s,o,c=!1;return Array.isArray(r)?(o=r,c=!0):(s=r.create(t).injector,o=s.get(Jf,[],{optional:!0,self:!0}).flat()),{routes:o.map(Hf),injector:s}}))}function oR(n){return n&&typeof n=="object"&&"default"in n}function Iw(n){return oR(n)?n.default:n}var Yf=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:()=>Q(aR),providedIn:"root"})}}return n})(),aR=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),cR=new te("");var lR=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Xn,this.transitionAbortSubject=new Xn,this.configLoader=Q(rR),this.environmentInjector=Q(rs),this.urlSerializer=Q(qf),this.rootContexts=Q($l),this.location=Q(ll),this.inputBindingEnabled=Q(Gf,{optional:!0})!==null,this.titleStrategy=Q(bw),this.options=Q(Qf,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Q(Yf),this.createViewTransition=Q(cR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>X(void 0),this.rootComponentType=null;let t=r=>this.events.next(new Cf(r)),i=r=>this.events.next(new Af(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let i=++this.navigationId;this.transitions?.next(je(Y(Y({},this.transitions.value),t),{id:i}))}setupNavigations(t,i,r){return this.transitions=new on({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:ma,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Kt(s=>s.id!==0),se(s=>je(Y({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Ce(s=>{let o=!1,c=!1;return X(s).pipe(Ce(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Yt.SupersededByNewNavigation),An;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?je(Y({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!u&&h!=="reload"){let g="";return this.events.next(new pr(l.id,this.urlSerializer.serialize(l.rawUrl),g,wf.IgnoredSameUrlNavigation)),l.resolve(null),An}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return X(l).pipe(Ce(g=>{let v=this.transitions?.getValue();return this.events.next(new ya(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),v!==this.transitions?.getValue()?An:Promise.resolve(g)}),X1(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ot(g=>{s.targetSnapshot=g.targetSnapshot,s.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=je(Y({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let v=new Fl(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(v)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:g,extractedUrl:v,source:b,restoredState:O,extras:M}=l,x=new ya(g,this.urlSerializer.serialize(v),b,O);this.events.next(x);let B=dw(this.rootComponentType).snapshot;return this.currentTransition=s=je(Y({},l),{targetSnapshot:B,urlAfterRedirects:v,extras:je(Y({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=v,X(s)}else{let g="";return this.events.next(new pr(l.id,this.urlSerializer.serialize(l.extractedUrl),g,wf.IgnoredByUrlHandlingStrategy)),l.resolve(null),An}}),ot(l=>{let u=new Ef(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),se(l=>(this.currentTransition=s=je(Y({},l),{guards:g1(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),A1(this.environmentInjector,l=>this.events.next(l)),ot(l=>{if(s.guardsResult=l.guardsResult,ws(l.guardsResult))throw mw(this.urlSerializer,l.guardsResult);let u=new bf(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Kt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Yt.GuardRejected),!1)),pf(l=>{if(l.guards.canActivateChecks.length)return X(l).pipe(ot(u=>{let h=new If(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),Ce(u=>{let h=!1;return X(u).pipe(Z1(this.paramsInheritanceStrategy,this.environmentInjector),ot({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",Yt.NoDataFromResolver)}}))}),ot(u=>{let h=new Tf(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),pf(l=>{let u=h=>{let g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(ot(v=>{h.component=v}),se(()=>{})));for(let v of h.children)g.push(...u(v));return g};return Dh(u(l.targetSnapshot.root)).pipe(Yo(null),Xr(1))}),pf(()=>this.afterPreactivation()),Ce(()=>{let{currentSnapshot:l,targetSnapshot:u}=s,h=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return h?be(h).pipe(se(()=>s)):X(s)}),se(l=>{let u=c1(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=je(Y({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),ot(()=>{this.events.next(new wa)}),m1(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Xr(1),ot({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new fr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),iv(this.transitionAbortSubject.pipe(ot(l=>{throw l}))),Zr(()=>{!o&&!c&&this.cancelNavigationTransition(s,"",Yt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),bi(l=>{if(c=!0,_w(l))this.events.next(new Ri(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),d1(l)?this.events.next(new Ea(l.url)):s.resolve(!1);else{this.events.next(new va(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return An}))}))}cancelNavigationTransition(t,i,r){let s=new Ri(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function uR(n){return n!==ma}var dR=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:()=>Q(hR),providedIn:"root"})}}return n})(),Bf=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},hR=(()=>{class n extends Bf{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Tw=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:()=>Q(fR),providedIn:"root"})}}return n})(),fR=(()=>{class n extends Tw{constructor(){super(...arguments),this.location=Q(ll),this.urlSerializer=Q(qf),this.options=Q(Qf,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Q(Yf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Si,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=dw(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{i.type==="popstate"&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof ya)this.stateMemento=this.createStateMemento();else if(t instanceof pr)this.rawUrlTree=i.initialUrl;else if(t instanceof Fl){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(r,i)}}else t instanceof wa?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):t instanceof Ri&&(t.code===Yt.GuardRejected||t.code===Yt.NoDataFromResolver)?this.restoreHistory(i):t instanceof va?this.restoreHistory(i,!0):t instanceof fr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){let r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){let s=this.browserPageId,o=Y(Y({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(r,"",o)}else{let s=Y(Y({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(r,"",s)}}restoreHistory(t,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,s=this.currentPageId-r;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),fa=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(fa||{});function pR(n,e){n.events.pipe(Kt(t=>t instanceof fr||t instanceof Ri||t instanceof va||t instanceof pr),se(t=>t instanceof fr||t instanceof pr?fa.COMPLETE:(t instanceof Ri?t.code===Yt.Redirect||t.code===Yt.SupersededByNewNavigation:!1)?fa.REDIRECTING:fa.FAILED),Kt(t=>t!==fa.REDIRECTING),Xr(1)).subscribe(()=>{e()})}function mR(n){throw n}var gR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},_R={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},kt=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Q(us),this.stateManager=Q(Tw),this.options=Q(Qf,{optional:!0})||{},this.pendingTasks=Q(rl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Q(lR),this.urlSerializer=Q(qf),this.location=Q(ll),this.urlHandlingStrategy=Q(Yf),this._events=new Xn,this.errorHandler=this.options.errorHandler||mR,this.navigated=!1,this.routeReuseStrategy=Q(dR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Q(Jf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Q(Gf,{optional:!0}),this.eventsSubscription=new Gy,this.isNgZoneEnabled=Q(Re)instanceof Re&&Re.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(r!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof Ri&&i.code!==Yt.Redirect&&i.code!==Yt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof fr)this.navigated=!0;else if(i instanceof Ea){let o=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c={info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||uR(r.source)};this.scheduleNavigation(o,ma,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}vR(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ma,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){let s={replaceUrl:!0},o=r?.navigationId?r:null;if(r){let l=Y({},r);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(t);this.scheduleNavigation(c,i,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Hf),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){let{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,u=l?this.currentUrlTree.fragment:o,h=null;switch(c){case"merge":h=Y(Y({},this.currentUrlTree.queryParams),s);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}h!==null&&(h=this.removeEmptyProps(h));let g;try{let v=r?r.snapshot:this.routerState.snapshot.root;g=aw(v)}catch{(typeof t[0]!="string"||!t[0].startsWith("/"))&&(t=[]),g=this.currentUrlTree.root}return cw(g,t,h,u??null)}navigateByUrl(t,i={skipLocationChange:!1}){let r=ws(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,ma,null,i)}navigate(t,i={skipLocationChange:!1}){return yR(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(i===!0?r=Y({},gR):i===!1?r=Y({},_R):r=i,ws(t))return Gv(this.currentUrlTree,t,r);let s=this.parseUrl(t);return Gv(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,s])=>(s!=null&&(i[r]=s),i),{})}scheduleNavigation(t,i,r,s,o){if(this.disposed)return Promise.resolve(!1);let c,l,u;o?(c=o.resolve,l=o.reject,u=o.promise):u=new Promise((g,v)=>{c=g,l=v});let h=this.pendingTasks.add();return pR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(g=>Promise.reject(g))}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function yR(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Ge(4008,!1)}function vR(n){return!(n instanceof wa)&&!(n instanceof Ea)}var wR=new te("");function Cw(n,...e){return cr([{provide:Jf,multi:!0,useValue:n},[],{provide:xn,useFactory:ER,deps:[kt]},{provide:jh,multi:!0,useFactory:bR},e.map(t=>t.\u0275providers)])}function ER(n){return n.routerState.root}function bR(){let n=Q(ei);return e=>{let t=n.get(cl);if(e!==t.components[0])return;let i=n.get(kt),r=n.get(IR);n.get(TR)===1&&i.initialNavigation(),n.get(CR,null,Oh.Optional)?.setUpPreloading(),n.get(wR,null,Oh.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var IR=new te("",{factory:()=>new Xn}),TR=new te("",{providedIn:"root",factory:()=>1});var CR=new te("");var Nw=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(i){return new(i||n)(le(cs),le(as))}}static{this.\u0275dir=Qt({type:n})}}return n})(),Kl=(()=>{class n extends Nw{static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275dir=Qt({type:n,features:[Ti]})}}return n})(),Da=new te("");var AR={provide:Da,useExisting:is(()=>zt),multi:!0};function SR(){let n=hs()?hs().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var RR=new te(""),zt=(()=>{class n extends Nw{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!SR())}writeValue(t){let i=t??"";this.setProperty("value",i)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(i){return new(i||n)(le(cs),le(as),le(RR,8))}}static{this.\u0275dir=Qt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&ne("input",function(o){return r._handleInput(o.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(o){return r._compositionEnd(o.target.value)})},features:[ls([AR]),Ti]})}}return n})();var PR=new te(""),xR=new te("");function Vw(n){return n!=null}function Fw(n){return al(n)?be(n):n}function Lw(n){let e={};return n.forEach(t=>{e=t!=null?Y(Y({},e),t):e}),Object.keys(e).length===0?null:e}function Uw(n,e){return e.map(t=>t(n))}function DR(n){return!n.validate}function jw(n){return n.map(e=>DR(e)?e:t=>e.validate(t))}function MR(n){if(!n)return null;let e=n.filter(Vw);return e.length==0?null:function(t){return Lw(Uw(t,e))}}function Bw(n){return n!=null?MR(jw(n)):null}function kR(n){if(!n)return null;let e=n.filter(Vw);return e.length==0?null:function(t){let i=Uw(t,e).map(Fw);return Yy(i).pipe(se(Lw))}}function qw(n){return n!=null?kR(jw(n)):null}function Sw(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function OR(n){return n._rawValidators}function NR(n){return n._rawAsyncValidators}function Xf(n){return n?Array.isArray(n)?n:[n]:[]}function Gl(n,e){return Array.isArray(n)?n.includes(e):n===e}function Rw(n,e){let t=Xf(e);return Xf(n).forEach(r=>{Gl(t,r)||t.push(r)}),t}function Pw(n,e){return Xf(e).filter(t=>!Gl(n,t))}var Hl=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Bw(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=qw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Zf=class extends Hl{get formDirective(){return null}get path(){return null}},xa=class extends Hl{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},ep=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},VR={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},nL=je(Y({},VR),{"[class.ng-submitted]":"isSubmitted"}),cn=(()=>{class n extends ep{constructor(t){super(t)}static{this.\u0275fac=function(i){return new(i||n)(le(xa,2))}}static{this.\u0275dir=Qt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&mv("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Ti]})}}return n})();var Ra="VALID",Wl="INVALID",Is="PENDING",Pa="DISABLED";function FR(n){return(Ql(n)?n.validators:n)||null}function LR(n){return Array.isArray(n)?Bw(n):n||null}function UR(n,e){return(Ql(e)?e.asyncValidators:n)||null}function jR(n){return Array.isArray(n)?qw(n):n||null}function Ql(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var tp=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ra}get invalid(){return this.status===Wl}get pending(){return this.status==Is}get disabled(){return this.status===Pa}get enabled(){return this.status!==Pa}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Rw(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Rw(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Pw(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Pw(e,this._rawAsyncValidators))}hasValidator(e){return Gl(this._rawValidators,e)}hasAsyncValidator(e){return Gl(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Is,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Pa,this.errors=null,this._forEachChild(i=>{i.disable(je(Y({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(je(Y({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Ra,this._forEachChild(i=>{i.enable(je(Y({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(je(Y({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ra||this.status===Is)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Pa:Ra}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Is,this._hasOwnPendingAsyncValidator=!0;let t=Fw(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){let i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ti,this.statusChanges=new ti}_calculateStatus(){return this._allControlsDisabled()?Pa:this.errors?Wl:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Is)?Is:this._anyControlsHaveStatus(Wl)?Wl:Ra}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Ql(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=LR(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=jR(this._rawAsyncValidators)}};var $w=new te("CallSetDisabledState",{providedIn:"root",factory:()=>np}),np="always";function BR(n,e){return[...e.path,n]}function qR(n,e,t=np){zR(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),WR(n,e),HR(n,e),GR(n,e),$R(n,e)}function xw(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function $R(n,e){if(e.valueAccessor.setDisabledState){let t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function zR(n,e){let t=OR(n);e.validator!==null?n.setValidators(Sw(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let i=NR(n);e.asyncValidator!==null?n.setAsyncValidators(Sw(i,e.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();xw(e._rawValidators,r),xw(e._rawAsyncValidators,r)}function WR(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&zw(n,e)})}function GR(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&zw(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function zw(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function HR(n,e){let t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function KR(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function QR(n){return Object.getPrototypeOf(n.constructor)===Kl}function JR(n,e){if(!e)return null;Array.isArray(e);let t,i,r;return e.forEach(s=>{s.constructor===zt?t=s:QR(s)?i=s:r=s}),r||i||t||null}function Dw(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Mw(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var YR=class extends tp{constructor(e=null,t,i){super(FR(t),UR(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ql(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Mw(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Dw(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Dw(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Mw(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var XR={provide:xa,useExisting:is(()=>Xt)},kw=Promise.resolve(),Xt=(()=>{class n extends xa{constructor(t,i,r,s,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new YR,this._registered=!1,this.name="",this.update=new ti,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=JR(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),KR(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){qR(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){kw.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let i=t.isDisabled.currentValue,r=i!==0&&$h(i);kw.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?BR(t,this._parent):[t]}static{this.\u0275fac=function(i){return new(i||n)(le(Zf,9),le(PR,10),le(xR,10),le(Da,10),le(ds,8),le($w,8))}}static{this.\u0275dir=Qt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[ea.None,"disabled","isDisabled"],model:[ea.None,"ngModel","model"],options:[ea.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ls([XR]),Ti,nl]})}}return n})();var ZR={provide:Da,useExisting:is(()=>Ma),multi:!0},Ma=(()=>{class n extends Kl{writeValue(t){let i=t??"";this.setProperty("value",i)}registerOnChange(t){this.onChange=i=>{t(i==""?null:parseFloat(i))}}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&ne("input",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},features:[ls([ZR]),Ti]})}}return n})();var eP={provide:Da,useExisting:is(()=>Mn),multi:!0};function Ww(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function tP(n){return n.split(":")[0]}var Mn=(()=>{class n extends Kl{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let i=this._getOptionId(t),r=Ww(i,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){let i=tP(t);return this._optionMap.has(i)?this._optionMap.get(i):t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&ne("change",function(o){return r.onChange(o.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ls([eP]),Ti]})}}return n})(),xi=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Ww(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(le(as),le(cs),le(Mn,9))}}static{this.\u0275dir=Qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})(),nP={provide:Da,useExisting:is(()=>Gw),multi:!0};function Ow(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function iP(n){return n.split(":")[0]}var Gw=(()=>{class n extends Kl{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let i;if(Array.isArray(t)){let r=t.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{let r=[],s=i.selectedOptions;if(s!==void 0){let o=s;for(let c=0;c<o.length;c++){let l=o[c],u=this._getOptionValue(l.value);r.push(u)}}else{let o=i.options;for(let c=0;c<o.length;c++){let l=o[c];if(l.selected){let u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,t(r)}}_registerOption(t){let i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){let i=iP(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}static{this.\u0275fac=(()=>{let t;return function(r){return(t||(t=Ii(n)))(r||n)}})()}static{this.\u0275dir=Qt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&ne("change",function(o){return r.onChange(o.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[ls([nP]),Ti]})}}return n})(),Di=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Ow(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Ow(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(i){return new(i||n)(le(as),le(cs),le(Gw,9))}}static{this.\u0275dir=Qt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return n})();var rP=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=qe({type:n})}static{this.\u0275inj=Be({})}}return n})();var ln=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:$w,useValue:t.callSetDisabledState??np}]}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275mod=qe({type:n})}static{this.\u0275inj=Be({imports:[rP]})}}return n})();var sP="firebase",oP="10.14.1";ht(sP,oP,"app");var _t=new na("ANGULARFIRE2_VERSION");function Yl(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ka=(n,e)=>{let t=e?[e]:yl(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},Zt=class{constructor(){return ka(aP)}},aP="app-check";function Cs(){}var Jl=class{zone;delegate;constructor(e,t=Ky){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){let r=this.zone,s=function(o){r.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,i)}},ip=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Cs,{},Cs,Cs)),t.pipe(ot({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Wt=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Jl(Zone.current)),this.insideAngular=t.run(()=>new Jl(Zone.current,Zc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(j(Re))};static \u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Oa(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function cP(n){return Oa().ngZone.runOutsideAngular(()=>n())}function mr(n){return Oa().ngZone.run(()=>n())}function rp(n){return n.pipe(mt(Oa().outsideAngular))}function yt(n){return lP(Oa())(n)}function lP(n){return function(t){return t=t.lift(new ip(n.ngZone)),t.pipe(Dt(n.outsideAngular),mt(n.insideAngular))}}var uP=(n,e)=>function(){let i=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),mr(()=>n.apply(void 0,i))},_n=(n,e)=>function(){let t,i=arguments;for(let s=0;s<arguments.length;s++)typeof i[s]=="function"&&(e&&(t||=mr(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Cs,{},Cs,Cs))),i[s]=uP(i[s],t));let r=cP(()=>n.apply(this,i));if(!e)if(r instanceof wt){let s=Oa();return r.pipe(Dt(s.outsideAngular),mt(s.insideAngular))}else return mr(()=>r);return r instanceof wt?r.pipe(yt):r instanceof Promise?mr(()=>new Promise((s,o)=>r.then(c=>mr(()=>s(c)),c=>mr(()=>o(c))))):typeof r=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),r.apply(this,arguments)}:mr(()=>r)};var ii=class{constructor(e){return e}},gr=class{constructor(){return yl()}};function dP(n){return n&&n.length===1?n[0]:new ii(fs())}var sp=new te("angularfire2._apps"),hP={provide:ii,useFactory:dP,deps:[[new Et,sp]]},fP={provide:gr,deps:[[new Et,sp]]};function pP(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new ii(i)}}var mP=(()=>{class n{constructor(t){ht("angularfire",_t.full,"core"),ht("angularfire",_t.full,"app"),ht("angular",ol.full,t.toString())}static \u0275fac=function(i){return new(i||n)(j(dt))};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[hP,fP]})}return n})();function Hw(n,...e){return{ngModule:mP,providers:[{provide:sp,useFactory:pP(n),multi:!0,deps:[Re,ei,Wt,...e]}]}}var Kw=_n(Cv,!0);var gP=new Map,_P={activated:!1,tokenObservers:[]},yP={initialized:!1,enabled:!1};function yn(n){return gP.get(n)||Object.assign({},_P)}function Zw(){return yP}var vP="https://content-firebaseappcheck.googleapis.com/v1";var wP="exchangeDebugToken",Qw={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},DL=24*60*60*1e3;var ap=class{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return E(this,null,function*(){this.stop();try{this.pending=new Wh,this.pending.promise.catch(t=>{}),yield EP(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Wh,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function EP(n){return new Promise(e=>{setTimeout(e,n)})}var bP={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Mi=new Iv("appCheck","AppCheck",bP);function eE(n){if(!yn(n).activated)throw Mi.create("use-before-activation",{appName:n.name})}function tE(i,r){return E(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let b=yield o.getHeartbeatsHeader();b&&(s["X-Firebase-Client"]=b)}let c={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,c)}catch(b){throw Mi.create("fetch-network-error",{originalErrorMessage:b?.message})}if(l.status!==200)throw Mi.create("fetch-status-error",{httpStatus:l.status});let u;try{u=yield l.json()}catch(b){throw Mi.create("fetch-parse-error",{originalErrorMessage:b?.message})}let h=u.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw Mi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let g=Number(h[1])*1e3,v=Date.now();return{token:u.token,expireTimeMillis:v+g,issuedAtTimeMillis:v}})}function nE(n,e){let{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${vP}/projects/${t}/apps/${i}:${wP}?key=${r}`,body:{debug_token:e}}}var IP="firebase-app-check-database",TP=1,cp="firebase-app-check-store";var Zl=null;function CP(){return Zl||(Zl=new Promise((n,e)=>{try{let t=indexedDB.open(IP,TP);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Mi.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},t.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore(cp,{keyPath:"compositeKey"})}}}catch(t){e(Mi.create("storage-open",{originalErrorMessage:t?.message}))}}),Zl)}function AP(n,e){return SP(RP(n),e)}function SP(n,e){return E(this,null,function*(){let i=(yield CP()).transaction(cp,"readwrite"),s=i.objectStore(cp).put({compositeKey:n,value:e});return new Promise((o,c)=>{s.onsuccess=l=>{o()},i.onerror=l=>{var u;c(Mi.create("storage-set",{originalErrorMessage:(u=l.target.error)===null||u===void 0?void 0:u.message}))}})})}function RP(n){return`${n.options.appId}-${n.name}`}var lp=new ml("@firebase/app-check");function op(n,e){return fl()?AP(n,e).catch(t=>{lp.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function iE(){return Zw().enabled}function rE(){return E(this,null,function*(){let n=Zw();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var PP={error:"UNKNOWN_ERROR"};function xP(n){return bv.encodeString(JSON.stringify(n),!1)}function up(n,e=!1){return E(this,null,function*(){let t=n.app;eE(t);let i=yn(t),r=i.token,s;if(r&&!Na(r)&&(i.token=void 0,r=void 0),!r){let l=yield i.cachedTokenPromise;l&&(Na(l)?r=l:yield op(t,void 0))}if(!e&&r&&Na(r))return{token:r.token};let o=!1;if(iE()){i.exchangeTokenPromise||(i.exchangeTokenPromise=tE(nE(t,yield rE()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let l=yield i.exchangeTokenPromise;return yield op(t,l),i.token=l,{token:l.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=yield yn(t).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?lp.warn(l.message):lp.error(l),s=l}let c;return r?s?Na(r)?c={token:r.token,internalError:s}:c=Yw(s):(c={token:r.token},i.token=r,yield op(t,r)):c=Yw(s),o&&OP(t,c),c})}function DP(n){return E(this,null,function*(){let e=n.app;eE(e);let{provider:t}=yn(e);if(iE()){let i=yield rE(),{token:r}=yield tE(nE(e,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield t.getToken();return{token:i}}})}function MP(n,e,t,i){let{app:r}=n,s=yn(r),o={next:t,error:i,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Na(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),Jw(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Jw(n))}function sE(n,e){let t=yn(n),i=t.tokenObservers.filter(r=>r.next!==e);i.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function Jw(n){let{app:e}=n,t=yn(e),i=t.tokenRefresher;i||(i=kP(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function kP(n){let{app:e}=n;return new ap(()=>E(this,null,function*(){let t=yn(e),i;if(t.token?i=yield up(n,!0):i=yield up(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let t=yn(e);if(t.token){let i=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,r=t.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},Qw.RETRIAL_MIN_WAIT,Qw.RETRIAL_MAX_WAIT)}function OP(n,e){let t=yn(n).tokenObservers;for(let i of t)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function Na(n){return n.expireTimeMillis-Date.now()>0}function Yw(n){return{token:xP(PP),error:n}}var dp=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=yn(this.app);for(let t of e)sE(this.app,t.next);return Promise.resolve()}};function NP(n,e){return new dp(n,e)}function VP(n){return{getToken:e=>up(n,e),getLimitedUseToken:()=>DP(n),addTokenListener:e=>MP(n,"INTERNAL",e),removeTokenListener:e=>sE(n.app,e)}}var FP="@firebase/app-check",LP="0.8.8";var UP="app-check",Xw="app-check-internal";function jP(){lr(new mn(UP,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return NP(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(Xw).initialize()})),lr(new mn(Xw,n=>{let e=n.getProvider("app-check").getImmediate();return VP(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),ht(FP,LP)}jP();var BP=["localhost","0.0.0.0","127.0.0.1"],$L=typeof window<"u"&&BP.includes(window.location.hostname);var qP="firebase",$P="10.14.1";tt.registerVersion(qP,$P,"app-compat");var zP=["ngOnDestroy"],tu=(n,e,t,i={})=>new Proxy(n,{get:(r,s)=>t.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(zP.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(c=>{let l=c?.[s];return typeof l=="function"?l.bind(c):l?.then?l.then(u=>t.run(()=>u)):t.run(()=>l)});return new Proxy(()=>{},{get:(c,l)=>o[l],apply:(c,l,u)=>o.then(h=>{let g=h?.(...u);return i?.spy?.apply&&i.spy.apply(s,u,g),g})})})});var eu=class{constructor(e){return e}},kn=new te("angularfire2.app.options"),On=new te("angularfire2.app.name");function ri(n,e,t){let i=typeof t=="string"&&t||"[DEFAULT]",r=typeof t=="object"&&t||{};r.name=r.name||i;let o=tt.apps.filter(c=>c&&c.name===r.name)[0]||e.runOutsideAngular(()=>tt.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let c=!!module.hot;WP("error",`${o.name} Firebase App already initialized with different options${c?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new eu(o)}var WP=(n,...e)=>{qh()&&typeof console<"u"&&console[n](...e)},GP={provide:eu,useFactory:ri,deps:[kn,Re,[new Et,On]]},aE=(()=>{class n{static initializeApp(t,i){return{ngModule:n,providers:[{provide:kn,useValue:t},{provide:On,useValue:i}]}}constructor(t){tt.registerVersion("angularfire",_t.full,"core"),tt.registerVersion("angularfire",_t.full,"app-compat"),tt.registerVersion("angular",ol.full,t.toString())}static \u0275fac=function(i){return new(i||n)(j(dt))};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[GP]})}return n})();function ki(n,e,t,i,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(c=>c[0]===n)||[];if(s)return HP(r,o)||(oE("error",`${e} was already initialized on the ${t} Firebase App with different settings.${KP?" You may need to reload as Firebase is not HMR aware.":""}`),oE("warn",{is:r,was:o})),s;{let c=i();return globalThis.\u0275AngularfireInstanceCache.push([n,c,r]),c}}function HP(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var KP=typeof module<"u"&&!!module.hot,oE=(n,...e)=>{qh()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var fp=new te("angularfire2.auth.use-emulator"),pp=new te("angularfire2.auth.settings"),mp=new te("angularfire2.auth.tenant-id"),gp=new te("angularfire2.auth.langugage-code"),_p=new te("angularfire2.auth.use-device-language"),yp=new te("angularfire.auth.persistence"),vp=(n,e,t,i,r,s,o,c)=>ki(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),i&&(l.tenantId=i),l.languageCode=r,s&&l.useDeviceLanguage(),o)for(let[u,h]of Object.entries(o))l.settings[u]=h;return c&&l.setPersistence(c),l},[t,i,r,s,o,c]),en=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,i,r,s,o,c,l,u,h,g,v,b){let O=new Xn,M=X(void 0).pipe(mt(o.outsideAngular),Ce(()=>s.runOutsideAngular(()=>import("./chunk-UM7IDTDF.js"))),se(()=>ri(t,s,i)),se(x=>vp(x,s,c,u,h,g,l,v)),Xo({bufferSize:1,refCount:!1}));if(Ci(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=X(null);else{M.pipe(Sn()).subscribe();let x=M.pipe(Ce(F=>F.getRedirectResult().then(G=>G,()=>null)),yt,Xo({bufferSize:1,refCount:!1})),B=M.pipe(Ce(F=>new wt(G=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(re=>G.next(re),re=>G.error(re),()=>G.complete()))})))),H=M.pipe(Ce(F=>new wt(G=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(re=>G.next(re),re=>G.error(re),()=>G.complete()))}))));this.authState=x.pipe(ns(B),Dt(o.outsideAngular),mt(o.insideAngular)),this.user=x.pipe(ns(H),Dt(o.outsideAngular),mt(o.insideAngular)),this.idToken=this.user.pipe(Ce(F=>F?be(F.getIdToken()):X(null))),this.idTokenResult=this.user.pipe(Ce(F=>F?be(F.getIdTokenResult()):X(null))),this.credential=Xy(x,O,this.authState.pipe(Kt(F=>!F))).pipe(se(F=>F?.user?F:null),Dt(o.outsideAngular),mt(o.insideAngular))}return tu(this,M,s,{spy:{apply:(x,B,H)=>{(x.startsWith("signIn")||x.startsWith("createUser"))&&H.then(F=>O.next(F))}}})}static \u0275fac=function(i){return new(i||n)(j(kn),j(On,8),j(dt),j(Re),j(Wt),j(fp,8),j(pp,8),j(mp,8),j(gp,8),j(_p,8),j(yp,8),j(Zt,8))};static \u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),cE=(()=>{class n{constructor(){tt.registerVersion("angularfire",_t.full,"auth-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[en]})}return n})();var lE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},uE={};var Oi,wp;(function(){var n;function e(C,w){function I(){}I.prototype=w.prototype,C.D=w.prototype,C.prototype=new I,C.prototype.constructor=C,C.C=function(A,R,D){for(var T=Array(arguments.length-2),Qn=2;Qn<arguments.length;Qn++)T[Qn-2]=arguments[Qn];return w.prototype[R].apply(A,T)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(C,w,I){I||(I=0);var A=Array(16);if(typeof w=="string")for(var R=0;16>R;++R)A[R]=w.charCodeAt(I++)|w.charCodeAt(I++)<<8|w.charCodeAt(I++)<<16|w.charCodeAt(I++)<<24;else for(R=0;16>R;++R)A[R]=w[I++]|w[I++]<<8|w[I++]<<16|w[I++]<<24;w=C.g[0],I=C.g[1],R=C.g[2];var D=C.g[3],T=w+(D^I&(R^D))+A[0]+3614090360&4294967295;w=I+(T<<7&4294967295|T>>>25),T=D+(R^w&(I^R))+A[1]+3905402710&4294967295,D=w+(T<<12&4294967295|T>>>20),T=R+(I^D&(w^I))+A[2]+606105819&4294967295,R=D+(T<<17&4294967295|T>>>15),T=I+(w^R&(D^w))+A[3]+3250441966&4294967295,I=R+(T<<22&4294967295|T>>>10),T=w+(D^I&(R^D))+A[4]+4118548399&4294967295,w=I+(T<<7&4294967295|T>>>25),T=D+(R^w&(I^R))+A[5]+1200080426&4294967295,D=w+(T<<12&4294967295|T>>>20),T=R+(I^D&(w^I))+A[6]+2821735955&4294967295,R=D+(T<<17&4294967295|T>>>15),T=I+(w^R&(D^w))+A[7]+4249261313&4294967295,I=R+(T<<22&4294967295|T>>>10),T=w+(D^I&(R^D))+A[8]+1770035416&4294967295,w=I+(T<<7&4294967295|T>>>25),T=D+(R^w&(I^R))+A[9]+2336552879&4294967295,D=w+(T<<12&4294967295|T>>>20),T=R+(I^D&(w^I))+A[10]+4294925233&4294967295,R=D+(T<<17&4294967295|T>>>15),T=I+(w^R&(D^w))+A[11]+2304563134&4294967295,I=R+(T<<22&4294967295|T>>>10),T=w+(D^I&(R^D))+A[12]+1804603682&4294967295,w=I+(T<<7&4294967295|T>>>25),T=D+(R^w&(I^R))+A[13]+4254626195&4294967295,D=w+(T<<12&4294967295|T>>>20),T=R+(I^D&(w^I))+A[14]+2792965006&4294967295,R=D+(T<<17&4294967295|T>>>15),T=I+(w^R&(D^w))+A[15]+1236535329&4294967295,I=R+(T<<22&4294967295|T>>>10),T=w+(R^D&(I^R))+A[1]+4129170786&4294967295,w=I+(T<<5&4294967295|T>>>27),T=D+(I^R&(w^I))+A[6]+3225465664&4294967295,D=w+(T<<9&4294967295|T>>>23),T=R+(w^I&(D^w))+A[11]+643717713&4294967295,R=D+(T<<14&4294967295|T>>>18),T=I+(D^w&(R^D))+A[0]+3921069994&4294967295,I=R+(T<<20&4294967295|T>>>12),T=w+(R^D&(I^R))+A[5]+3593408605&4294967295,w=I+(T<<5&4294967295|T>>>27),T=D+(I^R&(w^I))+A[10]+38016083&4294967295,D=w+(T<<9&4294967295|T>>>23),T=R+(w^I&(D^w))+A[15]+3634488961&4294967295,R=D+(T<<14&4294967295|T>>>18),T=I+(D^w&(R^D))+A[4]+3889429448&4294967295,I=R+(T<<20&4294967295|T>>>12),T=w+(R^D&(I^R))+A[9]+568446438&4294967295,w=I+(T<<5&4294967295|T>>>27),T=D+(I^R&(w^I))+A[14]+3275163606&4294967295,D=w+(T<<9&4294967295|T>>>23),T=R+(w^I&(D^w))+A[3]+4107603335&4294967295,R=D+(T<<14&4294967295|T>>>18),T=I+(D^w&(R^D))+A[8]+1163531501&4294967295,I=R+(T<<20&4294967295|T>>>12),T=w+(R^D&(I^R))+A[13]+2850285829&4294967295,w=I+(T<<5&4294967295|T>>>27),T=D+(I^R&(w^I))+A[2]+4243563512&4294967295,D=w+(T<<9&4294967295|T>>>23),T=R+(w^I&(D^w))+A[7]+1735328473&4294967295,R=D+(T<<14&4294967295|T>>>18),T=I+(D^w&(R^D))+A[12]+2368359562&4294967295,I=R+(T<<20&4294967295|T>>>12),T=w+(I^R^D)+A[5]+4294588738&4294967295,w=I+(T<<4&4294967295|T>>>28),T=D+(w^I^R)+A[8]+2272392833&4294967295,D=w+(T<<11&4294967295|T>>>21),T=R+(D^w^I)+A[11]+1839030562&4294967295,R=D+(T<<16&4294967295|T>>>16),T=I+(R^D^w)+A[14]+4259657740&4294967295,I=R+(T<<23&4294967295|T>>>9),T=w+(I^R^D)+A[1]+2763975236&4294967295,w=I+(T<<4&4294967295|T>>>28),T=D+(w^I^R)+A[4]+1272893353&4294967295,D=w+(T<<11&4294967295|T>>>21),T=R+(D^w^I)+A[7]+4139469664&4294967295,R=D+(T<<16&4294967295|T>>>16),T=I+(R^D^w)+A[10]+3200236656&4294967295,I=R+(T<<23&4294967295|T>>>9),T=w+(I^R^D)+A[13]+681279174&4294967295,w=I+(T<<4&4294967295|T>>>28),T=D+(w^I^R)+A[0]+3936430074&4294967295,D=w+(T<<11&4294967295|T>>>21),T=R+(D^w^I)+A[3]+3572445317&4294967295,R=D+(T<<16&4294967295|T>>>16),T=I+(R^D^w)+A[6]+76029189&4294967295,I=R+(T<<23&4294967295|T>>>9),T=w+(I^R^D)+A[9]+3654602809&4294967295,w=I+(T<<4&4294967295|T>>>28),T=D+(w^I^R)+A[12]+3873151461&4294967295,D=w+(T<<11&4294967295|T>>>21),T=R+(D^w^I)+A[15]+530742520&4294967295,R=D+(T<<16&4294967295|T>>>16),T=I+(R^D^w)+A[2]+3299628645&4294967295,I=R+(T<<23&4294967295|T>>>9),T=w+(R^(I|~D))+A[0]+4096336452&4294967295,w=I+(T<<6&4294967295|T>>>26),T=D+(I^(w|~R))+A[7]+1126891415&4294967295,D=w+(T<<10&4294967295|T>>>22),T=R+(w^(D|~I))+A[14]+2878612391&4294967295,R=D+(T<<15&4294967295|T>>>17),T=I+(D^(R|~w))+A[5]+4237533241&4294967295,I=R+(T<<21&4294967295|T>>>11),T=w+(R^(I|~D))+A[12]+1700485571&4294967295,w=I+(T<<6&4294967295|T>>>26),T=D+(I^(w|~R))+A[3]+2399980690&4294967295,D=w+(T<<10&4294967295|T>>>22),T=R+(w^(D|~I))+A[10]+4293915773&4294967295,R=D+(T<<15&4294967295|T>>>17),T=I+(D^(R|~w))+A[1]+2240044497&4294967295,I=R+(T<<21&4294967295|T>>>11),T=w+(R^(I|~D))+A[8]+1873313359&4294967295,w=I+(T<<6&4294967295|T>>>26),T=D+(I^(w|~R))+A[15]+4264355552&4294967295,D=w+(T<<10&4294967295|T>>>22),T=R+(w^(D|~I))+A[6]+2734768916&4294967295,R=D+(T<<15&4294967295|T>>>17),T=I+(D^(R|~w))+A[13]+1309151649&4294967295,I=R+(T<<21&4294967295|T>>>11),T=w+(R^(I|~D))+A[4]+4149444226&4294967295,w=I+(T<<6&4294967295|T>>>26),T=D+(I^(w|~R))+A[11]+3174756917&4294967295,D=w+(T<<10&4294967295|T>>>22),T=R+(w^(D|~I))+A[2]+718787259&4294967295,R=D+(T<<15&4294967295|T>>>17),T=I+(D^(R|~w))+A[9]+3951481745&4294967295,C.g[0]=C.g[0]+w&4294967295,C.g[1]=C.g[1]+(R+(T<<21&4294967295|T>>>11))&4294967295,C.g[2]=C.g[2]+R&4294967295,C.g[3]=C.g[3]+D&4294967295}i.prototype.u=function(C,w){w===void 0&&(w=C.length);for(var I=w-this.blockSize,A=this.B,R=this.h,D=0;D<w;){if(R==0)for(;D<=I;)r(this,C,D),D+=this.blockSize;if(typeof C=="string"){for(;D<w;)if(A[R++]=C.charCodeAt(D++),R==this.blockSize){r(this,A),R=0;break}}else for(;D<w;)if(A[R++]=C[D++],R==this.blockSize){r(this,A),R=0;break}}this.h=R,this.o+=w},i.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var w=1;w<C.length-8;++w)C[w]=0;var I=8*this.o;for(w=C.length-8;w<C.length;++w)C[w]=I&255,I/=256;for(this.u(C),C=Array(16),w=I=0;4>w;++w)for(var A=0;32>A;A+=8)C[I++]=this.g[w]>>>A&255;return C};function s(C,w){var I=c;return Object.prototype.hasOwnProperty.call(I,C)?I[C]:I[C]=w(C)}function o(C,w){this.h=w;for(var I=[],A=!0,R=C.length-1;0<=R;R--){var D=C[R]|0;A&&D==w||(I[R]=D,A=!1)}this.g=I}var c={};function l(C){return-128<=C&&128>C?s(C,function(w){return new o([w|0],0>w?-1:0)}):new o([C|0],0>C?-1:0)}function u(C){if(isNaN(C)||!isFinite(C))return g;if(0>C)return x(u(-C));for(var w=[],I=1,A=0;C>=I;A++)w[A]=C/I|0,I*=4294967296;return new o(w,0)}function h(C,w){if(C.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(C.charAt(0)=="-")return x(h(C.substring(1),w));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(w,8)),A=g,R=0;R<C.length;R+=8){var D=Math.min(8,C.length-R),T=parseInt(C.substring(R,R+D),w);8>D?(D=u(Math.pow(w,D)),A=A.j(D).add(u(T))):(A=A.j(I),A=A.add(u(T)))}return A}var g=l(0),v=l(1),b=l(16777216);n=o.prototype,n.m=function(){if(M(this))return-x(this).m();for(var C=0,w=1,I=0;I<this.g.length;I++){var A=this.i(I);C+=(0<=A?A:4294967296+A)*w,w*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(O(this))return"0";if(M(this))return"-"+x(this).toString(C);for(var w=u(Math.pow(C,6)),I=this,A="";;){var R=G(I,w).g;I=B(I,R.j(w));var D=((0<I.g.length?I.g[0]:I.h)>>>0).toString(C);if(I=R,O(I))return D+A;for(;6>D.length;)D="0"+D;A=D+A}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function O(C){if(C.h!=0)return!1;for(var w=0;w<C.g.length;w++)if(C.g[w]!=0)return!1;return!0}function M(C){return C.h==-1}n.l=function(C){return C=B(this,C),M(C)?-1:O(C)?0:1};function x(C){for(var w=C.g.length,I=[],A=0;A<w;A++)I[A]=~C.g[A];return new o(I,~C.h).add(v)}n.abs=function(){return M(this)?x(this):this},n.add=function(C){for(var w=Math.max(this.g.length,C.g.length),I=[],A=0,R=0;R<=w;R++){var D=A+(this.i(R)&65535)+(C.i(R)&65535),T=(D>>>16)+(this.i(R)>>>16)+(C.i(R)>>>16);A=T>>>16,D&=65535,T&=65535,I[R]=T<<16|D}return new o(I,I[I.length-1]&-2147483648?-1:0)};function B(C,w){return C.add(x(w))}n.j=function(C){if(O(this)||O(C))return g;if(M(this))return M(C)?x(this).j(x(C)):x(x(this).j(C));if(M(C))return x(this.j(x(C)));if(0>this.l(b)&&0>C.l(b))return u(this.m()*C.m());for(var w=this.g.length+C.g.length,I=[],A=0;A<2*w;A++)I[A]=0;for(A=0;A<this.g.length;A++)for(var R=0;R<C.g.length;R++){var D=this.i(A)>>>16,T=this.i(A)&65535,Qn=C.i(R)>>>16,Do=C.i(R)&65535;I[2*A+2*R]+=T*Do,H(I,2*A+2*R),I[2*A+2*R+1]+=D*Do,H(I,2*A+2*R+1),I[2*A+2*R+1]+=T*Qn,H(I,2*A+2*R+1),I[2*A+2*R+2]+=D*Qn,H(I,2*A+2*R+2)}for(A=0;A<w;A++)I[A]=I[2*A+1]<<16|I[2*A];for(A=w;A<2*w;A++)I[A]=0;return new o(I,0)};function H(C,w){for(;(C[w]&65535)!=C[w];)C[w+1]+=C[w]>>>16,C[w]&=65535,w++}function F(C,w){this.g=C,this.h=w}function G(C,w){if(O(w))throw Error("division by zero");if(O(C))return new F(g,g);if(M(C))return w=G(x(C),w),new F(x(w.g),x(w.h));if(M(w))return w=G(C,x(w)),new F(x(w.g),w.h);if(30<C.g.length){if(M(C)||M(w))throw Error("slowDivide_ only works with positive integers.");for(var I=v,A=w;0>=A.l(C);)I=re(I),A=re(A);var R=ee(I,1),D=ee(A,1);for(A=ee(A,2),I=ee(I,2);!O(A);){var T=D.add(A);0>=T.l(C)&&(R=R.add(I),D=T),A=ee(A,1),I=ee(I,1)}return w=B(C,R.j(w)),new F(R,w)}for(R=g;0<=C.l(w);){for(I=Math.max(1,Math.floor(C.m()/w.m())),A=Math.ceil(Math.log(I)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),D=u(I),T=D.j(w);M(T)||0<T.l(C);)I-=A,D=u(I),T=D.j(w);O(D)&&(D=v),R=R.add(D),C=B(C,T)}return new F(R,C)}n.A=function(C){return G(this,C).h},n.and=function(C){for(var w=Math.max(this.g.length,C.g.length),I=[],A=0;A<w;A++)I[A]=this.i(A)&C.i(A);return new o(I,this.h&C.h)},n.or=function(C){for(var w=Math.max(this.g.length,C.g.length),I=[],A=0;A<w;A++)I[A]=this.i(A)|C.i(A);return new o(I,this.h|C.h)},n.xor=function(C){for(var w=Math.max(this.g.length,C.g.length),I=[],A=0;A<w;A++)I[A]=this.i(A)^C.i(A);return new o(I,this.h^C.h)};function re(C){for(var w=C.g.length+1,I=[],A=0;A<w;A++)I[A]=C.i(A)<<1|C.i(A-1)>>>31;return new o(I,C.h)}function ee(C,w){var I=w>>5;w%=32;for(var A=C.g.length-I,R=[],D=0;D<A;D++)R[D]=0<w?C.i(D+I)>>>w|C.i(D+I+1)<<32-w:C.i(D+I);return new o(R,C.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,wp=uE.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,Oi=uE.Integer=o}).apply(typeof lE<"u"?lE:typeof self<"u"?self:typeof window<"u"?window:{});var nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},si={};var Ep,JP,Ss,bp,Va,iu,Ip,Tp,Cp;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,f){return a==Array.prototype||a==Object.prototype||(a[d]=f.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof nu=="object"&&nu];for(var d=0;d<a.length;++d){var f=a[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var i=t(this);function r(a,d){if(d)e:{var f=i;a=a.split(".");for(var _=0;_<a.length-1;_++){var P=a[_];if(!(P in f))break e;f=f[P]}a=a[a.length-1],_=f[a],d=d(_),d!=_&&d!=null&&e(f,a,{configurable:!0,writable:!0,value:d})}}function s(a,d){a instanceof String&&(a+="");var f=0,_=!1,P={next:function(){if(!_&&f<a.length){var N=f++;return{value:d(N,a[N]),done:!1}}return _=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}r("Array.prototype.values",function(a){return a||function(){return s(this,function(d,f){return f})}});var o=o||{},c=this||self;function l(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function u(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function h(a,d,f){return a.call.apply(a.bind,arguments)}function g(a,d,f){if(!a)throw Error();if(2<arguments.length){var _=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,_),a.apply(d,P)}}return function(){return a.apply(d,arguments)}}function v(a,d,f){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:g,v.apply(null,arguments)}function b(a,d){var f=Array.prototype.slice.call(arguments,1);return function(){var _=f.slice();return _.push.apply(_,arguments),a.apply(this,_)}}function O(a,d){function f(){}f.prototype=d.prototype,a.aa=d.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(_,P,N){for(var q=Array(arguments.length-2),Oe=2;Oe<arguments.length;Oe++)q[Oe-2]=arguments[Oe];return d.prototype[P].apply(_,q)}}function M(a){let d=a.length;if(0<d){let f=Array(d);for(let _=0;_<d;_++)f[_]=a[_];return f}return[]}function x(a,d){for(let f=1;f<arguments.length;f++){let _=arguments[f];if(l(_)){let P=a.length||0,N=_.length||0;a.length=P+N;for(let q=0;q<N;q++)a[P+q]=_[q]}else a.push(_)}}class B{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function H(a){return/^[\s\xa0]*$/.test(a)}function F(){var a=c.navigator;return a&&(a=a.userAgent)?a:""}function G(a){return G[" "](a),a}G[" "]=function(){};var re=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ee(a,d,f){for(let _ in a)d.call(f,a[_],_,a)}function C(a,d){for(let f in a)d.call(void 0,a[f],f,a)}function w(a){let d={};for(let f in a)d[f]=a[f];return d}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,d){let f,_;for(let P=1;P<arguments.length;P++){_=arguments[P];for(f in _)a[f]=_[f];for(let N=0;N<I.length;N++)f=I[N],Object.prototype.hasOwnProperty.call(_,f)&&(a[f]=_[f])}}function R(a){var d=1;a=a.split(":");let f=[];for(;0<d&&a.length;)f.push(a.shift()),d--;return a.length&&f.push(a.join(":")),f}function D(a){c.setTimeout(()=>{throw a},0)}function T(){var a=ih;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class Qn{constructor(){this.h=this.g=null}add(d,f){let _=Do.get();_.set(d,f),this.h?this.h.next=_:this.g=_,this.h=_}}var Do=new B(()=>new uA,a=>a.reset());class uA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Mo,ko=!1,ih=new Qn,W0=()=>{let a=c.Promise.resolve(void 0);Mo=()=>{a.then(dA)}};var dA=()=>{for(var a;a=T();){try{a.h.call(a.g)}catch(f){D(f)}var d=Do;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}ko=!1};function yi(){this.s=this.s,this.C=this.C}yi.prototype.s=!1,yi.prototype.ma=function(){this.s||(this.s=!0,this.N())},yi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function St(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}St.prototype.h=function(){this.defaultPrevented=!0};var hA=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let f=()=>{};c.addEventListener("test",f,d),c.removeEventListener("test",f,d)}catch{}return a}();function Oo(a,d){if(St.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,_=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(re){e:{try{G(d.nodeName);var P=!0;break e}catch{}P=!1}P||(d=null)}}else f=="mouseover"?d=a.fromElement:f=="mouseout"&&(d=a.toElement);this.relatedTarget=d,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:fA[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&Oo.aa.h.call(this)}}O(Oo,St);var fA={2:"touch",3:"pen",4:"mouse"};Oo.prototype.h=function(){Oo.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var No="closure_listenable_"+(1e6*Math.random()|0),pA=0;function mA(a,d,f,_,P){this.listener=a,this.proxy=null,this.src=d,this.type=f,this.capture=!!_,this.ha=P,this.key=++pA,this.da=this.fa=!1}function Nc(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Vc(a){this.src=a,this.g={},this.h=0}Vc.prototype.add=function(a,d,f,_,P){var N=a.toString();a=this.g[N],a||(a=this.g[N]=[],this.h++);var q=sh(a,d,_,P);return-1<q?(d=a[q],f||(d.fa=!1)):(d=new mA(d,this.src,N,!!_,P),d.fa=f,a.push(d)),d};function rh(a,d){var f=d.type;if(f in a.g){var _=a.g[f],P=Array.prototype.indexOf.call(_,d,void 0),N;(N=0<=P)&&Array.prototype.splice.call(_,P,1),N&&(Nc(d),a.g[f].length==0&&(delete a.g[f],a.h--))}}function sh(a,d,f,_){for(var P=0;P<a.length;++P){var N=a[P];if(!N.da&&N.listener==d&&N.capture==!!f&&N.ha==_)return P}return-1}var oh="closure_lm_"+(1e6*Math.random()|0),ah={};function G0(a,d,f,_,P){if(_&&_.once)return K0(a,d,f,_,P);if(Array.isArray(d)){for(var N=0;N<d.length;N++)G0(a,d[N],f,_,P);return null}return f=dh(f),a&&a[No]?a.K(d,f,u(_)?!!_.capture:!!_,P):H0(a,d,f,!1,_,P)}function H0(a,d,f,_,P,N){if(!d)throw Error("Invalid event type");var q=u(P)?!!P.capture:!!P,Oe=lh(a);if(Oe||(a[oh]=Oe=new Vc(a)),f=Oe.add(d,f,_,q,N),f.proxy)return f;if(_=gA(),f.proxy=_,_.src=a,_.listener=f,a.addEventListener)hA||(P=q),P===void 0&&(P=!1),a.addEventListener(d.toString(),_,P);else if(a.attachEvent)a.attachEvent(J0(d.toString()),_);else if(a.addListener&&a.removeListener)a.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return f}function gA(){function a(f){return d.call(a.src,a.listener,f)}let d=_A;return a}function K0(a,d,f,_,P){if(Array.isArray(d)){for(var N=0;N<d.length;N++)K0(a,d[N],f,_,P);return null}return f=dh(f),a&&a[No]?a.L(d,f,u(_)?!!_.capture:!!_,P):H0(a,d,f,!0,_,P)}function Q0(a,d,f,_,P){if(Array.isArray(d))for(var N=0;N<d.length;N++)Q0(a,d[N],f,_,P);else _=u(_)?!!_.capture:!!_,f=dh(f),a&&a[No]?(a=a.i,d=String(d).toString(),d in a.g&&(N=a.g[d],f=sh(N,f,_,P),-1<f&&(Nc(N[f]),Array.prototype.splice.call(N,f,1),N.length==0&&(delete a.g[d],a.h--)))):a&&(a=lh(a))&&(d=a.g[d.toString()],a=-1,d&&(a=sh(d,f,_,P)),(f=-1<a?d[a]:null)&&ch(f))}function ch(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[No])rh(d.i,a);else{var f=a.type,_=a.proxy;d.removeEventListener?d.removeEventListener(f,_,a.capture):d.detachEvent?d.detachEvent(J0(f),_):d.addListener&&d.removeListener&&d.removeListener(_),(f=lh(d))?(rh(f,a),f.h==0&&(f.src=null,d[oh]=null)):Nc(a)}}}function J0(a){return a in ah?ah[a]:ah[a]="on"+a}function _A(a,d){if(a.da)a=!0;else{d=new Oo(d,this);var f=a.listener,_=a.ha||a.src;a.fa&&ch(a),a=f.call(_,d)}return a}function lh(a){return a=a[oh],a instanceof Vc?a:null}var uh="__closure_events_fn_"+(1e9*Math.random()>>>0);function dh(a){return typeof a=="function"?a:(a[uh]||(a[uh]=function(d){return a.handleEvent(d)}),a[uh])}function Rt(){yi.call(this),this.i=new Vc(this),this.M=this,this.F=null}O(Rt,yi),Rt.prototype[No]=!0,Rt.prototype.removeEventListener=function(a,d,f,_){Q0(this,a,d,f,_)};function Ft(a,d){var f,_=a.F;if(_)for(f=[];_;_=_.F)f.push(_);if(a=a.M,_=d.type||d,typeof d=="string")d=new St(d,a);else if(d instanceof St)d.target=d.target||a;else{var P=d;d=new St(_,a),A(d,P)}if(P=!0,f)for(var N=f.length-1;0<=N;N--){var q=d.g=f[N];P=Fc(q,_,!0,d)&&P}if(q=d.g=a,P=Fc(q,_,!0,d)&&P,P=Fc(q,_,!1,d)&&P,f)for(N=0;N<f.length;N++)q=d.g=f[N],P=Fc(q,_,!1,d)&&P}Rt.prototype.N=function(){if(Rt.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var f=a.g[d],_=0;_<f.length;_++)Nc(f[_]);delete a.g[d],a.h--}}this.F=null},Rt.prototype.K=function(a,d,f,_){return this.i.add(String(a),d,!1,f,_)},Rt.prototype.L=function(a,d,f,_){return this.i.add(String(a),d,!0,f,_)};function Fc(a,d,f,_){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var P=!0,N=0;N<d.length;++N){var q=d[N];if(q&&!q.da&&q.capture==f){var Oe=q.listener,vt=q.ha||q.src;q.fa&&rh(a.i,q),P=Oe.call(vt,_)!==!1&&P}}return P&&!_.defaultPrevented}function Y0(a,d,f){if(typeof a=="function")f&&(a=v(a,f));else if(a&&typeof a.handleEvent=="function")a=v(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:c.setTimeout(a,d||0)}function X0(a){a.g=Y0(()=>{a.g=null,a.i&&(a.i=!1,X0(a))},a.l);let d=a.h;a.h=null,a.m.apply(null,d)}class yA extends yi{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:X0(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vo(a){yi.call(this),this.h=a,this.g={}}O(Vo,yi);var Z0=[];function ey(a){ee(a.g,function(d,f){this.g.hasOwnProperty(f)&&ch(d)},a),a.g={}}Vo.prototype.N=function(){Vo.aa.N.call(this),ey(this)},Vo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hh=c.JSON.stringify,vA=c.JSON.parse,wA=class{stringify(a){return c.JSON.stringify(a,void 0)}parse(a){return c.JSON.parse(a,void 0)}};function fh(){}fh.prototype.h=null;function ty(a){return a.h||(a.h=a.i())}function ny(){}var Fo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ph(){St.call(this,"d")}O(ph,St);function mh(){St.call(this,"c")}O(mh,St);var ir={},iy=null;function Lc(){return iy=iy||new Rt}ir.La="serverreachability";function ry(a){St.call(this,ir.La,a)}O(ry,St);function Lo(a){let d=Lc();Ft(d,new ry(d))}ir.STAT_EVENT="statevent";function sy(a,d){St.call(this,ir.STAT_EVENT,a),this.stat=d}O(sy,St);function Lt(a){let d=Lc();Ft(d,new sy(d,a))}ir.Ma="timingevent";function oy(a,d){St.call(this,ir.Ma,a),this.size=d}O(oy,St);function Uo(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){a()},d)}function jo(){this.g=!0}jo.prototype.xa=function(){this.g=!1};function EA(a,d,f,_,P,N){a.info(function(){if(a.g)if(N)for(var q="",Oe=N.split("&"),vt=0;vt<Oe.length;vt++){var Te=Oe[vt].split("=");if(1<Te.length){var Pt=Te[0];Te=Te[1];var xt=Pt.split("_");q=2<=xt.length&&xt[1]=="type"?q+(Pt+"="+Te+"&"):q+(Pt+"=redacted&")}}else q=null;else q=N;return"XMLHTTP REQ ("+_+") [attempt "+P+"]: "+d+`
`+f+`
`+q})}function bA(a,d,f,_,P,N,q){a.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+P+"]: "+d+`
`+f+`
`+N+" "+q})}function Kr(a,d,f,_){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+TA(a,f)+(_?" "+_:"")})}function IA(a,d){a.info(function(){return"TIMEOUT: "+d})}jo.prototype.info=function(){};function TA(a,d){if(!a.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var _=f[a];if(!(2>_.length)){var P=_[1];if(Array.isArray(P)&&!(1>P.length)){var N=P[0];if(N!="noop"&&N!="stop"&&N!="close")for(var q=1;q<P.length;q++)P[q]=""}}}}return hh(f)}catch{return d}}var Uc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ay={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gh;function jc(){}O(jc,fh),jc.prototype.g=function(){return new XMLHttpRequest},jc.prototype.i=function(){return{}},gh=new jc;function vi(a,d,f,_){this.j=a,this.i=d,this.l=f,this.R=_||1,this.U=new Vo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new cy}function cy(){this.i=null,this.g="",this.h=!1}var ly={},_h={};function yh(a,d,f){a.L=1,a.v=zc(Jn(d)),a.m=f,a.P=!0,uy(a,null)}function uy(a,d){a.F=Date.now(),Bc(a),a.A=Jn(a.v);var f=a.A,_=a.R;Array.isArray(_)||(_=[String(_)]),Ty(f.i,"t",_),a.C=0,f=a.j.J,a.h=new cy,a.g=qy(a.j,f?d:null,!a.m),0<a.O&&(a.M=new yA(v(a.Y,a,a.g),a.O)),d=a.U,f=a.g,_=a.ca;var P="readystatechange";Array.isArray(P)||(P&&(Z0[0]=P.toString()),P=Z0);for(var N=0;N<P.length;N++){var q=G0(f,P[N],_||d.handleEvent,!1,d.h||d);if(!q)break;d.g[q.key]=q}d=a.H?w(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),Lo(),EA(a.i,a.u,a.A,a.l,a.R,a.m)}vi.prototype.ca=function(a){a=a.target;let d=this.M;d&&Yn(a)==3?d.j():this.Y(a)},vi.prototype.Y=function(a){try{if(a==this.g)e:{let xt=Yn(this.g);var d=this.g.Ba();let Yr=this.g.Z();if(!(3>xt)&&(xt!=3||this.g&&(this.h.h||this.g.oa()||Dy(this.g)))){this.J||xt!=4||d==7||(d==8||0>=Yr?Lo(3):Lo(2)),vh(this);var f=this.g.Z();this.X=f;t:if(dy(this)){var _=Dy(this.g);a="";var P=_.length,N=Yn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){rr(this),Bo(this);var q="";break t}this.h.i=new c.TextDecoder}for(d=0;d<P;d++)this.h.h=!0,a+=this.h.i.decode(_[d],{stream:!(N&&d==P-1)});_.length=0,this.h.g+=a,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=f==200,bA(this.i,this.u,this.A,this.l,this.R,xt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var Oe,vt=this.g;if((Oe=vt.g?vt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Oe)){var Te=Oe;break t}}Te=null}if(f=Te)Kr(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wh(this,f);else{this.o=!1,this.s=3,Lt(12),rr(this),Bo(this);break e}}if(this.P){f=!0;let fn;for(;!this.J&&this.C<q.length;)if(fn=CA(this,q),fn==_h){xt==4&&(this.s=4,Lt(14),f=!1),Kr(this.i,this.l,null,"[Incomplete Response]");break}else if(fn==ly){this.s=4,Lt(15),Kr(this.i,this.l,q,"[Invalid Chunk]"),f=!1;break}else Kr(this.i,this.l,fn,null),wh(this,fn);if(dy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||q.length!=0||this.h.h||(this.s=1,Lt(16),f=!1),this.o=this.o&&f,!f)Kr(this.i,this.l,q,"[Invalid Chunked Response]"),rr(this),Bo(this);else if(0<q.length&&!this.W){this.W=!0;var Pt=this.j;Pt.g==this&&Pt.ba&&!Pt.M&&(Pt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),Ah(Pt),Pt.M=!0,Lt(11))}}else Kr(this.i,this.l,q,null),wh(this,q);xt==4&&rr(this),this.o&&!this.J&&(xt==4?Ly(this.j,this):(this.o=!1,Bc(this)))}else qA(this.g),f==400&&0<q.indexOf("Unknown SID")?(this.s=3,Lt(12)):(this.s=0,Lt(13)),rr(this),Bo(this)}}}catch{}finally{}};function dy(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function CA(a,d){var f=a.C,_=d.indexOf(`
`,f);return _==-1?_h:(f=Number(d.substring(f,_)),isNaN(f)?ly:(_+=1,_+f>d.length?_h:(d=d.slice(_,_+f),a.C=_+f,d)))}vi.prototype.cancel=function(){this.J=!0,rr(this)};function Bc(a){a.S=Date.now()+a.I,hy(a,a.I)}function hy(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Uo(v(a.ba,a),d)}function vh(a){a.B&&(c.clearTimeout(a.B),a.B=null)}vi.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(IA(this.i,this.A),this.L!=2&&(Lo(),Lt(17)),rr(this),this.s=2,Bo(this)):hy(this,this.S-a)};function Bo(a){a.j.G==0||a.J||Ly(a.j,a)}function rr(a){vh(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,ey(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function wh(a,d){try{var f=a.j;if(f.G!=0&&(f.g==a||Eh(f.h,a))){if(!a.K&&Eh(f.h,a)&&f.G==3){try{var _=f.Da.g.parse(d)}catch{_=null}if(Array.isArray(_)&&_.length==3){var P=_;if(P[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)Qc(f),Hc(f);else break e;Ch(f),Lt(18)}}else f.za=P[1],0<f.za-f.T&&37500>P[2]&&f.F&&f.v==0&&!f.C&&(f.C=Uo(v(f.Za,f),6e3));if(1>=my(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else or(f,11)}else if((a.K||f.g==a)&&Qc(f),!H(d))for(P=f.Da.g.parse(d),d=0;d<P.length;d++){let Te=P[d];if(f.T=Te[0],Te=Te[1],f.G==2)if(Te[0]=="c"){f.K=Te[1],f.ia=Te[2];let Pt=Te[3];Pt!=null&&(f.la=Pt,f.j.info("VER="+f.la));let xt=Te[4];xt!=null&&(f.Aa=xt,f.j.info("SVER="+f.Aa));let Yr=Te[5];Yr!=null&&typeof Yr=="number"&&0<Yr&&(_=1.5*Yr,f.L=_,f.j.info("backChannelRequestTimeoutMs_="+_)),_=f;let fn=a.g;if(fn){let Yc=fn.g?fn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Yc){var N=_.h;N.g||Yc.indexOf("spdy")==-1&&Yc.indexOf("quic")==-1&&Yc.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(bh(N,N.h),N.h=null))}if(_.D){let Sh=fn.g?fn.g.getResponseHeader("X-HTTP-Session-Id"):null;Sh&&(_.ya=Sh,Le(_.I,_.D,Sh))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),_=f;var q=a;if(_.qa=By(_,_.J?_.ia:null,_.W),q.K){gy(_.h,q);var Oe=q,vt=_.L;vt&&(Oe.I=vt),Oe.B&&(vh(Oe),Bc(Oe)),_.g=q}else Vy(_);0<f.i.length&&Kc(f)}else Te[0]!="stop"&&Te[0]!="close"||or(f,7);else f.G==3&&(Te[0]=="stop"||Te[0]=="close"?Te[0]=="stop"?or(f,7):Th(f):Te[0]!="noop"&&f.l&&f.l.ta(Te),f.v=0)}}Lo(4)}catch{}}var AA=class{constructor(a,d){this.g=a,this.map=d}};function fy(a){this.l=a||10,c.PerformanceNavigationTiming?(a=c.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function py(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function my(a){return a.h?1:a.g?a.g.size:0}function Eh(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function bh(a,d){a.g?a.g.add(d):a.h=d}function gy(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}fy.prototype.cancel=function(){if(this.i=_y(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function _y(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(let f of a.g.values())d=d.concat(f.D);return d}return M(a.i)}function SA(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(l(a)){for(var d=[],f=a.length,_=0;_<f;_++)d.push(a[_]);return d}d=[],f=0;for(_ in a)d[f++]=a[_];return d}function RA(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(l(a)||typeof a=="string"){var d=[];a=a.length;for(var f=0;f<a;f++)d.push(f);return d}d=[],f=0;for(let _ in a)d[f++]=_;return d}}}function yy(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(l(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var f=RA(a),_=SA(a),P=_.length,N=0;N<P;N++)d.call(void 0,_[N],f&&f[N],a)}var vy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function PA(a,d){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var _=a[f].indexOf("="),P=null;if(0<=_){var N=a[f].substring(0,_);P=a[f].substring(_+1)}else N=a[f];d(N,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function sr(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof sr){this.h=a.h,qc(this,a.j),this.o=a.o,this.g=a.g,$c(this,a.s),this.l=a.l;var d=a.i,f=new zo;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),wy(this,f),this.m=a.m}else a&&(d=String(a).match(vy))?(this.h=!1,qc(this,d[1]||"",!0),this.o=qo(d[2]||""),this.g=qo(d[3]||"",!0),$c(this,d[4]),this.l=qo(d[5]||"",!0),wy(this,d[6]||"",!0),this.m=qo(d[7]||"")):(this.h=!1,this.i=new zo(null,this.h))}sr.prototype.toString=function(){var a=[],d=this.j;d&&a.push($o(d,Ey,!0),":");var f=this.g;return(f||d=="file")&&(a.push("//"),(d=this.o)&&a.push($o(d,Ey,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push($o(f,f.charAt(0)=="/"?MA:DA,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",$o(f,OA)),a.join("")};function Jn(a){return new sr(a)}function qc(a,d,f){a.j=f?qo(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function $c(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function wy(a,d,f){d instanceof zo?(a.i=d,NA(a.i,a.h)):(f||(d=$o(d,kA)),a.i=new zo(d,a.h))}function Le(a,d,f){a.i.set(d,f)}function zc(a){return Le(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function qo(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function $o(a,d,f){return typeof a=="string"?(a=encodeURI(a).replace(d,xA),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function xA(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ey=/[#\/\?@]/g,DA=/[#\?:]/g,MA=/[#\?]/g,kA=/[#\?@]/g,OA=/#/g;function zo(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function wi(a){a.g||(a.g=new Map,a.h=0,a.i&&PA(a.i,function(d,f){a.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=zo.prototype,n.add=function(a,d){wi(this),this.i=null,a=Qr(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(d),this.h+=1,this};function by(a,d){wi(a),d=Qr(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Iy(a,d){return wi(a),d=Qr(a,d),a.g.has(d)}n.forEach=function(a,d){wi(this),this.g.forEach(function(f,_){f.forEach(function(P){a.call(d,P,_,this)},this)},this)},n.na=function(){wi(this);let a=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let _=0;_<d.length;_++){let P=a[_];for(let N=0;N<P.length;N++)f.push(d[_])}return f},n.V=function(a){wi(this);let d=[];if(typeof a=="string")Iy(this,a)&&(d=d.concat(this.g.get(Qr(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)d=d.concat(a[f])}return d},n.set=function(a,d){return wi(this),this.i=null,a=Qr(this,a),Iy(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},n.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function Ty(a,d,f){by(a,d),0<f.length&&(a.i=null,a.g.set(Qr(a,d),M(f)),a.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var _=d[f];let N=encodeURIComponent(String(_)),q=this.V(_);for(_=0;_<q.length;_++){var P=N;q[_]!==""&&(P+="="+encodeURIComponent(String(q[_]))),a.push(P)}}return this.i=a.join("&")};function Qr(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function NA(a,d){d&&!a.j&&(wi(a),a.i=null,a.g.forEach(function(f,_){var P=_.toLowerCase();_!=P&&(by(this,_),Ty(this,P,f))},a)),a.j=d}function VA(a,d){let f=new jo;if(c.Image){let _=new Image;_.onload=b(Ei,f,"TestLoadImage: loaded",!0,d,_),_.onerror=b(Ei,f,"TestLoadImage: error",!1,d,_),_.onabort=b(Ei,f,"TestLoadImage: abort",!1,d,_),_.ontimeout=b(Ei,f,"TestLoadImage: timeout",!1,d,_),c.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=a}else d(!1)}function FA(a,d){let f=new jo,_=new AbortController,P=setTimeout(()=>{_.abort(),Ei(f,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:_.signal}).then(N=>{clearTimeout(P),N.ok?Ei(f,"TestPingServer: ok",!0,d):Ei(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(P),Ei(f,"TestPingServer: error",!1,d)})}function Ei(a,d,f,_,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),_(f)}catch{}}function LA(){this.g=new wA}function UA(a,d,f){let _=f||"";try{yy(a,function(P,N){let q=P;u(P)&&(q=hh(P)),d.push(_+N+"="+encodeURIComponent(q))})}catch(P){throw d.push(_+"type="+encodeURIComponent("_badmap")),P}}function Wo(a){this.l=a.Ub||null,this.j=a.eb||!1}O(Wo,fh),Wo.prototype.g=function(){return new Wc(this.l,this.j)},Wo.prototype.i=function(a){return function(){return a}}({});function Wc(a,d){Rt.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}O(Wc,Rt),n=Wc.prototype,n.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,Ho(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||c).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Go(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ho(this)),this.g&&(this.readyState=3,Ho(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cy(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cy(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?Go(this):Ho(this),this.readyState==3&&Cy(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,Go(this))},n.Qa=function(a){this.g&&(this.response=a,Go(this))},n.ga=function(){this.g&&Go(this)};function Go(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ho(a)}n.setRequestHeader=function(a,d){this.u.append(a,d)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=d.next();return a.join(`\r
`)};function Ho(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Wc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Ay(a){let d="";return ee(a,function(f,_){d+=_,d+=":",d+=f,d+=`\r
`}),d}function Ih(a,d,f){e:{for(_ in f){var _=!1;break e}_=!0}_||(f=Ay(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):Le(a,d,f))}function Je(a){Rt.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}O(Je,Rt);var jA=/^https?$/i,BA=["POST","PUT"];n=Je.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,d,f,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gh.g(),this.v=this.o?ty(this.o):ty(gh),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(N){Sy(this,N);return}if(a=f||"",f=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var P in _)f.set(P,_[P]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(let N of _.keys())f.set(N,_.get(N));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(f.keys()).find(N=>N.toLowerCase()=="content-type"),P=c.FormData&&a instanceof c.FormData,!(0<=Array.prototype.indexOf.call(BA,d,void 0))||_||P||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[N,q]of f)this.g.setRequestHeader(N,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xy(this),this.u=!0,this.g.send(a),this.u=!1}catch(N){Sy(this,N)}};function Sy(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,Ry(a),Gc(a)}function Ry(a){a.A||(a.A=!0,Ft(a,"complete"),Ft(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,Ft(this,"complete"),Ft(this,"abort"),Gc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gc(this,!0)),Je.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Py(this):this.bb())},n.bb=function(){Py(this)};function Py(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Yn(a)!=4||a.Z()!=2)){if(a.u&&Yn(a)==4)Y0(a.Ea,0,a);else if(Ft(a,"readystatechange"),Yn(a)==4){a.h=!1;try{let q=a.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var _;if(_=q===0){var P=String(a.D).match(vy)[1]||null;!P&&c.self&&c.self.location&&(P=c.self.location.protocol.slice(0,-1)),_=!jA.test(P?P.toLowerCase():"")}f=_}if(f)Ft(a,"complete"),Ft(a,"success");else{a.m=6;try{var N=2<Yn(a)?a.g.statusText:""}catch{N=""}a.l=N+" ["+a.Z()+"]",Ry(a)}}finally{Gc(a)}}}}function Gc(a,d){if(a.g){xy(a);let f=a.g,_=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||Ft(a,"ready");try{f.onreadystatechange=_}catch{}}}function xy(a){a.I&&(c.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function Yn(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<Yn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),vA(d)}};function Dy(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function qA(a){let d={};a=(a.g&&2<=Yn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<a.length;_++){if(H(a[_]))continue;var f=R(a[_]);let P=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let N=d[P]||[];d[P]=N,N.push(f)}C(d,function(_){return _.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ko(a,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||d}function My(a){this.Aa=0,this.i=[],this.j=new jo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ko("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ko("baseRetryDelayMs",5e3,a),this.cb=Ko("retryDelaySeedMs",1e4,a),this.Wa=Ko("forwardChannelMaxRetries",2,a),this.wa=Ko("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new fy(a&&a.concurrentRequestLimit),this.Da=new LA,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=My.prototype,n.la=8,n.G=1,n.connect=function(a,d,f,_){Lt(0),this.W=a,this.H=d||{},f&&_!==void 0&&(this.H.OSID=f,this.H.OAID=_),this.F=this.X,this.I=By(this,null,this.W),Kc(this)};function Th(a){if(ky(a),a.G==3){var d=a.U++,f=Jn(a.I);if(Le(f,"SID",a.K),Le(f,"RID",d),Le(f,"TYPE","terminate"),Qo(a,f),d=new vi(a,a.j,d),d.L=2,d.v=zc(Jn(f)),f=!1,c.navigator&&c.navigator.sendBeacon)try{f=c.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&c.Image&&(new Image().src=d.v,f=!0),f||(d.g=qy(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Bc(d)}jy(a)}function Hc(a){a.g&&(Ah(a),a.g.cancel(),a.g=null)}function ky(a){Hc(a),a.u&&(c.clearTimeout(a.u),a.u=null),Qc(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&c.clearTimeout(a.s),a.s=null)}function Kc(a){if(!py(a.h)&&!a.s){a.s=!0;var d=a.Ga;Mo||W0(),ko||(Mo(),ko=!0),ih.add(d,a),a.B=0}}function $A(a,d){return my(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Uo(v(a.Ga,a,d),Uy(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let P=new vi(this,this.j,a),N=this.o;if(this.S&&(N?(N=w(N),A(N,this.S)):N=this.S),this.m!==null||this.O||(P.H=N,N=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var _=this.i[f];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(d+=_,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Ny(this,P,d),f=Jn(this.I),Le(f,"RID",a),Le(f,"CVER",22),this.D&&Le(f,"X-HTTP-Session-Id",this.D),Qo(this,f),N&&(this.O?d="headers="+encodeURIComponent(String(Ay(N)))+"&"+d:this.m&&Ih(f,this.m,N)),bh(this.h,P),this.Ua&&Le(f,"TYPE","init"),this.P?(Le(f,"$req",d),Le(f,"SID","null"),P.T=!0,yh(P,f,null)):yh(P,f,d),this.G=2}}else this.G==3&&(a?Oy(this,a):this.i.length==0||py(this.h)||Oy(this))};function Oy(a,d){var f;d?f=d.l:f=a.U++;let _=Jn(a.I);Le(_,"SID",a.K),Le(_,"RID",f),Le(_,"AID",a.T),Qo(a,_),a.m&&a.o&&Ih(_,a.m,a.o),f=new vi(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),d&&(a.i=d.D.concat(a.i)),d=Ny(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),bh(a.h,f),yh(f,_,d)}function Qo(a,d){a.H&&ee(a.H,function(f,_){Le(d,_,f)}),a.l&&yy({},function(f,_){Le(d,_,f)})}function Ny(a,d,f){f=Math.min(a.i.length,f);var _=a.l?v(a.l.Na,a.l,a):null;e:{var P=a.i;let N=-1;for(;;){let q=["count="+f];N==-1?0<f?(N=P[0].g,q.push("ofs="+N)):N=0:q.push("ofs="+N);let Oe=!0;for(let vt=0;vt<f;vt++){let Te=P[vt].g,Pt=P[vt].map;if(Te-=N,0>Te)N=Math.max(0,P[vt].g-100),Oe=!1;else try{UA(Pt,q,"req"+Te+"_")}catch{_&&_(Pt)}}if(Oe){_=q.join("&");break e}}}return a=a.i.splice(0,f),d.D=a,_}function Vy(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;Mo||W0(),ko||(Mo(),ko=!0),ih.add(d,a),a.v=0}}function Ch(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Uo(v(a.Fa,a),Uy(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Fy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Uo(v(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Lt(10),Hc(this),Fy(this))};function Ah(a){a.A!=null&&(c.clearTimeout(a.A),a.A=null)}function Fy(a){a.g=new vi(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=Jn(a.qa);Le(d,"RID","rpc"),Le(d,"SID",a.K),Le(d,"AID",a.T),Le(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&Le(d,"TO",a.ja),Le(d,"TYPE","xmlhttp"),Qo(a,d),a.m&&a.o&&Ih(d,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=zc(Jn(d)),f.m=null,f.P=!0,uy(f,a)}n.Za=function(){this.C!=null&&(this.C=null,Hc(this),Ch(this),Lt(19))};function Qc(a){a.C!=null&&(c.clearTimeout(a.C),a.C=null)}function Ly(a,d){var f=null;if(a.g==d){Qc(a),Ah(a),a.g=null;var _=2}else if(Eh(a.h,d))f=d.D,gy(a.h,d),_=1;else return;if(a.G!=0){if(d.o)if(_==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var P=a.B;_=Lc(),Ft(_,new oy(_,f)),Kc(a)}else Vy(a);else if(P=d.s,P==3||P==0&&0<d.X||!(_==1&&$A(a,d)||_==2&&Ch(a)))switch(f&&0<f.length&&(d=a.h,d.i=d.i.concat(f)),P){case 1:or(a,5);break;case 4:or(a,10);break;case 3:or(a,6);break;default:or(a,2)}}}function Uy(a,d){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*d}function or(a,d){if(a.j.info("Error code "+d),d==2){var f=v(a.fb,a),_=a.Xa;let P=!_;_=new sr(_||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||qc(_,"https"),zc(_),P?VA(_.toString(),f):FA(_.toString(),f)}else Lt(2);a.G=0,a.l&&a.l.sa(d),jy(a),ky(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Lt(2)):(this.j.info("Failed to ping google.com"),Lt(1))};function jy(a){if(a.G=0,a.ka=[],a.l){let d=_y(a.h);(d.length!=0||a.i.length!=0)&&(x(a.ka,d),x(a.ka,a.i),a.h.i.length=0,M(a.i),a.i.length=0),a.l.ra()}}function By(a,d,f){var _=f instanceof sr?Jn(f):new sr(f);if(_.g!="")d&&(_.g=d+"."+_.g),$c(_,_.s);else{var P=c.location;_=P.protocol,d=d?d+"."+P.hostname:P.hostname,P=+P.port;var N=new sr(null);_&&qc(N,_),d&&(N.g=d),P&&$c(N,P),f&&(N.l=f),_=N}return f=a.D,d=a.ya,f&&d&&Le(_,f,d),Le(_,"VER",a.la),Qo(a,_),_}function qy(a,d,f){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new Je(new Wo({eb:f})):new Je(a.pa),d.Ha(a.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function $y(){}n=$y.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Jc(){}Jc.prototype.g=function(a,d){return new Ht(a,d)};function Ht(a,d){Rt.call(this),this.g=new My(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!H(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!H(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new Jr(this)}O(Ht,Rt),Ht.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ht.prototype.close=function(){Th(this.g)},Ht.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=hh(a),a=f);d.i.push(new AA(d.Ya++,a)),d.G==3&&Kc(d)},Ht.prototype.N=function(){this.g.l=null,delete this.j,Th(this.g),delete this.g,Ht.aa.N.call(this)};function zy(a){ph.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(let f in d){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}O(zy,ph);function Wy(){mh.call(this),this.status=1}O(Wy,mh);function Jr(a){this.g=a}O(Jr,$y),Jr.prototype.ua=function(){Ft(this.g,"a")},Jr.prototype.ta=function(a){Ft(this.g,new zy(a))},Jr.prototype.sa=function(a){Ft(this.g,new Wy)},Jr.prototype.ra=function(){Ft(this.g,"b")},Jc.prototype.createWebChannel=Jc.prototype.g,Ht.prototype.send=Ht.prototype.o,Ht.prototype.open=Ht.prototype.m,Ht.prototype.close=Ht.prototype.close,Cp=si.createWebChannelTransport=function(){return new Jc},Tp=si.getStatEventTarget=function(){return Lc()},Ip=si.Event=ir,iu=si.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Uc.NO_ERROR=0,Uc.TIMEOUT=8,Uc.HTTP_ERROR=6,Va=si.ErrorCode=Uc,ay.COMPLETE="complete",bp=si.EventType=ay,ny.EventType=Fo,Fo.OPEN="a",Fo.CLOSE="b",Fo.ERROR="c",Fo.MESSAGE="d",Rt.prototype.listen=Rt.prototype.K,Ss=si.WebChannel=ny,JP=si.FetchXmlHttpFactory=Wo,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,Ep=si.XhrIo=Je}).apply(typeof nu<"u"?nu:typeof self<"u"?self:typeof window<"u"?window:{});var dE="@firebase/firestore";var lt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};lt.UNAUTHENTICATED=new lt(null),lt.GOOGLE_CREDENTIALS=new lt("google-credentials-uid"),lt.FIRST_PARTY=new lt("first-party-uid"),lt.MOCK_USER=new lt("mock-user");var ro="10.14.0";var Bi=new ml("@firebase/firestore");function Ms(){return Bi.logLevel}function xg(n){Bi.setLogLevel(n)}function U(n,...e){if(Bi.logLevel<=Rn.DEBUG){let t=e.map(Dg);Bi.debug(`Firestore (${ro}): ${n}`,...t)}}function nt(n,...e){if(Bi.logLevel<=Rn.ERROR){let t=e.map(Dg);Bi.error(`Firestore (${ro}): ${n}`,...t)}}function vn(n,...e){if(Bi.logLevel<=Rn.WARN){let t=e.map(Dg);Bi.warn(`Firestore (${ro}): ${n}`,...t)}}function Dg(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function K(n="Unexpected state"){let e=`FIRESTORE (${ro}) INTERNAL ASSERTION FAILED: `+n;throw nt(e),new Error(e)}function J(n,e){n||K()}function pb(n,e){n||K()}function $(n,e){return n}var V={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends pl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ft=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var fu=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Dp=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lt.UNAUTHENTICATED))}shutdown(){}},Mp=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},kp=class{constructor(e){this.t=e,this.currentUser=lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){J(this.o===void 0);let i=this.i,r=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve(),s=new ft;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ft,e.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>E(this,null,function*(){yield l.promise,yield r(this.currentUser)}))},c=l=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ft)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(J(typeof i.accessToken=="string"),new fu(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return J(e===null||typeof e=="string"),new lt(e)}},Op=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Np=class{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new Op(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Vp=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Fp=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){J(this.o===void 0);let i=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};let r=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(J(typeof t.token=="string"),this.R=t.token,new Vp(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function YP(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}var pu=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,i="";for(;i.length<20;){let r=YP(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<t&&(i+=e.charAt(r[s]%e.length))}return i}};function he(n,e){return n<e?-1:n>e?1:0}function Bs(n,e,t){return n.length===e.length&&n.every((i,r)=>t(i,e[r]))}function mb(n){return n+"\0"}var He=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(V.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(V.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new n(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?he(this.nanoseconds,e.nanoseconds):he(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ie=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new He(0,0))}static max(){return new n(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var mu=class n{constructor(e,t,i){t===void 0?t=0:t>e.length&&K(),i===void 0?i=e.length-t:i>e.length-t&&K(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let i=Math.min(e.length,t.length);for(let r=0;r<i;r++){let s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Ee=class n extends mu{construct(e,t,i){return new n(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let i of e){if(i.indexOf("//")>=0)throw new L(V.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new n(t)}static emptyPath(){return new n([])}},XP=/^[_a-zA-Z][_a-zA-Z0-9]*$/,it=class n extends mu{construct(e,t,i){return new n(e,t,i)}static isValidIdentifier(e){return XP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],i="",r=0,s=()=>{if(i.length===0)throw new L(V.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""},o=!1;for(;r<e.length;){let c=e[r];if(c==="\\"){if(r+1===e.length)throw new L(V.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new L(V.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=l,r+=2}else c==="`"?(o=!o,r++):c!=="."||o?(i+=c,r++):(s(),r++)}if(s(),o)throw new L(V.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var z=class n{constructor(e){this.path=e}static fromPath(e){return new n(Ee.fromString(e))}static fromName(e){return new n(Ee.fromString(e).popFirst(5))}static empty(){return new n(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ee.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Ee(e.slice()))}};var qs=class{constructor(e,t,i,r){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=r}};function Lp(n){return n.fields.find(e=>e.kind===2)}function yr(n){return n.fields.filter(e=>e.kind!==2)}qs.UNKNOWN_ID=-1;var Ls=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ka=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,dn.min())}};function gb(n,e){let t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=ie.fromTimestamp(i===1e9?new He(t+1,0):new He(t,i));return new dn(r,z.empty(),e)}function _b(n){return new dn(n.readTime,n.key,-1)}var dn=class n{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new n(ie.min(),z.empty(),-1)}static max(){return new n(ie.max(),z.empty(),-1)}};function Mg(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=z.comparator(n.documentKey,e.documentKey),t!==0?t:he(n.largestBatchId,e.largestBatchId))}var yb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",gu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Yi(n){return E(this,null,function*(){if(n.code!==V.FAILED_PRECONDITION||n.message!==yb)throw n;U("LocalStore","Unexpectedly lost primary lease")})}var k=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(i,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,i)=>{t(e)})}static reject(e){return new n((t,i)=>{i(e)})}static waitFor(e){return new n((t,i)=>{let r=0,s=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++s,o&&s===r&&t()},l=>i(l))}),o=!0,s===r&&t()})}static or(e){let t=n.resolve(!1);for(let i of e)t=t.next(r=>r?n.resolve(r):i());return t}static forEach(e,t){let i=[];return e.forEach((r,s)=>{i.push(t.call(this,r,s))}),this.waitFor(i)}static mapArray(e,t){return new n((i,r)=>{let s=e.length,o=new Array(s),c=0;for(let l=0;l<s;l++){let u=l;t(e[u]).next(h=>{o[u]=h,++c,c===s&&i(o)},h=>r(h))}})}static doWhile(e,t){return new n((i,r)=>{let s=()=>{e()===!0?t().next(()=>{s()},r):i()};s()})}};var _u=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ft,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Tr(e,t.error)):this.V.resolve()},this.transaction.onerror=i=>{let r=kg(i.target.error);this.V.reject(new Tr(e,r))}}static open(e,t,i,r){try{return new n(t,e.transaction(r,i))}catch(s){throw new Tr(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new jp(t)}},qi=class n{constructor(e,t,i){this.name=e,this.version=t,this.p=i,n.S(ia())===12.2&&nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),vr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!fl())return!1;if(n.v())return!0;let e=ia(),t=n.S(e),i=0<t&&t<10,r=vb(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}M(e){return E(this,null,function*(){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;t(o)},r.onblocked=()=>{i(new Tr(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?i(new L(V.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new L(V.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Tr(e,o))},r.onupgradeneeded=s=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,r.transaction,s.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,r){return E(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let c=_u.open(this.db,e,s?"readonly":"readwrite",i),l=r(c).next(u=>(c.g(),u)).catch(u=>(c.abort(u),k.reject(u))).toPromise();return l.catch(()=>{}),yield c.m,l}catch(c){let l=c,u=l.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function vb(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Up=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return vr(this.B.delete())}},Tr=class extends L{constructor(e,t){super(V.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function Xi(n){return n.name==="IndexedDbTransactionError"}var jp=class{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),vr(i)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),vr(this.store.add(e))}get(e){return vr(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),vr(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),vr(this.store.count())}U(e,t){let i=this.options(e,t),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(i.range);return new k((o,c)=>{s.onerror=l=>{c(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{let s=this.cursor(i),o=[];return this.W(s,(c,l)=>{o.push(l)}).next(()=>o)}}G(e,t){let i=this.store.getAll(e,t===null?void 0:t);return new k((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);let i=this.options(e,t);i.H=!1;let r=this.cursor(i);return this.W(r,(s,o,c)=>c.delete())}J(e,t){let i;t?i=e:(i={},t=e);let r=this.cursor(i);return this.W(r,t)}Y(e){let t=this.cursor({});return new k((i,r)=>{t.onerror=s=>{let o=kg(s.target.error);r(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(c=>{c?o.continue():i()}):i()}})}W(e,t){let i=[];return new k((r,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let c=o.target.result;if(!c)return void r();let l=new Up(c),u=t(c.primaryKey,c.value,l);if(u instanceof k){let h=u.catch(g=>(l.done(),k.reject(g)));i.push(h)}l.isDone?r():l.K===null?c.continue():c.continue(l.K)}}).next(()=>k.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let i=this.store.index(e.index);return e.H?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function vr(n){return new k((e,t)=>{n.onsuccess=i=>{let r=i.target.result;e(r)},n.onerror=i=>{let r=kg(i.target.error);t(r)}})}var hE=!1;function kg(n){let e=qi.S(ia());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let i=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return hE||(hE=!0,setTimeout(()=>{throw i},0)),i}}return n}var Bp=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>E(this,null,function*(){this.task=null;try{U("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){Xi(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield Yi(t)}yield this.X(6e4)}))}},qp=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return E(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let i=new Set,r=t,s=!0;return k.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!i.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,r).next(c=>{r-=c,i.add(o)});s=!1})).next(()=>t-r)}ne(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,i).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(r,s)).next(c=>(U("IndexBackfiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>o.size)}))}re(e,t){let i=e;return t.changes.forEach((r,s)=>{let o=_b(s);Mg(o,i)>0&&(i=o)}),new dn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}};var tn=(()=>{class n{constructor(t,i){this.previousValue=t,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function mc(n){return n==null}function Qa(n){return n===0&&1/n==-1/0}function wb(n){return typeof n=="number"&&Number.isInteger(n)&&!Qa(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ut(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=fE(e)),e=ZP(n.get(t),e);return fE(e)}function ZP(n,e){let t=e,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function fE(n){return n+""}function Nn(n){let e=n.length;if(J(e>=2),e===2)return J(n.charAt(0)===""&&n.charAt(1)===""),Ee.emptyPath();let t=e-2,i=[],r="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&K(),n.charAt(o+1)){case"":let c=n.substring(s,o),l;r.length===0?l=c:(r+=c,l=r,r=""),i.push(l);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:K()}s=o+2}return new Ee(i)}var pE=["userId","batchId"];function cu(n,e){return[n,Ut(e)]}function Eb(n,e,t){return[n,Ut(e),t]}var ex={},tx=["prefixPath","collectionGroup","readTime","documentId"],nx=["prefixPath","collectionGroup","documentId"],ix=["collectionGroup","readTime","prefixPath","documentId"],rx=["canonicalId","targetId"],sx=["targetId","path"],ox=["path","targetId"],ax=["collectionId","parent"],cx=["indexId","uid"],lx=["uid","sequenceNumber"],ux=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],dx=["indexId","uid","orderedDocumentKey"],hx=["userId","collectionPath","documentId"],fx=["userId","collectionPath","largestBatchId"],px=["userId","collectionGroup","largestBatchId"],bb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],mx=[...bb,"documentOverlays"],Ib=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Tb=Ib,Og=[...Tb,"indexConfiguration","indexState","indexEntries"],gx=Og,_x=[...Og,"globals"];var Ja=class extends gu{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function pt(n,e){let t=$(n);return qi.F(t._e,e)}function mE(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Cb(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ue=class n{constructor(e,t){this.comparator=e,this.root=t||Fn.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){let e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fs(this.root,e,this.comparator,!0)}},Fs=class{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?i(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Fn=class n{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,s){return new n(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this,s=i(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();let e=this.left.check();if(e!==this.right.check())throw K();return e+(this.isRed()?0:1)}};Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(e,t,i,r,s){return this}insert(e,t,i){return new Fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ne=class n{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){let i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yu(this.data.getIterator())}getIteratorFrom(e){return new yu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},yu=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Rs(n){return n.hasNext()?n.getNext():void 0}var nn=class n{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ne(it.comparator);for(let i of this.fields)t=t.add(i);for(let i of e)t=t.add(i);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Bs(this.fields,e.fields,(t,i)=>t.isEqual(i))}};var vu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Ab(){return typeof atob<"u"}var st=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new vu("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return he(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};st.EMPTY_BYTE_STRING=new st("");var yx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ci(n){if(J(!!n),typeof n=="string"){let e=0,t=yx.exec(n);if(J(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ze(n.seconds),nanos:ze(n.nanos)}}function ze(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function $i(n){return typeof n=="string"?st.fromBase64String(n):st.fromUint8Array(n)}function ud(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ng(n){let e=n.mapValue.fields.__previous_value__;return ud(e)?Ng(e):e}function Ya(n){let e=ci(n.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}var $p=class{constructor(e,t,i,r,s,o,c,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=u}},zi=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ui={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},lu={nullValue:"NULL_VALUE"};function Cr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ud(n)?4:Sb(n)?9007199254740991:dd(n)?10:11:K()}function jn(n,e){if(n===e)return!0;let t=Cr(n);if(t!==Cr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ya(n).isEqual(Ya(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=ci(r.timestampValue),c=ci(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,s){return $i(r.bytesValue).isEqual($i(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return ze(r.geoPointValue.latitude)===ze(s.geoPointValue.latitude)&&ze(r.geoPointValue.longitude)===ze(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return ze(r.integerValue)===ze(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=ze(r.doubleValue),c=ze(s.doubleValue);return o===c?Qa(o)===Qa(c):isNaN(o)&&isNaN(c)}return!1}(n,e);case 9:return Bs(n.arrayValue.values||[],e.arrayValue.values||[],jn);case 10:case 11:return function(r,s){let o=r.mapValue.fields||{},c=s.mapValue.fields||{};if(mE(o)!==mE(c))return!1;for(let l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!jn(o[l],c[l])))return!1;return!0}(n,e);default:return K()}}function Xa(n,e){return(n.values||[]).find(t=>jn(t,e))!==void 0}function Wi(n,e){if(n===e)return 0;let t=Cr(n),i=Cr(e);if(t!==i)return he(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return he(n.booleanValue,e.booleanValue);case 2:return function(s,o){let c=ze(s.integerValue||s.doubleValue),l=ze(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return gE(n.timestampValue,e.timestampValue);case 4:return gE(Ya(n),Ya(e));case 5:return he(n.stringValue,e.stringValue);case 6:return function(s,o){let c=$i(s),l=$i(o);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let c=s.split("/"),l=o.split("/");for(let u=0;u<c.length&&u<l.length;u++){let h=he(c[u],l[u]);if(h!==0)return h}return he(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let c=he(ze(s.latitude),ze(o.latitude));return c!==0?c:he(ze(s.longitude),ze(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return _E(n.arrayValue,e.arrayValue);case 10:return function(s,o){var c,l,u,h;let g=s.fields||{},v=o.fields||{},b=(c=g.value)===null||c===void 0?void 0:c.arrayValue,O=(l=v.value)===null||l===void 0?void 0:l.arrayValue,M=he(((u=b?.values)===null||u===void 0?void 0:u.length)||0,((h=O?.values)===null||h===void 0?void 0:h.length)||0);return M!==0?M:_E(b,O)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ui.mapValue&&o===Ui.mapValue)return 0;if(s===Ui.mapValue)return 1;if(o===Ui.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let g=0;g<l.length&&g<h.length;++g){let v=he(l[g],h[g]);if(v!==0)return v;let b=Wi(c[l[g]],u[h[g]]);if(b!==0)return b}return he(l.length,h.length)}(n.mapValue,e.mapValue);default:throw K()}}function gE(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return he(n,e);let t=ci(n),i=ci(e),r=he(t.seconds,i.seconds);return r!==0?r:he(t.nanos,i.nanos)}function _E(n,e){let t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){let s=Wi(t[r],i[r]);if(s)return s}return he(t.length,i.length)}function $s(n){return zp(n)}function zp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let i=ci(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return $i(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return z.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",r=!0;for(let s of t.values||[])r?r=!1:i+=",",i+=zp(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){let i=Object.keys(t.fields||{}).sort(),r="{",s=!0;for(let o of i)s?s=!1:r+=",",r+=`${o}:${zp(t.fields[o])}`;return r+"}"}(n.mapValue):K()}function Ar(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Wp(n){return!!n&&"integerValue"in n}function Za(n){return!!n&&"arrayValue"in n}function yE(n){return!!n&&"nullValue"in n}function vE(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function uu(n){return!!n&&"mapValue"in n}function dd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function $a(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Vr(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=$a(i)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$a(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Sb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Rb={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function vx(n){return"nullValue"in n?lu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ar(zi.empty(),z.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?dd(n)?Rb:{mapValue:{}}:K()}function wx(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ar(zi.empty(),z.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Rb:"mapValue"in n?dd(n)?{mapValue:{}}:Ui:K()}function wE(n,e){let t=Wi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function EE(n,e){let t=Wi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Nt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!uu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$a(t)}setAll(e){let t=it.emptyPath(),i={},r=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,i,r),i={},r=[],t=c.popLast()}o?i[c.lastSegment()]=$a(o):r.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,i,r)}delete(e){let t=this.field(e.popLast());uu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];uu(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){Vr(t,(r,s)=>e[r]=s);for(let r of i)delete e[r]}clone(){return new n($a(this.value))}};function Pb(n){let e=[];return Vr(n.fields,(t,i)=>{let r=new it([t]);if(uu(i)){let s=Pb(i.mapValue).fields;if(s.length===0)e.push(r);else for(let o of s)e.push(r.child(o))}else e.push(r)}),new nn(e)}var ut=class n{constructor(e,t,i,r,s,o,c){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,ie.min(),ie.min(),ie.min(),Nt.empty(),0)}static newFoundDocument(e,t,i,r){return new n(e,1,t,ie.min(),i,r,0)}static newNoDocument(e,t){return new n(e,2,t,ie.min(),ie.min(),Nt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ie.min(),ie.min(),Nt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Bn=class{constructor(e,t){this.position=e,this.inclusive=t}};function bE(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){let s=e[r],o=n.position[r];if(s.field.isKeyField()?i=z.comparator(z.fromName(o.referenceValue),t.key):i=Wi(o,t.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function IE(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jn(n.position[t],e.position[t]))return!1;return!0}var Sr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Ex(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var wu=class{},_e=class n extends wu{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new Kp(e,t,i):t==="array-contains"?new Yp(e,i):t==="in"?new Eu(e,i):t==="not-in"?new Xp(e,i):t==="array-contains-any"?new Zp(e,i):new n(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new Qp(e,i):new Jp(e,i)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Wi(t,this.value)):t!==null&&Cr(this.value)===Cr(t)&&this.matchesComparison(Wi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},xe=class n extends wu{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return zs(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function zs(n){return n.op==="and"}function Gp(n){return n.op==="or"}function Vg(n){return xb(n)&&zs(n)}function xb(n){for(let e of n.filters)if(e instanceof xe)return!1;return!0}function Hp(n){if(n instanceof _e)return n.field.canonicalString()+n.op.toString()+$s(n.value);if(Vg(n))return n.filters.map(e=>Hp(e)).join(",");{let e=n.filters.map(t=>Hp(t)).join(",");return`${n.op}(${e})`}}function Db(n,e){return n instanceof _e?function(i,r){return r instanceof _e&&i.op===r.op&&i.field.isEqual(r.field)&&jn(i.value,r.value)}(n,e):n instanceof xe?function(i,r){return r instanceof xe&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,c)=>s&&Db(o,r.filters[c]),!0):!1}(n,e):void K()}function Mb(n,e){let t=n.filters.concat(e);return xe.create(t,n.op)}function kb(n){return n instanceof _e?function(t){return`${t.field.canonicalString()} ${t.op} ${$s(t.value)}`}(n):n instanceof xe?function(t){return t.op.toString()+" {"+t.getFilters().map(kb).join(" ,")+"}"}(n):"Filter"}var Kp=class extends _e{constructor(e,t,i){super(e,t,i),this.key=z.fromName(i.referenceValue)}matches(e){let t=z.comparator(e.key,this.key);return this.matchesComparison(t)}},Qp=class extends _e{constructor(e,t){super(e,"in",t),this.keys=Ob("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Jp=class extends _e{constructor(e,t){super(e,"not-in",t),this.keys=Ob("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Ob(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>z.fromName(i.referenceValue))}var Yp=class extends _e{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Za(t)&&Xa(t.arrayValue,this.value)}},Eu=class extends _e{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Xa(this.value.arrayValue,t)}},Xp=class extends _e{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Xa(this.value.arrayValue,t)}},Zp=class extends _e{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Za(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>Xa(this.value.arrayValue,i))}};var em=class{constructor(e,t=null,i=[],r=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=c,this.ue=null}};function tm(n,e=null,t=[],i=[],r=null,s=null,o=null){return new em(n,e,t,i,r,s,o)}function Rr(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Hp(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),mc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>$s(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>$s(i)).join(",")),e.ue=t}return e.ue}function gc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Ex(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Db(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!IE(n.startAt,e.startAt)&&IE(n.endAt,e.endAt)}function bu(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Iu(n,e){return n.filters.filter(t=>t instanceof _e&&t.field.isEqual(e))}function TE(n,e,t){let i=lu,r=!0;for(let s of Iu(n,e)){let o=lu,c=!0;switch(s.op){case"<":case"<=":o=vx(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,c=!1;break;case"!=":case"not-in":o=lu}wE({value:i,inclusive:r},{value:o,inclusive:c})<0&&(i=o,r=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];wE({value:i,inclusive:r},{value:o,inclusive:t.inclusive})<0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}function CE(n,e,t){let i=Ui,r=!0;for(let s of Iu(n,e)){let o=Ui,c=!0;switch(s.op){case">=":case">":o=wx(s.value),c=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,c=!1;break;case"!=":case"not-in":o=Ui}EE({value:i,inclusive:r},{value:o,inclusive:c})>0&&(i=o,r=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];EE({value:i,inclusive:r},{value:o,inclusive:t.inclusive})>0&&(i=o,r=t.inclusive);break}}return{value:i,inclusive:r}}var wn=class{constructor(e,t=null,i=[],r=[],s=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Nb(n,e,t,i,r,s,o,c){return new wn(n,e,t,i,r,s,o,c)}function so(n){return new wn(n)}function AE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Fg(n){return n.collectionGroup!==null}function Us(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ne(it.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(c=c.add(u.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Sr(s,i))}),t.has(it.keyField().canonicalString())||e.ce.push(new Sr(it.keyField(),i))}return e.ce}function jt(n){let e=$(n);return e.le||(e.le=bx(e,Us(n))),e.le}function bx(n,e){if(n.limitType==="F")return tm(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new Sr(r.field,s)});let t=n.endAt?new Bn(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Bn(n.startAt.position,n.startAt.inclusive):null;return tm(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function nm(n,e){let t=n.filters.concat([e]);return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Tu(n,e,t){return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _c(n,e){return gc(jt(n),jt(e))&&n.limitType===e.limitType}function Vb(n){return`${Rr(jt(n))}|lt:${n.limitType}`}function ks(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(r=>kb(r)).join(", ")}]`),mc(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(r=>$s(r)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(r=>$s(r)).join(",")),`Target(${i})`}(jt(n))}; limitType=${n.limitType})`}function yc(n,e){return e.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):z.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,e)&&function(i,r){for(let s of Us(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,e)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,e)&&function(i,r){return!(i.startAt&&!function(o,c,l){let u=bE(o,c,l);return o.inclusive?u<=0:u<0}(i.startAt,Us(i),r)||i.endAt&&!function(o,c,l){let u=bE(o,c,l);return o.inclusive?u>=0:u>0}(i.endAt,Us(i),r))}(n,e)}function Fb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Lb(n){return(e,t)=>{let i=!1;for(let r of Us(n)){let s=Ix(r,e,t);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function Ix(n,e,t){let i=n.field.isKeyField()?z.comparator(e.key,t.key):function(s,o,c){let l=o.data.field(s),u=c.data.field(s);return l!==null&&u!==null?Wi(l,u):K()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return K()}}var qn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Vr(this.inner,(t,i)=>{for(let[r,s]of i)e(r,s)})}isEmpty(){return Cb(this.inner)}size(){return this.innerSize}};var Tx=new Ue(z.comparator);function Gt(){return Tx}var Ub=new Ue(z.comparator);function Ba(...n){let e=Ub;for(let t of n)e=e.insert(t.key,t);return e}function jb(n){let e=Ub;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function Vn(){return za()}function Bb(){return za()}function za(){return new qn(n=>n.toString(),(n,e)=>n.isEqual(e))}var Cx=new Ue(z.comparator),Ax=new Ne(z.comparator);function fe(...n){let e=Ax;for(let t of n)e=e.add(t);return e}var Sx=new Ne(he);function Lg(){return Sx}function Ug(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qa(e)?"-0":e}}function qb(n){return{integerValue:""+n}}function $b(n,e){return wb(e)?qb(e):Ug(n,e)}var Ws=class{constructor(){this._=void 0}};function Rx(n,e,t){return n instanceof Gi?function(r,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&ud(s)&&(s=Ng(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof li?Wb(n,e):n instanceof ui?Gb(n,e):function(r,s){let o=zb(r,s),c=SE(o)+SE(r.Pe);return Wp(o)&&Wp(r.Pe)?qb(c):Ug(r.serializer,c)}(n,e)}function Px(n,e,t){return n instanceof li?Wb(n,e):n instanceof ui?Gb(n,e):t}function zb(n,e){return n instanceof Hi?function(i){return Wp(i)||function(s){return!!s&&"doubleValue"in s}(i)}(e)?e:{integerValue:0}:null}var Gi=class extends Ws{},li=class extends Ws{constructor(e){super(),this.elements=e}};function Wb(n,e){let t=Hb(e);for(let i of n.elements)t.some(r=>jn(r,i))||t.push(i);return{arrayValue:{values:t}}}var ui=class extends Ws{constructor(e){super(),this.elements=e}};function Gb(n,e){let t=Hb(e);for(let i of n.elements)t=t.filter(r=>!jn(r,i));return{arrayValue:{values:t}}}var Hi=class extends Ws{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function SE(n){return ze(n.integerValue||n.doubleValue)}function Hb(n){return Za(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Pr=class{constructor(e,t){this.field=e,this.transform=t}};function xx(n,e){return n.field.isEqual(e.field)&&function(i,r){return i instanceof li&&r instanceof li||i instanceof ui&&r instanceof ui?Bs(i.elements,r.elements,jn):i instanceof Hi&&r instanceof Hi?jn(i.Pe,r.Pe):i instanceof Gi&&r instanceof Gi}(n.transform,e.transform)}var im=class{constructor(e,t){this.version=e,this.transformResults=t}},et=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function du(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Gs=class{};function Kb(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qi(n.key,et.none()):new Ki(n.key,n.data,et.none());{let t=n.data,i=Nt.empty(),r=new Ne(it.comparator);for(let s of e.fields)if(!r.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new En(n.key,i,new nn(r.toArray()),et.none())}}function Dx(n,e,t){n instanceof Ki?function(r,s,o){let c=r.value.clone(),l=PE(r.fieldTransforms,s,o.transformResults);c.setAll(l),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):n instanceof En?function(r,s,o){if(!du(r.precondition,s))return void s.convertToUnknownDocument(o.version);let c=PE(r.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(Qb(r)),l.setAll(c),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Wa(n,e,t,i){return n instanceof Ki?function(s,o,c,l){if(!du(s.precondition,o))return c;let u=s.value.clone(),h=xE(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof En?function(s,o,c,l){if(!du(s.precondition,o))return c;let u=xE(s.fieldTransforms,l,o),h=o.data;return h.setAll(Qb(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,i):function(s,o,c){return du(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(n,e,t)}function Mx(n,e){let t=null;for(let i of n.fieldTransforms){let r=e.data.field(i.field),s=zb(i.transform,r||null);s!=null&&(t===null&&(t=Nt.empty()),t.set(i.field,s))}return t||null}function RE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Bs(i,r,(s,o)=>xx(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ki=class extends Gs{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},En=class extends Gs{constructor(e,t,i,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Qb(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let i=n.data.field(t);e.set(t,i)}}),e}function PE(n,e,t){let i=new Map;J(n.length===t.length);for(let r=0;r<t.length;r++){let s=n[r],o=s.transform,c=e.data.field(s.field);i.set(s.field,Px(o,c,t[r]))}return i}function xE(n,e,t){let i=new Map;for(let r of n){let s=r.transform,o=t.data.field(r.field);i.set(r.field,Rx(s,o,e))}return i}var Qi=class extends Gs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ec=class extends Gs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var tc=class{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){let i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(e.key)&&Dx(s,e,i[r])}}applyToLocalView(e,t){for(let i of this.baseMutations)i.key.isEqual(e.key)&&(t=Wa(i,e,t,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(e.key)&&(t=Wa(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let i=Bb();return this.mutations.forEach(r=>{let s=e.get(r.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(r.key)?null:c;let l=Kb(o,c);l!==null&&i.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(ie.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),fe())}isEqual(e){return this.batchId===e.batchId&&Bs(this.mutations,e.mutations,(t,i)=>RE(t,i))&&Bs(this.baseMutations,e.baseMutations,(t,i)=>RE(t,i))}},rm=class n{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){J(e.mutations.length===i.length);let r=function(){return Cx}(),s=e.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(e,t,i,r)}};var nc=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var sm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var at,we;function Jb(n){switch(n){default:return K();case V.CANCELLED:case V.UNKNOWN:case V.DEADLINE_EXCEEDED:case V.RESOURCE_EXHAUSTED:case V.INTERNAL:case V.UNAVAILABLE:case V.UNAUTHENTICATED:return!1;case V.INVALID_ARGUMENT:case V.NOT_FOUND:case V.ALREADY_EXISTS:case V.PERMISSION_DENIED:case V.FAILED_PRECONDITION:case V.ABORTED:case V.OUT_OF_RANGE:case V.UNIMPLEMENTED:case V.DATA_LOSS:return!0}}function Yb(n){if(n===void 0)return nt("GRPC error has no .code"),V.UNKNOWN;switch(n){case at.OK:return V.OK;case at.CANCELLED:return V.CANCELLED;case at.UNKNOWN:return V.UNKNOWN;case at.DEADLINE_EXCEEDED:return V.DEADLINE_EXCEEDED;case at.RESOURCE_EXHAUSTED:return V.RESOURCE_EXHAUSTED;case at.INTERNAL:return V.INTERNAL;case at.UNAVAILABLE:return V.UNAVAILABLE;case at.UNAUTHENTICATED:return V.UNAUTHENTICATED;case at.INVALID_ARGUMENT:return V.INVALID_ARGUMENT;case at.NOT_FOUND:return V.NOT_FOUND;case at.ALREADY_EXISTS:return V.ALREADY_EXISTS;case at.PERMISSION_DENIED:return V.PERMISSION_DENIED;case at.FAILED_PRECONDITION:return V.FAILED_PRECONDITION;case at.ABORTED:return V.ABORTED;case at.OUT_OF_RANGE:return V.OUT_OF_RANGE;case at.UNIMPLEMENTED:return V.UNIMPLEMENTED;case at.DATA_LOSS:return V.DATA_LOSS;default:return K()}}(we=at||(at={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";var DE=null;function Xb(){return new TextEncoder}var kx=new Oi([4294967295,4294967295],0);function ME(n){let e=Xb().encode(n),t=new wp;return t.update(e),new Uint8Array(t.digest())}function kE(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Oi([t,i],0),new Oi([r,s],0)]}var om=class n{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Ir(`Invalid padding: ${t}`);if(i<0)throw new Ir(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ir(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Ir(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Oi.fromNumber(this.Ie)}Ee(e,t,i){let r=e.add(t.multiply(Oi.fromNumber(i)));return r.compare(kx)===1&&(r=new Oi([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=ME(e),[i,r]=kE(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(e,t,i){let r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,r,t);return i.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;let t=ME(e),[i,r]=kE(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}},Ir=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ic=class n{constructor(e,t,i,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,i){let r=new Map;return r.set(e,rc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new n(ie.min(),r,new Ue(he),Gt(),fe())}},rc=class n{constructor(e,t,i,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new n(i,t,fe(),fe(),fe())}};var js=class{constructor(e,t,i,r){this.Re=e,this.removedTargetIds=t,this.key=i,this.Ve=r}},Cu=class{constructor(e,t){this.targetId=e,this.me=t}},Au=class{constructor(e,t,i=st.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}},Su=class{constructor(){this.fe=0,this.ge=NE(),this.pe=st.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=fe(),t=fe(),i=fe();return this.ge.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:K()}}),new rc(this.pe,this.ye,e,t,i)}Ce(){this.we=!1,this.ge=NE()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,J(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},am=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Gt(),this.qe=OE(),this.Qe=new Ue(he)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let i=this.Ge(t);switch(e.state){case 0:this.ze(t)&&i.De(e.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(e.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(i.Ne(),i.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),i.De(e.resumeToken));break;default:K()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((i,r)=>{this.ze(r)&&t(r)})}He(e){let t=e.targetId,i=e.me.count,r=this.Je(t);if(r){let s=r.target;if(bu(s))if(i===0){let o=new z(s.path);this.Ue(t,o,ut.newNoDocument(o,ie.min()))}else J(i===1);else{let o=this.Ye(t);if(o!==i){let c=this.Ze(e),l=c?this.Xe(c,e,o):1;if(l!==0){this.je(t);let u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}DE?.et(function(h,g,v,b,O){var M,x,B,H,F,G;let re={localCacheCount:h,existenceFilterCount:g.count,databaseId:v.database,projectId:v.projectId},ee=g.unchangedNames;return ee&&(re.bloomFilter={applied:O===0,hashCount:(M=ee?.hashCount)!==null&&M!==void 0?M:0,bitmapLength:(H=(B=(x=ee?.bits)===null||x===void 0?void 0:x.bitmap)===null||B===void 0?void 0:B.length)!==null&&H!==void 0?H:0,padding:(G=(F=ee?.bits)===null||F===void 0?void 0:F.padding)!==null&&G!==void 0?G:0,mightContain:C=>{var w;return(w=b?.mightContain(C))!==null&&w!==void 0&&w}}),re}(o,e.me,this.Le.tt(),c,l))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=t,o,c;try{o=$i(i).toUint8Array()}catch(l){if(l instanceof vu)return vn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new om(o,r,s)}catch(l){return vn(l instanceof Ir?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Ie===0?null:c}Xe(e,t,i){return t.me.count===i-this.nt(e,t.targetId)?0:2}nt(e,t){let i=this.Le.getRemoteKeysForTarget(t),r=0;return i.forEach(s=>{let o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),r++)}),r}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let c=this.Je(o);if(c){if(s.current&&bu(c.target)){let l=new z(c.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,ut.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let i=fe();this.qe.forEach((s,o)=>{let c=!0;o.forEachWhile(l=>{let u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let r=new ic(e,t,this.Qe,this.ke,i);return this.ke=Gt(),this.qe=OE(),this.Qe=new Ue(he),r}$e(e,t){if(!this.ze(e))return;let i=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,i),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,i){if(!this.ze(e))return;let r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),i&&(this.ke=this.ke.insert(t,i))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Su,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ne(he),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Su),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function OE(){return new Ue(z.comparator)}function NE(){return new Ue(z.comparator)}var Ox={asc:"ASCENDING",desc:"DESCENDING"},Nx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vx={and:"AND",or:"OR"},cm=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function lm(n,e){return n.useProto3Json||mc(e)?e:{value:e}}function Hs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Zb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Fx(n,e){return Hs(n,e.toTimestamp())}function rt(n){return J(!!n),ie.fromTimestamp(function(t){let i=ci(t);return new He(i.seconds,i.nanos)}(n))}function jg(n,e){return um(n,e).canonicalString()}function um(n,e){let t=function(r){return new Ee(["projects",r.projectId,"databases",r.database])}(n).child("documents");return e===void 0?t:t.child(e)}function eI(n){let e=Ee.fromString(n);return J(uI(e)),e}function sc(n,e){return jg(n.databaseId,e.path)}function Ln(n,e){let t=eI(e);if(t.get(1)!==n.databaseId.projectId)throw new L(V.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(V.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new z(iI(t))}function tI(n,e){return jg(n.databaseId,e)}function nI(n){let e=eI(n);return e.length===4?Ee.emptyPath():iI(e)}function dm(n){return new Ee(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function iI(n){return J(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function VE(n,e,t){return{name:sc(n,e),fields:t.value.mapValue.fields}}function rI(n,e,t){let i=Ln(n,e.name),r=rt(e.updateTime),s=e.createTime?rt(e.createTime):ie.min(),o=new Nt({mapValue:{fields:e.fields}}),c=ut.newFoundDocument(i,r,s,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function Lx(n,e){return"found"in e?function(i,r){J(!!r.found),r.found.name,r.found.updateTime;let s=Ln(i,r.found.name),o=rt(r.found.updateTime),c=r.found.createTime?rt(r.found.createTime):ie.min(),l=new Nt({mapValue:{fields:r.found.fields}});return ut.newFoundDocument(s,o,c,l)}(n,e):"missing"in e?function(i,r){J(!!r.missing),J(!!r.readTime);let s=Ln(i,r.missing),o=rt(r.readTime);return ut.newNoDocument(s,o)}(n,e):K()}function Ux(n,e){let t;if("targetChange"in e){e.targetChange;let i=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:K()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(J(h===void 0||typeof h=="string"),st.fromBase64String(h||"")):(J(h===void 0||h instanceof Buffer||h instanceof Uint8Array),st.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(u){let h=u.code===void 0?V.UNKNOWN:Yb(u.code);return new L(h,u.message||"")}(o);t=new Au(i,r,s,c||null)}else if("documentChange"in e){e.documentChange;let i=e.documentChange;i.document,i.document.name,i.document.updateTime;let r=Ln(n,i.document.name),s=rt(i.document.updateTime),o=i.document.createTime?rt(i.document.createTime):ie.min(),c=new Nt({mapValue:{fields:i.document.fields}}),l=ut.newFoundDocument(r,s,o,c),u=i.targetIds||[],h=i.removedTargetIds||[];t=new js(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;let i=e.documentDelete;i.document;let r=Ln(n,i.document),s=i.readTime?rt(i.readTime):ie.min(),o=ut.newNoDocument(r,s),c=i.removedTargetIds||[];t=new js([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let i=e.documentRemove;i.document;let r=Ln(n,i.document),s=i.removedTargetIds||[];t=new js([],s,r,null)}else{if(!("filter"in e))return K();{e.filter;let i=e.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new sm(r,s),c=i.targetId;t=new Cu(c,o)}}return t}function oc(n,e){let t;if(e instanceof Ki)t={update:VE(n,e.key,e.value)};else if(e instanceof Qi)t={delete:sc(n,e.key)};else if(e instanceof En)t={update:VE(n,e.key,e.data),updateMask:Wx(e.fieldMask)};else{if(!(e instanceof ec))return K();t={verify:sc(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,o){let c=o.transform;if(c instanceof Gi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof li)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ui)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Hi)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw K()}(0,i))),e.precondition.isNone||(t.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Fx(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K()}(n,e.precondition)),t}function hm(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?et.updateTime(rt(s.updateTime)):s.exists!==void 0?et.exists(s.exists):et.none()}(e.currentDocument):et.none(),i=e.updateTransforms?e.updateTransforms.map(r=>function(o,c){let l=null;if("setToServerValue"in c)J(c.setToServerValue==="REQUEST_TIME"),l=new Gi;else if("appendMissingElements"in c){let h=c.appendMissingElements.values||[];l=new li(h)}else if("removeAllFromArray"in c){let h=c.removeAllFromArray.values||[];l=new ui(h)}else"increment"in c?l=new Hi(o,c.increment):K();let u=it.fromServerFormat(c.fieldPath);return new Pr(u,l)}(n,r)):[];if(e.update){e.update.name;let r=Ln(n,e.update.name),s=new Nt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(l){let u=l.fieldPaths||[];return new nn(u.map(h=>it.fromServerFormat(h)))}(e.updateMask);return new En(r,s,o,t,i)}return new Ki(r,s,t,i)}if(e.delete){let r=Ln(n,e.delete);return new Qi(r,t)}if(e.verify){let r=Ln(n,e.verify);return new ec(r,t)}return K()}function jx(n,e){return n&&n.length>0?(J(e!==void 0),n.map(t=>function(r,s){let o=r.updateTime?rt(r.updateTime):rt(s);return o.isEqual(ie.min())&&(o=rt(s)),new im(o,r.transformResults||[])}(t,e))):[]}function sI(n,e){return{documents:[tI(n,e.path)]}}function oI(n,e){let t={structuredQuery:{}},i=e.path,r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=tI(n,r);let s=function(u){if(u.length!==0)return lI(xe.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(h=>function(v){return{field:Os(v.field),direction:qx(v.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=lm(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:r}}function aI(n){let e=nI(n.parent),t=n.structuredQuery,i=t.from?t.from.length:0,r=null;if(i>0){J(i===1);let h=t.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(g){let v=cI(g);return v instanceof xe&&Vg(v)?v.getFilters():[v]}(t.where));let o=[];t.orderBy&&(o=function(g){return g.map(v=>function(O){return new Sr(Ns(O.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(O.direction))}(v))}(t.orderBy));let c=null;t.limit&&(c=function(g){let v;return v=typeof g=="object"?g.value:g,mc(v)?null:v}(t.limit));let l=null;t.startAt&&(l=function(g){let v=!!g.before,b=g.values||[];return new Bn(b,v)}(t.startAt));let u=null;return t.endAt&&(u=function(g){let v=!g.before,b=g.values||[];return new Bn(b,v)}(t.endAt)),Nb(e,r,o,s,c,"F",l,u)}function Bx(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cI(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let i=Ns(t.unaryFilter.field);return _e.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=Ns(t.unaryFilter.field);return _e.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ns(t.unaryFilter.field);return _e.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ns(t.unaryFilter.field);return _e.create(o,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(n):n.fieldFilter!==void 0?function(t){return _e.create(Ns(t.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return xe.create(t.compositeFilter.filters.map(i=>cI(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return K()}}(t.compositeFilter.op))}(n):K()}function qx(n){return Ox[n]}function $x(n){return Nx[n]}function zx(n){return Vx[n]}function Os(n){return{fieldPath:n.canonicalString()}}function Ns(n){return it.fromServerFormat(n.fieldPath)}function lI(n){return n instanceof _e?function(t){if(t.op==="=="){if(vE(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NAN"}};if(yE(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(vE(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NOT_NAN"}};if(yE(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Os(t.field),op:$x(t.op),value:t.value}}}(n):n instanceof xe?function(t){let i=t.getFilters().map(r=>lI(r));return i.length===1?i[0]:{compositeFilter:{op:zx(t.op),filters:i}}}(n):K()}function Wx(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function uI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ks=class n{constructor(e,t,i,r,s=ie.min(),o=ie.min(),c=st.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ru=class{constructor(e){this.ct=e}};function Gx(n,e){let t;if(e.document)t=rI(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let i=z.fromSegments(e.noDocument.path),r=Dr(e.noDocument.readTime);t=ut.newNoDocument(i,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return K();{let i=z.fromSegments(e.unknownDocument.path),r=Dr(e.unknownDocument.version);t=ut.newUnknownDocument(i,r)}}return e.readTime&&t.setReadTime(function(r){let s=new He(r[0],r[1]);return ie.fromTimestamp(s)}(e.readTime)),t}function FE(n,e){let t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Pu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(s,o){return{name:sc(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Hs(s,o.version.toTimestamp()),createTime:Hs(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:xr(e.version)};else{if(!e.isUnknownDocument())return K();i.unknownDocument={path:t.path.toArray(),version:xr(e.version)}}return i}function Pu(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function xr(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Dr(n){let e=new He(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function wr(n,e){let t=(e.baseMutations||[]).map(s=>hm(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let i=e.mutations.map(s=>hm(n.ct,s)),r=He.fromMillis(e.localWriteTimeMs);return new tc(e.batchId,r,t,i)}function qa(n){let e=Dr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Dr(n.lastLimboFreeSnapshotVersion):ie.min(),i;return i=function(s){return s.documents!==void 0}(n.query)?function(s){return J(s.documents.length===1),jt(so(nI(s.documents[0])))}(n.query):function(s){return jt(aI(s))}(n.query),new Ks(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,st.fromBase64String(n.resumeToken))}function dI(n,e){let t=xr(e.snapshotVersion),i=xr(e.lastLimboFreeSnapshotVersion),r;r=bu(e.target)?sI(n.ct,e.target):oI(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Rr(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Bg(n){let e=aI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tu(e,e.limit,"L"):e}function Ap(n,e){return new nc(e.largestBatchId,hm(n.ct,e.overlayMutation))}function LE(n,e){let t=e.path.lastSegment();return[n,Ut(e.path.popLast()),t]}function UE(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:xr(i.readTime),documentKey:Ut(i.documentKey.path),largestBatchId:i.largestBatchId}}var fm=class{getBundleMetadata(e,t){return jE(e).get(t).next(i=>{if(i)return function(s){return{id:s.bundleId,createTime:Dr(s.createTime),version:s.version}}(i)})}saveBundleMetadata(e,t){return jE(e).put(function(r){return{bundleId:r.id,createTime:xr(rt(r.createTime)),version:r.version}}(t))}getNamedQuery(e,t){return BE(e).get(t).next(i=>{if(i)return function(s){return{name:s.name,query:Bg(s.bundledQuery),readTime:Dr(s.readTime)}}(i)})}saveNamedQuery(e,t){return BE(e).put(function(r){return{name:r.name,readTime:xr(rt(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function jE(n){return pt(n,"bundles")}function BE(n){return pt(n,"namedQueries")}var xu=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let i=t.uid||"";return new n(e,i)}getOverlay(e,t){return Fa(e).get(LE(this.userId,t)).next(i=>i?Ap(this.serializer,i):null)}getOverlays(e,t){let i=Vn();return k.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){let r=[];return i.forEach((s,o)=>{let c=new nc(t,o);r.push(this.ht(e,c))}),k.waitFor(r)}removeOverlaysForBatchId(e,t,i){let r=new Set;t.forEach(o=>r.add(Ut(o.getCollectionPath())));let s=[];return r.forEach(o=>{let c=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Fa(e).j("collectionPathOverlayIndex",c))}),k.waitFor(s)}getOverlaysForCollection(e,t,i){let r=Vn(),s=Ut(t),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Fa(e).U("collectionPathOverlayIndex",o).next(c=>{for(let l of c){let u=Ap(this.serializer,l);r.set(u.getKey(),u)}return r})}getOverlaysForCollectionGroup(e,t,i,r){let s=Vn(),o,c=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Fa(e).J({index:"collectionGroupOverlayIndex",range:c},(l,u,h)=>{let g=Ap(this.serializer,u);s.size()<r||g.largestBatchId===o?(s.set(g.getKey(),g),o=g.largestBatchId):h.done()}).next(()=>s)}ht(e,t){return Fa(e).put(function(r,s,o){let[c,l,u]=LE(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:oc(r.ct,o.mutation)}}(this.serializer,this.userId,t))}};function Fa(n){return pt(n,"documentOverlays")}var pm=class{Pt(e){return pt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let i=t?.value;return i?st.fromUint8Array(i):st.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var oi=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ze(e.integerValue));else if("doubleValue"in e){let i=ze(e.doubleValue);isNaN(i)?this.dt(t,13):(this.dt(t,15),Qa(i)?t.At(0):t.At(i))}else if("timestampValue"in e){let i=e.timestampValue;this.dt(t,20),typeof i=="string"&&(i=ci(i)),t.Rt(`${i.seconds||""}`),t.At(i.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt($i(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let i=e.geoPointValue;this.dt(t,45),t.At(i.latitude||0),t.At(i.longitude||0)}else"mapValue"in e?Sb(e)?this.dt(t,Number.MAX_SAFE_INTEGER):dd(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):K()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let i=e.fields||{};this.dt(t,55);for(let r of Object.keys(i))this.Vt(r,t),this.Tt(i[r],t)}wt(e,t){var i,r;let s=e.fields||{};this.dt(t,53);let o="value",c=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(t,15),t.At(ze(c)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let i=e.values||[];this.dt(t,50);for(let r of i)this.Tt(r,t)}yt(e,t){this.dt(t,37),z.fromName(e).path.forEach(i=>{this.dt(t,60),this.Dt(i,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};oi.vt=new oi;function Hx(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function qE(n){let e=64-function(i){let r=0;for(let s=0;s<8;++s){let o=Hx(255&i[s]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(e/8)}var mm=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.Ft(i.value),i=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),i=t.next();for(;!i.done;)this.Ot(i.value),i=t.next();this.Nt()}Lt(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{let r=t.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Bt(e){for(let t of e){let i=t.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{let r=t.codePointAt(0);this.Ot(240|r>>>18),this.Ot(128|63&r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r)}}this.Nt()}kt(e){let t=this.qt(e),i=qE(t);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){let t=this.qt(e),i=qE(t);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let r=t.length-i;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),i=(128&t[0])!=0;t[0]^=i?255:128;for(let r=1;r<t.length;++r)t[r]^=i?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},gm=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},_m=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Er=class{constructor(){this.jt=new mm,this.Ht=new gm(this.jt),this.Jt=new _m(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var br=class n{constructor(e,t,i,r){this.indexId=e,this.documentKey=t,this.arrayValue=i,this.directionalValue=r}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.directionalValue,0),t!==e?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function Ni(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=$E(n.arrayValue,e.arrayValue),t!==0?t:(t=$E(n.directionalValue,e.directionalValue),t!==0?t:z.comparator(n.documentKey,e.documentKey)))}function $E(n,e){for(let t=0;t<n.length&&t<e.length;++t){let i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}var Du=class{constructor(e){this.Xt=new Ne((t,i)=>it.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let i=t;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(e){if(J(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Lp(e);if(t!==void 0&&!this.sn(t))return!1;let i=yr(e),r=new Set,s=0,o=0;for(;s<i.length&&this.sn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Xt.size>0){let c=this.Xt.getIterator().getNext();if(!r.has(c.field.canonicalString())){let l=i[s];if(!this.on(c,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<i.length;++s){let c=i[s];if(o>=this.en.length||!this._n(this.en[o++],c))return!1}return!0}an(){if(this.nn)return null;let e=new Ne(it.comparator),t=[];for(let i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Ls(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Ls(i.field,0))}for(let i of this.en)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Ls(i.field,i.dir==="asc"?0:1)));return new qs(qs.UNKNOWN_ID,this.collectionId,t,Ka.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function hI(n){var e,t;if(J(n instanceof _e||n instanceof xe),n instanceof _e){if(n instanceof Eu){let r=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>_e.create(n.field,"==",s)))||[];return xe.create(r,"or")}return n}let i=n.filters.map(r=>hI(r));return xe.create(i,n.op)}function Kx(n){if(n.getFilters().length===0)return[];let e=wm(hI(n));return J(fI(e)),ym(e)||vm(e)?[e]:e.getFilters()}function ym(n){return n instanceof _e}function vm(n){return n instanceof xe&&Vg(n)}function fI(n){return ym(n)||vm(n)||function(t){if(t instanceof xe&&Gp(t)){for(let i of t.getFilters())if(!ym(i)&&!vm(i))return!1;return!0}return!1}(n)}function wm(n){if(J(n instanceof _e||n instanceof xe),n instanceof _e)return n;if(n.filters.length===1)return wm(n.filters[0]);let e=n.filters.map(i=>wm(i)),t=xe.create(e,n.op);return t=Mu(t),fI(t)?t:(J(t instanceof xe),J(zs(t)),J(t.filters.length>1),t.filters.reduce((i,r)=>qg(i,r)))}function qg(n,e){let t;return J(n instanceof _e||n instanceof xe),J(e instanceof _e||e instanceof xe),t=n instanceof _e?e instanceof _e?function(r,s){return xe.create([r,s],"and")}(n,e):zE(n,e):e instanceof _e?zE(e,n):function(r,s){if(J(r.filters.length>0&&s.filters.length>0),zs(r)&&zs(s))return Mb(r,s.getFilters());let o=Gp(r)?r:s,c=Gp(r)?s:r,l=o.filters.map(u=>qg(u,c));return xe.create(l,"or")}(n,e),Mu(t)}function zE(n,e){if(zs(e))return Mb(e,n.getFilters());{let t=e.filters.map(i=>qg(n,i));return xe.create(t,"or")}}function Mu(n){if(J(n instanceof _e||n instanceof xe),n instanceof _e)return n;let e=n.getFilters();if(e.length===1)return Mu(e[0]);if(xb(n))return n;let t=e.map(r=>Mu(r)),i=[];return t.forEach(r=>{r instanceof _e?i.push(r):r instanceof xe&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:xe.create(i,n.op)}var Em=class{constructor(){this.un=new ac}addToCollectionParentIndex(e,t){return this.un.add(t),k.resolve()}getCollectionParents(e,t){return k.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return k.resolve()}deleteFieldIndex(e,t){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,t){return k.resolve()}getDocumentsMatchingTarget(e,t){return k.resolve(null)}getIndexType(e,t){return k.resolve(0)}getFieldIndexes(e,t){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,t){return k.resolve(dn.min())}getMinOffsetFromCollectionGroup(e,t){return k.resolve(dn.min())}updateCollectionGroup(e,t,i){return k.resolve()}updateIndexEntries(e,t){return k.resolve()}},ac=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new Ne(Ee.comparator),s=!r.has(i);return this.index[t]=r.add(i),s}has(e){let t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new Ne(Ee.comparator)).toArray()}};var ru=new Uint8Array(0),bm=class{constructor(e,t){this.databaseId=t,this.cn=new ac,this.ln=new qn(i=>Rr(i),(i,r)=>gc(i,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let i=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:i,parent:Ut(r)};return WE(e).put(s)}return k.resolve()}getCollectionParents(e,t){let i=[],r=IDBKeyRange.bound([t,""],[mb(t),""],!1,!0);return WE(e).U(r).next(s=>{for(let o of s){if(o.collectionId!==t)break;i.push(Nn(o.parent))}return i})}addFieldIndex(e,t){let i=La(e),r=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete r.indexId;let s=i.add(r);if(t.indexState){let o=xs(e);return s.next(c=>{o.put(UE(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let i=La(e),r=xs(e),s=Ps(e);return i.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=La(e),i=Ps(e),r=xs(e);return t.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(e,t){return k.forEach(this.hn(t),i=>this.getIndexType(e,i).next(r=>{if(r===0||r===1){let s=new Du(i).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let i=Ps(e),r=!0,s=new Map;return k.forEach(this.hn(t),o=>this.Pn(e,o).next(c=>{r&&(r=!!c),s.set(o,c)})).next(()=>{if(r){let o=fe(),c=[];return k.forEach(s,(l,u)=>{U("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`}(l)} to execute ${Rr(t)}`);let h=function(F,G){let re=Lp(G);if(re===void 0)return null;for(let ee of Iu(F,re.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null}(u,l),g=function(F,G){let re=new Map;for(let ee of yr(G))for(let C of Iu(F,ee.fieldPath))switch(C.op){case"==":case"in":re.set(ee.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return re.set(ee.fieldPath.canonicalString(),C.value),Array.from(re.values())}return null}(u,l),v=function(F,G){let re=[],ee=!0;for(let C of yr(G)){let w=C.kind===0?TE(F,C.fieldPath,F.startAt):CE(F,C.fieldPath,F.startAt);re.push(w.value),ee&&(ee=w.inclusive)}return new Bn(re,ee)}(u,l),b=function(F,G){let re=[],ee=!0;for(let C of yr(G)){let w=C.kind===0?CE(F,C.fieldPath,F.endAt):TE(F,C.fieldPath,F.endAt);re.push(w.value),ee&&(ee=w.inclusive)}return new Bn(re,ee)}(u,l),O=this.In(l,u,v),M=this.In(l,u,b),x=this.Tn(l,u,g),B=this.En(l.indexId,h,O,v.inclusive,M,b.inclusive,x);return k.forEach(B,H=>i.G(H,t.limit).next(F=>{F.forEach(G=>{let re=z.fromSegments(G.documentKey);o.has(re)||(o=o.add(re),c.push(re))})}))}).next(()=>c)}return k.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=Kx(xe.create(e.filters,"and")).map(i=>tm(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,i,r,s,o,c){let l=(t!=null?t.length:1)*Math.max(i.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let g=0;g<l;++g){let v=t?this.dn(t[g/u]):ru,b=this.An(e,v,i[g%u],r),O=this.Rn(e,v,s[g%u],o),M=c.map(x=>this.An(e,v,x,!0));h.push(...this.createRange(b,O,M))}return h}An(e,t,i,r){let s=new br(e,z.empty(),t,i);return r?s:s.Zt()}Rn(e,t,i,r){let s=new br(e,z.empty(),t,i);return r?s.Zt():s}Pn(e,t){let i=new Du(t),r=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let o=null;for(let c of s)i.rn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o})}getIndexType(e,t){let i=2,r=this.hn(t);return k.forEach(r,s=>this.Pn(e,s).next(o=>{o?i!==0&&o.fields.length<function(l){let u=new Ne(it.comparator),h=!1;for(let g of l.filters)for(let v of g.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?h=!0:u=u.add(v.field));for(let g of l.orderBy)g.field.isKeyField()||(u=u.add(g.field));return u.size+(h?1:0)}(s)&&(i=1):i=0})).next(()=>function(o){return o.limit!==null}(t)&&r.length>1&&i===2?1:i)}Vn(e,t){let i=new Er;for(let r of yr(e)){let s=t.data.field(r.fieldPath);if(s==null)return null;let o=i.Yt(r.kind);oi.vt.It(s,o)}return i.zt()}dn(e){let t=new Er;return oi.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let i=new Er;return oi.vt.It(Ar(this.databaseId,t),i.Yt(function(s){let o=yr(s);return o.length===0?0:o[o.length-1].kind}(e))),i.zt()}Tn(e,t,i){if(i===null)return[];let r=[];r.push(new Er);let s=0;for(let o of yr(e)){let c=i[s++];for(let l of r)if(this.fn(t,o.fieldPath)&&Za(c))r=this.gn(r,o,c);else{let u=l.Yt(o.kind);oi.vt.It(c,u)}}return this.pn(r)}In(e,t,i){return this.Tn(e,t,i.position)}pn(e){let t=[];for(let i=0;i<e.length;++i)t[i]=e[i].zt();return t}gn(e,t,i){let r=[...e],s=[];for(let o of i.arrayValue.values||[])for(let c of r){let l=new Er;l.seed(c.zt()),oi.vt.It(o,l.Yt(t.kind)),s.push(l)}return s}fn(e,t){return!!e.filters.find(i=>i instanceof _e&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){let i=La(e),r=xs(e);return(t?i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):i.U()).next(s=>{let o=[];return k.forEach(s,c=>r.get([c.indexId,this.uid]).next(l=>{o.push(function(h,g){let v=g?new Ka(g.sequenceNumber,new dn(Dr(g.readTime),new z(Nn(g.documentKey)),g.largestBatchId)):Ka.empty(),b=h.fields.map(([O,M])=>new Ls(it.fromServerFormat(O),M));return new qs(h.indexId,h.collectionGroup,b,v)}(c,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,r)=>{let s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:he(i.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){let r=La(e),s=xs(e);return this.yn(e).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(c=>k.forEach(c,l=>s.put(UE(l.indexId,this.uid,o,i)))))}updateIndexEntries(e,t){let i=new Map;return k.forEach(t,(r,s)=>{let o=i.get(r.collectionGroup);return(o?k.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(i.set(r.collectionGroup,c),k.forEach(c,l=>this.wn(e,r,l).next(u=>{let h=this.Sn(s,l);return u.isEqual(h)?k.resolve():this.bn(e,s,l,u,h)}))))})}Dn(e,t,i,r){return Ps(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(i,t.key),documentKey:t.key.path.toArray()})}vn(e,t,i,r){return Ps(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(i,t.key),t.key.path.toArray()])}wn(e,t,i){let r=Ps(e),s=new Ne(Ni);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,t)])},(o,c)=>{s=s.add(new br(i.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>s)}Sn(e,t){let i=new Ne(Ni),r=this.Vn(t,e);if(r==null)return i;let s=Lp(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Za(o))for(let c of o.arrayValue.values||[])i=i.add(new br(t.indexId,e.key,this.dn(c),r))}else i=i.add(new br(t.indexId,e.key,ru,r));return i}bn(e,t,i,r,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(l,u,h,g,v){let b=l.getIterator(),O=u.getIterator(),M=Rs(b),x=Rs(O);for(;M||x;){let B=!1,H=!1;if(M&&x){let F=h(M,x);F<0?H=!0:F>0&&(B=!0)}else M!=null?H=!0:B=!0;B?(g(x),x=Rs(O)):H?(v(M),M=Rs(b)):(M=Rs(b),x=Rs(O))}}(r,s,Ni,c=>{o.push(this.Dn(e,t,i,c))},c=>{o.push(this.vn(e,t,i,c))}),k.waitFor(o)}yn(e){let t=1;return xs(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((o,c)=>Ni(o,c)).filter((o,c,l)=>!c||Ni(o,l[c-1])!==0);let r=[];r.push(e);for(let o of i){let c=Ni(o,e),l=Ni(o,t);if(c===0)r[0]=e.Zt();else if(c>0&&l<0)r.push(o),r.push(o.Zt());else if(l>0)break}r.push(t);let s=[];for(let o=0;o<r.length;o+=2){if(this.Cn(r[o],r[o+1]))return[];let c=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,ru,[]],l=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,ru,[]];s.push(IDBKeyRange.bound(c,l))}return s}Cn(e,t){return Ni(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(GE)}getMinOffset(e,t){return k.mapArray(this.hn(t),i=>this.Pn(e,i).next(r=>r||K())).next(GE)}};function WE(n){return pt(n,"collectionParents")}function Ps(n){return pt(n,"indexEntries")}function La(n){return pt(n,"indexConfiguration")}function xs(n){return pt(n,"indexState")}function GE(n){J(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;Mg(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new dn(e.readTime,e.documentKey,t)}var HE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},un=class n{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function pI(n,e,t){let i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),c=0,l=i.J({range:o},(h,g,v)=>(c++,v.delete()));s.push(l.next(()=>{J(c===1)}));let u=[];for(let h of t.mutations){let g=Eb(e,h.key.path,t.batchId);s.push(r.delete(g)),u.push(h.key)}return k.waitFor(s).next(()=>u)}function ku(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw K();e=n.noDocument}return JSON.stringify(e).length}un.DEFAULT_COLLECTION_PERCENTILE=10,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,un.DEFAULT=new un(41943040,un.DEFAULT_COLLECTION_PERCENTILE,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),un.DISABLED=new un(-1,0,0);var Ou=class n{constructor(e,t,i,r){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=r,this.Fn={}}static lt(e,t,i,r){J(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,i,r)}checkEmpty(e){let t=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).J({index:"userMutationsIndex",range:i},(r,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,r){let s=Vs(e),o=Vi(e);return o.add({}).next(c=>{J(typeof c=="number");let l=new tc(c,t,i,r),u=function(b,O,M){let x=M.baseMutations.map(H=>oc(b.ct,H)),B=M.mutations.map(H=>oc(b.ct,H));return{userId:O,batchId:M.batchId,localWriteTimeMs:M.localWriteTime.toMillis(),baseMutations:x,mutations:B}}(this.serializer,this.userId,l),h=[],g=new Ne((v,b)=>he(v.canonicalString(),b.canonicalString()));for(let v of r){let b=Eb(this.userId,v.key.path,c);g=g.add(v.key.path.popLast()),h.push(o.put(u)),h.push(s.put(b,ex))}return g.forEach(v=>{h.push(this.indexManager.addToCollectionParentIndex(e,v))}),e.addOnCommittedListener(()=>{this.Fn[c]=l.keys()}),k.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return Vi(e).get(t).next(i=>i?(J(i.userId===this.userId),wr(this.serializer,i)):null)}Mn(e,t){return this.Fn[t]?k.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){let r=i.keys();return this.Fn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return Vi(e).J({index:"userMutationsIndex",range:r},(o,c,l)=>{c.userId===this.userId&&(J(c.batchId>=i),s=wr(this.serializer,c)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=-1;return Vi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vi(e).U("userMutationsIndex",t).next(i=>i.map(r=>wr(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){let i=cu(this.userId,t.path),r=IDBKeyRange.lowerBound(i),s=[];return Vs(e).J({range:r},(o,c,l)=>{let[u,h,g]=o,v=Nn(h);if(u===this.userId&&t.path.isEqual(v))return Vi(e).get(g).next(b=>{if(!b)throw K();J(b.userId===this.userId),s.push(wr(this.serializer,b))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ne(he),r=[];return t.forEach(s=>{let o=cu(this.userId,s.path),c=IDBKeyRange.lowerBound(o),l=Vs(e).J({range:c},(u,h,g)=>{let[v,b,O]=u,M=Nn(b);v===this.userId&&s.path.isEqual(M)?i=i.add(O):g.done()});r.push(l)}),k.waitFor(r).next(()=>this.xn(e,i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=cu(this.userId,i),o=IDBKeyRange.lowerBound(s),c=new Ne(he);return Vs(e).J({range:o},(l,u,h)=>{let[g,v,b]=l,O=Nn(v);g===this.userId&&i.isPrefixOf(O)?O.length===r&&(c=c.add(b)):h.done()}).next(()=>this.xn(e,c))}xn(e,t){let i=[],r=[];return t.forEach(s=>{r.push(Vi(e).get(s).next(o=>{if(o===null)throw K();J(o.userId===this.userId),i.push(wr(this.serializer,o))}))}),k.waitFor(r).next(()=>i)}removeMutationBatch(e,t){return pI(e._e,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),k.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return k.resolve();let i=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return Vs(e).J({range:i},(s,o,c)=>{if(s[0]===this.userId){let l=Nn(s[1]);r.push(l)}else c.done()}).next(()=>{J(r.length===0)})})}containsKey(e,t){return mI(e,this.userId,t)}Nn(e){return gI(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function mI(n,e,t){let i=cu(e,t.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return Vs(n).J({range:s,H:!0},(c,l,u)=>{let[h,g,v]=c;h===e&&g===r&&(o=!0),u.done()}).next(()=>o)}function Vi(n){return pt(n,"mutations")}function Vs(n){return pt(n,"documentMutations")}function gI(n){return pt(n,"mutationQueues")}var Qs=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Im=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let i=new Qs(t.highestTargetId);return t.highestTargetId=i.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ie.fromTimestamp(new He(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.qn(e).next(r=>(r.highestListenSequenceNumber=t,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(i=>(i.targetCount+=1,this.$n(t,i),this.Qn(e,i))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Ds(e).delete(t.targetId)).next(()=>this.qn(e)).next(i=>(J(i.targetCount>0),i.targetCount-=1,this.Qn(e,i)))}removeTargets(e,t,i){let r=0,s=[];return Ds(e).J((o,c)=>{let l=qa(c);l.sequenceNumber<=t&&i.get(l.targetId)===null&&(r++,s.push(this.removeTargetData(e,l)))}).next(()=>k.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Ds(e).J((i,r)=>{let s=qa(r);t(s)})}qn(e){return KE(e).get("targetGlobalKey").next(t=>(J(t!==null),t))}Qn(e,t){return KE(e).put("targetGlobalKey",t)}Kn(e,t){return Ds(e).put(dI(this.serializer,t))}$n(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let i=Rr(t),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),s=null;return Ds(e).J({range:r,index:"queryTargetsIndex"},(o,c,l)=>{let u=qa(c);gc(t,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,t,i){let r=[],s=Fi(e);return t.forEach(o=>{let c=Ut(o.path);r.push(s.put({targetId:i,path:c})),r.push(this.referenceDelegate.addReference(e,i,o))}),k.waitFor(r)}removeMatchingKeys(e,t,i){let r=Fi(e);return k.forEach(t,s=>{let o=Ut(s.path);return k.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(e,i,s)])})}removeMatchingKeysForTargetId(e,t){let i=Fi(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(e,t){let i=IDBKeyRange.bound([t],[t+1],!1,!0),r=Fi(e),s=fe();return r.J({range:i,H:!0},(o,c,l)=>{let u=Nn(o[1]),h=new z(u);s=s.add(h)}).next(()=>s)}containsKey(e,t){let i=Ut(t.path),r=IDBKeyRange.bound([i],[mb(i)],!1,!0),s=0;return Fi(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,c],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return Ds(e).get(t).next(i=>i?qa(i):null)}};function Ds(n){return pt(n,"targets")}function KE(n){return pt(n,"targetGlobal")}function Fi(n){return pt(n,"targetDocuments")}function QE([n,e],[t,i]){let r=he(n,t);return r===0?he(e,i):r}var Tm=class{constructor(e){this.Un=e,this.buffer=new Ne(QE),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let i=this.buffer.last();QE(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}},Cm=class{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>E(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Xi(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield Yi(t)}yield this.Hn(3e5)}))}},Am=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return k.resolve(tn.oe);let i=new Tm(t);return this.Jn.forEachTarget(e,r=>i.zn(r.sequenceNumber)).next(()=>this.Jn.Zn(e,r=>i.zn(r))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.Jn.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(HE)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),HE):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let i,r,s,o,c,l,u,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),r=this.params.maximumSequenceNumbersToCollect):r=g,o=Date.now(),this.nthSequenceNumber(e,r))).next(g=>(i=g,c=Date.now(),this.removeTargets(e,i,t))).next(g=>(s=g,l=Date.now(),this.removeOrphanedDocuments(e,i))).next(g=>(u=Date.now(),Ms()<=Rn.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(c-o)+`ms
	Removed ${s} targets in `+(l-c)+`ms
	Removed ${g} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:g})))}};function Qx(n,e){return new Am(n,e)}var Sm=class{constructor(e,t){this.db=e,this.garbageCollector=Qx(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(r=>i+r))}er(e){let t=0;return this.Zn(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(i,r)=>t(r))}addReference(e,t,i){return su(e,i)}removeReference(e,t,i){return su(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return su(e,t)}nr(e,t){return function(r,s){let o=!1;return gI(r).Y(c=>mI(r,c,s).next(l=>(l&&(o=!0),k.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],s=0;return this.tr(e,(o,c)=>{if(c<=t){let l=this.nr(e,o).next(u=>{if(!u)return s++,i.getEntry(e,o).next(()=>(i.removeEntry(o,ie.min()),Fi(e).delete(function(g){return[0,Ut(g.path)]}(o))))});r.push(l)}}).next(()=>k.waitFor(r)).next(()=>i.apply(e)).next(()=>s)}removeTarget(e,t){let i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return su(e,t)}tr(e,t){let i=Fi(e),r,s=tn.oe;return i.J({index:"documentTargetsIndex"},([o,c],{path:l,sequenceNumber:u})=>{o===0?(s!==tn.oe&&t(new z(Nn(r)),s),s=u,r=l):s=tn.oe}).next(()=>{s!==tn.oe&&t(new z(Nn(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function su(n,e){return Fi(n).put(function(i,r){return{targetId:0,path:Ut(i.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}var Nu=class{constructor(){this.changes=new qn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ut.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let i=this.changes.get(t);return i!==void 0?k.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Rm=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return _r(e).put(i)}removeEntry(e,t,i){return _r(e).delete(function(s,o){let c=s.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Pu(o),c[c.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.rr(e,i)))}getEntry(e,t){let i=ut.newInvalidDocument(t);return _r(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ua(t))},(r,s)=>{i=this.ir(t,s)}).next(()=>i)}sr(e,t){let i={size:0,document:ut.newInvalidDocument(t)};return _r(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ua(t))},(r,s)=>{i={document:this.ir(t,s),size:ku(s)}}).next(()=>i)}getEntries(e,t){let i=Gt();return this._r(e,t,(r,s)=>{let o=this.ir(r,s);i=i.insert(r,o)}).next(()=>i)}ar(e,t){let i=Gt(),r=new Ue(z.comparator);return this._r(e,t,(s,o)=>{let c=this.ir(s,o);i=i.insert(s,c),r=r.insert(s,ku(o))}).next(()=>({documents:i,ur:r}))}_r(e,t,i){if(t.isEmpty())return k.resolve();let r=new Ne(XE);t.forEach(l=>r=r.add(l));let s=IDBKeyRange.bound(Ua(r.first()),Ua(r.last())),o=r.getIterator(),c=o.getNext();return _r(e).J({index:"documentKeyIndex",range:s},(l,u,h)=>{let g=z.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;c&&XE(c,g)<0;)i(c,null),c=o.getNext();c&&c.isEqual(g)&&(i(c,u),c=o.hasNext()?o.getNext():null),c?h.$(Ua(c)):h.done()}).next(()=>{for(;c;)i(c,null),c=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,i,r,s){let o=t.path,c=[o.popLast().toArray(),o.lastSegment(),Pu(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _r(e).U(IDBKeyRange.bound(c,l,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let h=Gt();for(let g of u){let v=this.ir(z.fromSegments(g.prefixPath.concat(g.collectionGroup,g.documentId)),g);v.isFoundDocument()&&(yc(t,v)||r.has(v.key))&&(h=h.insert(v.key,v))}return h})}getAllFromCollectionGroup(e,t,i,r){let s=Gt(),o=YE(t,i),c=YE(t,dn.max());return _r(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,c,!0)},(l,u,h)=>{let g=this.ir(z.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(g.key,g),s.size===r&&h.done()}).next(()=>s)}newChangeBuffer(e){return new Pm(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return JE(e).get("remoteDocumentGlobalKey").next(t=>(J(!!t),t))}rr(e,t){return JE(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let i=Gx(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(ie.min())))return i}return ut.newInvalidDocument(e)}};function _I(n){return new Rm(n)}var Pm=class extends Nu{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new qn(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(e){let t=[],i=0,r=new Ne((s,o)=>he(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let c=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,c.readTime)),o.isValidDocument()){let l=FE(this.cr.serializer,o);r=r.add(s.path.popLast());let u=ku(l);i+=u-c.size,t.push(this.cr.addEntry(e,s,l))}else if(i-=c.size,this.trackRemovals){let l=FE(this.cr.serializer,o.convertToNoDocument(ie.min()));t.push(this.cr.addEntry(e,s,l))}}),r.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,i)),k.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(i=>(this.lr.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:i,ur:r})=>(r.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:i.get(s).readTime})}),i))}};function JE(n){return pt(n,"remoteDocumentGlobal")}function _r(n){return pt(n,"remoteDocumentsV14")}function Ua(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function YE(n,e){let t=e.documentKey.path.toArray();return[n,Pu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function XE(n,e){let t=n.path.toArray(),i=e.path.toArray(),r=0;for(let s=0;s<t.length-2&&s<i.length-2;++s)if(r=he(t[s],i[s]),r)return r;return r=he(t.length,i.length),r||(r=he(t[t.length-2],i[i.length-2]),r||he(t[t.length-1],i[i.length-1]))}var xm=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Vu=class{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(i=r,this.remoteDocumentCache.getEntry(e,t))).next(r=>(i!==null&&Wa(i.mutation,r,nn.empty(),He.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,fe()).next(()=>i))}getLocalViewOfDocuments(e,t,i=fe()){let r=Vn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,i).next(s=>{let o=Ba();return s.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let i=Vn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,fe()))}populateOverlays(e,t,i){let r=[];return i.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,i,r){let s=Gt(),o=za(),c=function(){return za()}();return t.forEach((l,u)=>{let h=i.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof En)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Wa(h.mutation,u,h.mutation.getFieldMask(),He.now())):o.set(u.key,nn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var g;return c.set(u,new xm(h,(g=o.get(u))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,t){let i=za(),r=new Ue((o,c)=>o-c),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let c of o)c.keys().forEach(l=>{let u=t.get(l);if(u===null)return;let h=i.get(l)||nn.empty();h=c.applyToLocalView(u,h),i.set(l,h);let g=(r.get(c.batchId)||fe()).add(l);r=r.insert(c.batchId,g)})}).next(()=>{let o=[],c=r.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),u=l.key,h=l.value,g=Bb();h.forEach(v=>{if(!s.has(v)){let b=Kb(t.get(v),i.get(v));b!==null&&g.set(v,b),s=s.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,g))}return k.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,r){return function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-s.size):k.resolve(Vn()),c=-1,l=s;return o.next(u=>k.forEach(u,(h,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),s.get(h)?k.resolve():this.remoteDocumentCache.getEntry(e,h).next(v=>{l=l.insert(h,v)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,fe())).next(h=>({batchId:c,changes:jb(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new z(t)).next(i=>{let r=Ba();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){let s=t.collectionGroup,o=Ba();return this.indexManager.getCollectionParents(e,s).next(c=>k.forEach(c,l=>{let u=function(g,v){return new wn(v,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,i,r).next(h=>{h.forEach((g,v)=>{o=o.insert(g,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,s,r))).next(o=>{s.forEach((l,u)=>{let h=u.getKey();o.get(h)===null&&(o=o.insert(h,ut.newInvalidDocument(h)))});let c=Ba();return o.forEach((l,u)=>{let h=s.get(l);h!==void 0&&Wa(h.mutation,u,nn.empty(),He.now()),yc(t,u)&&(c=c.insert(l,u))}),c})}};var Dm=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return k.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(r){return{id:r.id,version:r.version,createTime:rt(r.createTime)}}(t)),k.resolve()}getNamedQuery(e,t){return k.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(r){return{name:r.name,query:Bg(r.bundledQuery),readTime:rt(r.readTime)}}(t)),k.resolve()}};var Mm=class{constructor(){this.overlays=new Ue(z.comparator),this.Ir=new Map}getOverlay(e,t){return k.resolve(this.overlays.get(t))}getOverlays(e,t){let i=Vn();return k.forEach(t,r=>this.getOverlay(e,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((r,s)=>{this.ht(e,t,s)}),k.resolve()}removeOverlaysForBatchId(e,t,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),k.resolve()}getOverlaysForCollection(e,t,i){let r=Vn(),s=t.length+1,o=new z(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let l=c.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>i&&r.set(l.getKey(),l)}return k.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let s=new Ue((u,h)=>u-h),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let h=s.get(u.largestBatchId);h===null&&(h=Vn(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}let c=Vn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>c.set(u,h)),!(c.size()>=r)););return k.resolve(c)}ht(e,t,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new nc(t,i));let s=this.Ir.get(t);s===void 0&&(s=fe(),this.Ir.set(t,s)),this.Ir.set(t,s.add(i.key))}};var km=class{constructor(){this.sessionToken=st.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,k.resolve()}};var cc=class{constructor(){this.Tr=new Ne(ct.Er),this.dr=new Ne(ct.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let i=new ct(e,t);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.Vr(new ct(e,t))}mr(e,t){e.forEach(i=>this.removeReference(i,t))}gr(e){let t=new z(new Ee([])),i=new ct(t,e),r=new ct(t,e+1),s=[];return this.dr.forEachInRange([i,r],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new z(new Ee([])),i=new ct(t,e),r=new ct(t,e+1),s=fe();return this.dr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new ct(e,0),i=this.Tr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}},ct=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return z.comparator(e.key,t.key)||he(e.wr,t.wr)}static Ar(e,t){return he(e.wr,t.wr)||z.comparator(e.key,t.key)}};var Om=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ne(ct.Er)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new tc(s,t,i,r);this.mutationQueue.push(o);for(let c of r)this.br=this.br.add(new ct(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,t){return k.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let i=t+1,r=this.vr(i),s=r<0?0:r;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let i=new ct(t,0),r=new ct(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],o=>{let c=this.Dr(o.wr);s.push(c)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new Ne(he);return t.forEach(r=>{let s=new ct(r,0),o=new ct(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],c=>{i=i.add(c.wr)})}),k.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(e,t){let i=t.path,r=i.length+1,s=i;z.isDocumentKey(s)||(s=s.child(""));let o=new ct(new z(s),0),c=new Ne(he);return this.br.forEachWhile(l=>{let u=l.key.path;return!!i.isPrefixOf(u)&&(u.length===r&&(c=c.add(l.wr)),!0)},o),k.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(i=>{let r=this.Dr(i);r!==null&&t.push(r)}),t}removeMutationBatch(e,t){J(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return k.forEach(t.mutations,r=>{let s=new ct(r.key,t.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=i})}On(e){}containsKey(e,t){let i=new ct(t,0),r=this.br.firstAfterOrEqual(i);return k.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Nm=class{constructor(e){this.Mr=e,this.docs=function(){return new Ue(z.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let i=t.key,r=this.docs.get(i),s=r?r.size:0,o=this.Mr(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let i=this.docs.get(t);return k.resolve(i?i.document.mutableCopy():ut.newInvalidDocument(t))}getEntries(e,t){let i=Gt();return t.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():ut.newInvalidDocument(r))}),k.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let s=Gt(),o=t.path,c=new z(o.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Mg(_b(h),i)<=0||(r.has(h.key)||yc(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return k.resolve(s)}getAllFromCollectionGroup(e,t,i,r){K()}Or(e,t){return k.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Vm(this)}getSize(e){return k.resolve(this.size)}},Vm=class extends Nu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(i)}),k.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Fm=class{constructor(e){this.persistence=e,this.Nr=new qn(t=>Rr(t),gc),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cc,this.targetCount=0,this.kr=Qs.Bn()}forEachTarget(e,t){return this.Nr.forEach((i,r)=>t(r)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Lr&&(this.Lr=t),k.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Qs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,k.resolve()}updateTargetData(e,t){return this.Kn(t),k.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,t,i){let r=0,s=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=t&&i.get(c.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),k.waitFor(s).next(()=>r)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,t){let i=this.Nr.get(t)||null;return k.resolve(i)}addMatchingKeys(e,t,i){return this.Br.Rr(t,i),k.resolve()}removeMatchingKeys(e,t,i){this.Br.mr(t,i);let r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(o=>{s.push(r.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),k.resolve()}getMatchingKeysForTargetId(e,t){let i=this.Br.yr(t);return k.resolve(i)}containsKey(e,t){return k.resolve(this.Br.containsKey(t))}};var Fu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new tn(0),this.Kr=!1,this.Kr=!0,this.$r=new km,this.referenceDelegate=e(this),this.Ur=new Fm(this),this.indexManager=new Em,this.remoteDocumentCache=function(r){return new Nm(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new Ru(t),this.Gr=new Dm(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Mm,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.qr[e.toKey()];return i||(i=new Om(t,this.referenceDelegate),this.qr[e.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,i){U("MemoryPersistence","Starting transaction:",e);let r=new Lm(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(e,t){return k.or(Object.values(this.qr).map(i=>()=>i.containsKey(e,t)))}},Lm=class extends gu{constructor(e){super(),this.currentSequenceNumber=e}},Lu=class n{constructor(e){this.persistence=e,this.Jr=new cc,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw K()}addReference(e,t,i){return this.Jr.addReference(i,t),this.Xr.delete(i.toString()),k.resolve()}removeReference(e,t,i){return this.Jr.removeReference(i,t),this.Xr.add(i.toString()),k.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),k.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Xr,i=>{let r=z.fromPath(i);return this.ei(e,r).next(s=>{s||t.removeEntry(r,ie.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(i=>{i?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return k.or([()=>k.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Um=class{constructor(e){this.serializer=e}O(e,t,i,r){let s=new _u("createOrUpgrade",t);i<1&&r>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pE,{unique:!0}),l.createObjectStore("documentMutations")}(e),ZE(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=k.resolve();return i<3&&r>=3&&(i!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),ZE(e)),o=o.next(()=>function(l){let u=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",h)}(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pE,{unique:!0});let g=u.store("mutations"),v=h.map(b=>g.put(b));return k.waitFor(v)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),i<5&&r>=5&&(o=o.next(()=>this.ni(s))),i<6&&r>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),i<7&&r>=7&&(o=o.next(()=>this.ii(s))),i<8&&r>=8&&(o=o.next(()=>this.si(e,s))),i<9&&r>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&r>=10&&(o=o.next(()=>this.oi(s))),i<11&&r>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),i<12&&r>=12&&(o=o.next(()=>{(function(l){let u=l.createObjectStore("documentOverlays",{keyPath:hx});u.createIndex("collectionPathOverlayIndex",fx,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",px,{unique:!1})})(e)})),i<13&&r>=13&&(o=o.next(()=>function(l){let u=l.createObjectStore("remoteDocumentsV14",{keyPath:tx});u.createIndex("documentKeyIndex",nx),u.createIndex("collectionGroupIndex",ix)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.ai(e,s))),i<15&&r>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:cx}).createIndex("sequenceNumberIndex",lx,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:ux}).createIndex("documentKeyIndex",dx,{unique:!1})}(e))),i<16&&r>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),i<17&&r>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((i,r)=>{t+=ku(r)}).next(()=>{let i={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}ni(e){let t=e.store("mutationQueues"),i=e.store("mutations");return t.U().next(r=>k.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",o).next(c=>k.forEach(c,l=>{J(l.userId===s.userId);let u=wr(this.serializer,l);return pI(e,s.userId,u).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),i=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{let s=[];return i.J((o,c)=>{let l=new Ee(o),u=function(g){return[0,Ut(g)]}(l);s.push(t.get(u).next(h=>h?k.resolve():(g=>t.put({targetId:0,path:Ut(g),sequenceNumber:r.highestListenSequenceNumber}))(l)))}).next(()=>k.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:ax});let i=t.store("collectionParents"),r=new ac,s=o=>{if(r.add(o)){let c=o.lastSegment(),l=o.popLast();return i.put({collectionId:c,parent:Ut(l)})}};return t.store("remoteDocuments").J({H:!0},(o,c)=>{let l=new Ee(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,c,l],u)=>{let h=Nn(c);return s(h.popLast())}))}oi(e){let t=e.store("targets");return t.J((i,r)=>{let s=qa(r),o=dI(this.serializer,s);return t.put(o)})}_i(e,t){let i=t.store("remoteDocuments"),r=[];return i.J((s,o)=>{let c=t.store("remoteDocumentsV14"),l=function(g){return g.document?new z(Ee.fromString(g.document.name).popFirst(5)):g.noDocument?z.fromSegments(g.noDocument.path):g.unknownDocument?z.fromSegments(g.unknownDocument.path):K()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(c.put(u))}).next(()=>k.waitFor(r))}ai(e,t){let i=t.store("mutations"),r=_I(this.serializer),s=new Fu(Lu.Zr,this.serializer.ct);return i.U().next(o=>{let c=new Map;return o.forEach(l=>{var u;let h=(u=c.get(l.userId))!==null&&u!==void 0?u:fe();wr(this.serializer,l).keys().forEach(g=>h=h.add(g)),c.set(l.userId,h)}),k.forEach(c,(l,u)=>{let h=new lt(u),g=xu.lt(this.serializer,h),v=s.getIndexManager(h),b=Ou.lt(h,this.serializer,v,s.referenceDelegate);return new Vu(r,b,g,v).recalculateAndSaveOverlaysForDocumentKeys(new Ja(t,tn.oe),l).next()})})}};function ZE(n){n.createObjectStore("targetDocuments",{keyPath:sx}).createIndex("documentTargetsIndex",ox,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",rx,{unique:!0}),n.createObjectStore("targetGlobal")}var Sp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",jm=class n{constructor(e,t,i,r,s,o,c,l,u,h,g=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.ui=s,this.window=o,this.document=c,this.ci=u,this.li=h,this.hi=g,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=v=>Promise.resolve(),!n.D())throw new L(V.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Sm(this,r),this.Ai=t+"main",this.serializer=new Ru(l),this.Ri=new qi(this.Ai,this.hi,new Um(this.serializer)),this.$r=new pm,this.Ur=new Im(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_I(this.serializer),this.Gr=new fm,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&nt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(V.FAILED_PRECONDITION,Sp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new tn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>E(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>E(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>E(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ou(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Xi(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ja(e).get("owner").next(t=>k.resolve(this.vi(t)))}Ci(e){return ou(e).delete(this.clientId)}Fi(){return E(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let i=pt(t,"clientMetadata");return i.U().next(r=>{let s=this.xi(r,18e5),o=r.filter(c=>s.indexOf(c)===-1);return k.forEach(o,c=>i.delete(c.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?k.resolve(!0):ja(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new L(V.FAILED_PRECONDITION,Sp);return!1}}return!(!this.networkEnabled||!this.inForeground)||ou(e).U().next(i=>this.xi(i,5e3).find(r=>{if(this.clientId!==r.clientId){let s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,c=this.networkEnabled===r.networkEnabled;if(s||o&&c)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return E(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Ja(e,tn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(i=>this.Mi(i.updateTimeMs,t)&&!this.Ni(i.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ou(e).U().next(t=>this.xi(t,18e5).map(i=>i.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Ou.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new bm(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return xu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,i){U("IndexedDbPersistence","Starting transaction:",e);let r=t==="readonly"?"readonly":"readwrite",s=function(l){return l===17?_x:l===16?gx:l===15?Og:l===14?Tb:l===13?Ib:l===12?mx:l===11?bb:void K()}(this.hi),o;return this.Ri.runTransaction(e,r,s,c=>(o=new Ja(c,this.Qr?this.Qr.next():tn.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new L(V.FAILED_PRECONDITION,yb);return i(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>i(o)))).then(c=>(o.raiseOnCommittedEvent(),c))}Ki(e){return ja(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new L(V.FAILED_PRECONDITION,Sp)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ja(e).put("owner",t)}static D(){return qi.D()}bi(e){let t=ja(e);return t.get("owner").next(i=>this.vi(i)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):k.resolve())}Mi(e,t){let i=Date.now();return!(e<i-t)&&(!(e>i)||(nt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;Gh()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let i=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return nt("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){nt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function ja(n){return pt(n,"owner")}function ou(n){return pt(n,"clientMetadata")}function $g(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Bm=class n{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.$i=i,this.Ui=r}static Wi(e,t){let i=fe(),r=fe();for(let s of t.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(e,t.fromCache,i,r)}};var qm=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Uu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Gh()?8:vb(ia())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,i,r){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new qm;return this.Xi(e,t,o).next(c=>{if(s.result=c,this.zi)return this.es(e,t,o,c.size)})}).next(()=>s.result)}es(e,t,i,r){return i.documentReadCount<this.ji?(Ms()<=Rn.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",ks(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),k.resolve()):(Ms()<=Rn.DEBUG&&U("QueryEngine","Query:",ks(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(Ms()<=Rn.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",ks(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jt(t))):k.resolve())}Yi(e,t){if(AE(t))return k.resolve(null);let i=jt(t);return this.indexManager.getIndexType(e,i).next(r=>r===0?null:(t.limit!==null&&r===1&&(t=Tu(t,null,"F"),i=jt(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(s=>{let o=fe(...s);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,i).next(l=>{let u=this.ts(t,c);return this.ns(t,u,o,l.readTime)?this.Yi(e,Tu(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,i,r){return AE(t)||r.isEqual(ie.min())?k.resolve(null):this.Ji.getDocuments(e,i).next(s=>{let o=this.ts(t,s);return this.ns(t,o,i,r)?k.resolve(null):(Ms()<=Rn.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ks(t)),this.rs(e,o,t,gb(r,-1)).next(c=>c))})}ts(e,t){let i=new Ne(Lb(e));return t.forEach((r,s)=>{yc(e,s)&&(i=i.add(s))}),i}ns(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(e,t,i){return Ms()<=Rn.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",ks(t)),this.Ji.getDocumentsMatchingQuery(e,t,dn.min(),i)}rs(e,t,i,r){return this.Ji.getDocumentsMatchingQuery(e,i,r).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var $m=class{constructor(e,t,i,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Ue(he),this._s=new qn(s=>Rr(s),gc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(i)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vu(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function yI(n,e,t,i){return new $m(n,e,t,i)}function vI(n,e){return E(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,t.ls(e),t.mutationQueue.getAllMutationBatches(i))).next(s=>{let o=[],c=[],l=fe();for(let u of r){o.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}for(let u of s){c.push(u.batchId);for(let h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(i,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:c}))})})})}function Jx(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,l,u,h){let g=u.batch,v=g.keys(),b=k.resolve();return v.forEach(O=>{b=b.next(()=>h.getEntry(l,O)).next(M=>{let x=u.docVersions.get(O);J(x!==null),M.version.compareTo(x)<0&&(g.applyToRemoteDocument(M,u),M.isValidDocument()&&(M.setReadTime(u.commitVersion),h.addEntry(M)))})}),b.next(()=>c.mutationQueue.removeMutationBatch(l,g))}(t,i,e,s).next(()=>s.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let l=fe();for(let u=0;u<c.mutationResults.length;++u)c.mutationResults[u].transformResults.length>0&&(l=l.add(c.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(i,r))})}function wI(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Yx(n,e){let t=$(n),i=e.snapshotVersion,r=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});r=t.os;let c=[];e.targetChanges.forEach((h,g)=>{let v=r.get(g);if(!v)return;c.push(t.Ur.removeMatchingKeys(s,h.removedDocuments,g).next(()=>t.Ur.addMatchingKeys(s,h.addedDocuments,g)));let b=v.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?b=b.withResumeToken(st.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,i)),r=r.insert(g,b),function(M,x,B){return M.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=3e8?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(v,b,h)&&c.push(t.Ur.updateTargetData(s,b))});let l=Gt(),u=fe();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),c.push(EI(s,o,e.documentUpdates).next(h=>{l=h.Ps,u=h.Is})),!i.isEqual(ie.min())){let h=t.Ur.getLastRemoteSnapshotVersion(s).next(g=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));c.push(h)}return k.waitFor(c).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=r,s))}function EI(n,e,t){let i=fe(),r=fe();return t.forEach(s=>i=i.add(s)),e.getEntries(n,i).next(s=>{let o=Gt();return t.forEach((c,l)=>{let u=s.get(c);l.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(c)),l.isNoDocument()&&l.version.isEqual(ie.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):U("LocalStore","Ignoring outdated watch update for ",c,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:r}})}function Xx(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Js(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return t.Ur.getTargetData(i,e).next(s=>s?(r=s,k.resolve(r)):t.Ur.allocateTargetId(i).next(o=>(r=new Ks(e,o,"TargetPurposeListen",i.currentSequenceNumber),t.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=t.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.os=t.os.insert(i.targetId,i),t._s.set(e,i.targetId)),i})}function Ys(n,e,t){return E(this,null,function*(){let i=$(n),r=i.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!Xi(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.os=i.os.remove(e),i._s.delete(r.target)})}function ju(n,e,t){let i=$(n),r=ie.min(),s=fe();return i.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){let g=$(l),v=g._s.get(h);return v!==void 0?k.resolve(g.os.get(v)):g.Ur.getTargetData(u,h)}(i,o,jt(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(o,c.targetId).next(l=>{s=l})}).next(()=>i.ss.getDocumentsMatchingQuery(o,e,t?r:ie.min(),t?s:fe())).next(c=>(TI(i,Fb(e),c),{documents:c,Ts:s})))}function bI(n,e){let t=$(n),i=$(t.Ur),r=t.os.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>i.ot(s,e).next(o=>o?o.target:null))}function II(n,e){let t=$(n),i=t.us.get(e)||ie.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.cs.getAllFromCollectionGroup(r,e,gb(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(TI(t,e,r),r))}function TI(n,e,t){let i=n.us.get(e)||ie.min();t.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(e,i)}function Zx(n,e,t,i){return E(this,null,function*(){let r=$(n),s=fe(),o=Gt();for(let u of t){let h=e.Es(u.metadata.name);u.document&&(s=s.add(h));let g=e.ds(u);g.setReadTime(e.As(u.metadata.readTime)),o=o.insert(h,g)}let c=r.cs.newChangeBuffer({trackRemovals:!0}),l=yield Js(r,function(h){return jt(so(Ee.fromString(`__bundle__/docs/${h}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",u=>EI(u,c,o).next(h=>(c.apply(u),h)).next(h=>r.Ur.removeMatchingKeysForTargetId(u,l.targetId).next(()=>r.Ur.addMatchingKeys(u,s,l.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(u,h.Ps,h.Is)).next(()=>h.Ps)))})}function eD(i,r){return E(this,arguments,function*(n,e,t=fe()){let s=yield Js(n,jt(Bg(e.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",c=>{let l=rt(e.readTime);if(s.snapshotVersion.compareTo(l)>=0)return o.Gr.saveNamedQuery(c,e);let u=s.withResumeToken(st.EMPTY_BYTE_STRING,l);return o.os=o.os.insert(u.targetId,u),o.Ur.updateTargetData(c,u).next(()=>o.Ur.removeMatchingKeysForTargetId(c,s.targetId)).next(()=>o.Ur.addMatchingKeys(c,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(c,e))})})}function eb(n,e){return`firestore_clients_${n}_${e}`}function tb(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function Rp(n,e){return`firestore_targets_${n}_${e}`}var Bu=class n{constructor(e,t,i,r){this.user=e,this.batchId=t,this.state=i,this.error=r}static Rs(e,t,i){let r=JSON.parse(i),s,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new L(r.error.code,r.error.message))),o?new n(e,t,r.state,s):(nt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ga=class n{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Rs(e,t){let i=JSON.parse(t),r,s=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(r=new L(i.error.code,i.error.message))),s?new n(e,i.state,r):(nt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},qu=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let i=JSON.parse(t),r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=Lg();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=wb(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new n(e,s):(nt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},zm=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(nt("SharedClientState",`Failed to parse online state: ${e}`),null)}},lc=class{constructor(){this.activeTargetIds=Lg()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ha=class{constructor(e,t,i,r,s){this.window=e,this.ui=t,this.persistenceKey=i,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ue(he),this.started=!1,this.bs=[];let o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=eb(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new lc),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return E(this,null,function*(){let e=yield this.syncEngine.Qi();for(let i of e){if(i===this.ps)continue;let r=this.getItem(eb(this.persistenceKey,i));if(r){let s=qu.Rs(i,r);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let i=this.Ls(t);i&&this.Bs(i)}for(let i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((i,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,i){this.qs(e,t,i),this.Qs(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Rp(this.persistenceKey,e));if(r){let s=Ga.Rs(e,r);s&&(i=s.state)}}return t&&this.Ks.fs(e),this.Ns(),i}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Rp(this.persistenceKey,e))}updateQueryState(e,t,i){this.$s(e,t,i)}handleUserChange(e,t,i){t.forEach(r=>{this.Qs(r)}),this.currentUser=e,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(U("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>E(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let i=this.Gs(t.key);return this.zs(i,null)}{let i=this.js(t.key,t.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let i=this.Hs(t.key,t.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let i=this.Ys(t.key,t.newValue);if(i)return this.Zs(i)}}else if(t.key===this.xs){if(t.newValue!==null){let i=this.Ls(t.newValue);if(i)return this.Bs(i)}}else if(t.key===this.vs){let i=function(s){let o=tn.oe;if(s!=null)try{let c=JSON.parse(s);J(typeof c=="number"),o=c}catch(c){nt("SharedClientState","Failed to read sequence number from WebStorage",c)}return o}(t.newValue);i!==tn.oe&&this.sequenceNumberHandler(i)}else if(t.key===this.Os){let i=this.Xs(t.newValue);yield Promise.all(i.map(r=>this.syncEngine.eo(r)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,i){let r=new Bu(this.currentUser,e,t,i),s=tb(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Vs())}Qs(e){let t=tb(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,i){let r=Rp(this.persistenceKey,e),s=new Ga(e,t,i);this.setItem(r,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let i=this.Gs(e);return qu.Rs(i,t)}Hs(e,t){let i=this.Fs.exec(e),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return Bu.Rs(new lt(s),r,t)}Ys(e,t){let i=this.Ms.exec(e),r=Number(i[1]);return Ga.Rs(r,t)}Ls(e){return zm.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return E(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let i=t?this.Ss.insert(e,t):this.Ss.remove(e),r=this.ks(this.Ss),s=this.ks(i),o=[],c=[];return s.forEach(l=>{r.has(l)||o.push(l)}),r.forEach(l=>{s.has(l)||c.push(l)}),this.syncEngine.io(o,c).then(()=>{this.Ss=i})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Lg();return e.forEach((i,r)=>{t=t.unionWith(r.activeTargetIds)}),t}},$u=class{constructor(){this.so=new lc,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,i){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new lc,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Wm=class{_o(e){}shutdown(){}};var zu=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var au=null;function Pp(){return au===null?au=function(){return 268435456+Math.round(2147483648*Math.random())}():au++,"0x"+au.toString(16)}var tD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Gm=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ot="WebChannelConnection",Hm=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let i=t.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+t.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(t,i,r,s,o){let c=Pp(),l=this.xo(t,i.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${c}:`,l,r);let u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,r).then(h=>(U("RestConnection",`Received RPC '${t}' ${c}: `,h),h),h=>{throw vn("RestConnection",`RPC '${t}' ${c} failed with error: `,h,"url: ",l,"request:",r),h})}Lo(t,i,r,s,o,c){return this.Mo(t,i,r,s,o)}Oo(t,i,r){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ro}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>t[o]=s),r&&r.headers.forEach((s,o)=>t[o]=s)}xo(t,i){let r=tD[t];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,i,r){let s=Pp();return new Promise((o,c)=>{let l=new Ep;l.setWithCredentials(!0),l.listenOnce(bp.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Va.NO_ERROR:let h=l.getResponseJson();U(Ot,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case Va.TIMEOUT:U(Ot,`RPC '${e}' ${s} timed out`),c(new L(V.DEADLINE_EXCEEDED,"Request time out"));break;case Va.HTTP_ERROR:let g=l.getStatus();if(U(Ot,`RPC '${e}' ${s} failed with status:`,g,"response text:",l.getResponseText()),g>0){let v=l.getResponseJson();Array.isArray(v)&&(v=v[0]);let b=v?.error;if(b&&b.status&&b.message){let O=function(x){let B=x.toLowerCase().replace(/_/g,"-");return Object.values(V).indexOf(B)>=0?B:V.UNKNOWN}(b.status);c(new L(O,b.message))}else c(new L(V.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new L(V.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{U(Ot,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(r);U(Ot,`RPC '${e}' ${s} sending request:`,r),l.send(t,"POST",u,i,15)})}Bo(e,t,i){let r=Pp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Cp(),c=Tp(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,i),l.encodeInitMessageHeaders=!0;let h=s.join("");U(Ot,`Creating RPC '${e}' stream ${r}: ${h}`,l);let g=o.createWebChannel(h,l),v=!1,b=!1,O=new Gm({Io:x=>{b?U(Ot,`Not sending because RPC '${e}' stream ${r} is closed:`,x):(v||(U(Ot,`Opening RPC '${e}' stream ${r} transport.`),g.open(),v=!0),U(Ot,`RPC '${e}' stream ${r} sending:`,x),g.send(x))},To:()=>g.close()}),M=(x,B,H)=>{x.listen(B,F=>{try{H(F)}catch(G){setTimeout(()=>{throw G},0)}})};return M(g,Ss.EventType.OPEN,()=>{b||(U(Ot,`RPC '${e}' stream ${r} transport opened.`),O.yo())}),M(g,Ss.EventType.CLOSE,()=>{b||(b=!0,U(Ot,`RPC '${e}' stream ${r} transport closed`),O.So())}),M(g,Ss.EventType.ERROR,x=>{b||(b=!0,vn(Ot,`RPC '${e}' stream ${r} transport errored:`,x),O.So(new L(V.UNAVAILABLE,"The operation could not be completed")))}),M(g,Ss.EventType.MESSAGE,x=>{var B;if(!b){let H=x.data[0];J(!!H);let F=H,G=F.error||((B=F[0])===null||B===void 0?void 0:B.error);if(G){U(Ot,`RPC '${e}' stream ${r} received error:`,G);let re=G.status,ee=function(I){let A=at[I];if(A!==void 0)return Yb(A)}(re),C=G.message;ee===void 0&&(ee=V.INTERNAL,C="Unknown error status: "+re+" with message "+G.message),b=!0,O.So(new L(ee,C)),g.close()}else U(Ot,`RPC '${e}' stream ${r} received:`,H),O.bo(H)}}),M(c,Ip.STAT_EVENT,x=>{x.stat===iu.PROXY?U(Ot,`RPC '${e}' stream ${r} detected buffering proxy`):x.stat===iu.NOPROXY&&U(Ot,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{O.wo()},0),O}};function CI(){return typeof window<"u"?window:null}function hu(){return typeof document<"u"?document:null}function vc(n){return new cm(n,!0)}var uc=class{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&U("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Wu=class{constructor(e,t,i,r,s,o,c,l){this.ui=e,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new uc(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return E(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return E(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return E(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===V.RESOURCE_EXHAUSTED?(nt(t.toString()),nt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===V.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===t&&this.P_(i,r)},i=>{e(()=>{let r=new L(V.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(e,t){let i=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>E(this,null,function*(){this.state=0,this.start()}))}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Km=class extends Wu{constructor(e,t,i,r,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=Ux(this.serializer,e),i=function(s){if(!("targetChange"in s))return ie.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?rt(o.readTime):ie.min()}(e);return this.listener.d_(t,i)}A_(e){let t={};t.database=dm(this.serializer),t.addTarget=function(s,o){let c,l=o.target;if(c=bu(l)?{documents:sI(s,l)}:{query:oI(s,l)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Zb(s,o.resumeToken);let u=lm(s,o.expectedCount);u!==null&&(c.expectedCount=u)}else if(o.snapshotVersion.compareTo(ie.min())>0){c.readTime=Hs(s,o.snapshotVersion.toTimestamp());let u=lm(s,o.expectedCount);u!==null&&(c.expectedCount=u)}return c}(this.serializer,e);let i=Bx(this.serializer,e);i&&(t.labels=i),this.a_(t)}R_(e){let t={};t.database=dm(this.serializer),t.removeTarget=e,this.a_(t)}},Qm=class extends Wu{constructor(e,t,i,r,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return J(!!e.streamToken),this.lastStreamToken=e.streamToken,J(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){J(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=jx(e.writeResults,e.commitTime),i=rt(e.commitTime);return this.listener.g_(i,t)}p_(){let e={};e.database=dm(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(i=>oc(this.serializer,i))};this.a_(t)}};var Jm=class extends class{}{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new L(V.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,um(t,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(V.UNKNOWN,s.toString())})}Lo(e,t,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,um(t,i),r,o,c,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===V.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(V.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Ym=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(nt(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Xm=class{constructor(e,t,i,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{i.enqueueAndForget(()=>E(this,null,function*(){Zi(this)&&(U("RemoteStore","Restarting streams for network reachability change."),yield function(l){return E(this,null,function*(){let u=$(l);u.L_.add(4),yield oo(u),u.q_.set("Unknown"),u.L_.delete(4),yield wc(u)})}(this))}))}),this.q_=new Ym(i,r)}};function wc(n){return E(this,null,function*(){if(Zi(n))for(let e of n.B_)yield e(!0)})}function oo(n){return E(this,null,function*(){for(let e of n.B_)yield e(!1)})}function hd(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Gg(t)?Wg(t):co(t).r_()&&zg(t,e))}function Xs(n,e){let t=$(n),i=co(t);t.N_.delete(e),i.r_()&&AI(t,e),t.N_.size===0&&(i.r_()?i.o_():Zi(t)&&t.q_.set("Unknown"))}function zg(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}co(n).A_(e)}function AI(n,e){n.Q_.xe(e),co(n).R_(e)}function Wg(n){n.Q_=new am({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),co(n).start(),n.q_.v_()}function Gg(n){return Zi(n)&&!co(n).n_()&&n.N_.size>0}function Zi(n){return $(n).L_.size===0}function SI(n){n.Q_=void 0}function nD(n){return E(this,null,function*(){n.q_.set("Online")})}function iD(n){return E(this,null,function*(){n.N_.forEach((e,t)=>{zg(n,e)})})}function rD(n,e){return E(this,null,function*(){SI(n),Gg(n)?(n.q_.M_(e),Wg(n)):n.q_.set("Unknown")})}function sD(n,e,t){return E(this,null,function*(){if(n.q_.set("Online"),e instanceof Au&&e.state===2&&e.cause)try{yield function(r,s){return E(this,null,function*(){let o=s.cause;for(let c of s.targetIds)r.N_.has(c)&&(yield r.remoteSyncer.rejectListen(c,o),r.N_.delete(c),r.Q_.removeTarget(c))})}(n,e)}catch(i){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Gu(n,i)}else if(e instanceof js?n.Q_.Ke(e):e instanceof Cu?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ie.min()))try{let i=yield wI(n.localStore);t.compareTo(i)>=0&&(yield function(s,o){let c=s.Q_.rt(o);return c.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){let h=s.N_.get(u);h&&s.N_.set(u,h.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,u)=>{let h=s.N_.get(l);if(!h)return;s.N_.set(l,h.withResumeToken(st.EMPTY_BYTE_STRING,h.snapshotVersion)),AI(s,l);let g=new Ks(h.target,l,u,h.sequenceNumber);zg(s,g)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(i){U("RemoteStore","Failed to raise snapshot:",i),yield Gu(n,i)}})}function Gu(n,e,t){return E(this,null,function*(){if(!Xi(e))throw e;n.L_.add(1),yield oo(n),n.q_.set("Offline"),t||(t=()=>wI(n.localStore)),n.asyncQueue.enqueueRetryable(()=>E(this,null,function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield wc(n)}))})}function RI(n,e){return e().catch(t=>Gu(n,t,e))}function ao(n){return E(this,null,function*(){let e=$(n),t=Ji(e),i=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;oD(e);)try{let r=yield Xx(e.localStore,i);if(r===null){e.O_.length===0&&t.o_();break}i=r.batchId,aD(e,r)}catch(r){yield Gu(e,r)}PI(e)&&xI(e)})}function oD(n){return Zi(n)&&n.O_.length<10}function aD(n,e){n.O_.push(e);let t=Ji(n);t.r_()&&t.V_&&t.m_(e.mutations)}function PI(n){return Zi(n)&&!Ji(n).n_()&&n.O_.length>0}function xI(n){Ji(n).start()}function cD(n){return E(this,null,function*(){Ji(n).p_()})}function lD(n){return E(this,null,function*(){let e=Ji(n);for(let t of n.O_)e.m_(t.mutations)})}function uD(n,e,t){return E(this,null,function*(){let i=n.O_.shift(),r=rm.from(i,e,t);yield RI(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield ao(n)})}function dD(n,e){return E(this,null,function*(){e&&Ji(n).V_&&(yield function(i,r){return E(this,null,function*(){if(function(o){return Jb(o)&&o!==V.ABORTED}(r.code)){let s=i.O_.shift();Ji(i).s_(),yield RI(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield ao(i)}})}(n,e)),PI(n)&&xI(n)})}function nb(n,e){return E(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");let i=Zi(t);t.L_.add(3),yield oo(t),i&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield wc(t)})}function Zm(n,e){return E(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield wc(t)):e||(t.L_.add(2),yield oo(t),t.q_.set("Unknown"))})}function co(n){return n.K_||(n.K_=function(t,i,r){let s=$(t);return s.w_(),new Km(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:nD.bind(null,n),Ro:iD.bind(null,n),mo:rD.bind(null,n),d_:sD.bind(null,n)}),n.B_.push(e=>E(this,null,function*(){e?(n.K_.s_(),Gg(n)?Wg(n):n.q_.set("Unknown")):(yield n.K_.stop(),SI(n))}))),n.K_}function Ji(n){return n.U_||(n.U_=function(t,i,r){let s=$(t);return s.w_(),new Qm(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:cD.bind(null,n),mo:dD.bind(null,n),f_:lD.bind(null,n),g_:uD.bind(null,n)}),n.B_.push(e=>E(this,null,function*(){e?(n.U_.s_(),yield ao(n)):(yield n.U_.stop(),n.O_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var eg=class n{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){let o=Date.now()+i,c=new n(e,t,o,r,s);return c.start(i),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(V.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function lo(n,e){if(nt("AsyncQueue",`${e}: ${n}`),Xi(n))return new L(V.UNAVAILABLE,`${e}: ${n}`);throw n}var Hu=class n{constructor(e){this.comparator=e?(t,i)=>e(t,i)||z.comparator(t.key,i.key):(t,i)=>z.comparator(t.key,i.key),this.keyedMap=Ba(),this.sortedSet=new Ue(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){let r=t.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let i=new n;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}};var Ku=class{constructor(){this.W_=new Ue(z.comparator)}track(e){let t=e.doc.key,i=this.W_.get(t);i?e.type!==0&&i.type===3?this.W_=this.W_.insert(t,e):e.type===3&&i.type!==1?this.W_=this.W_.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.W_=this.W_.remove(t):e.type===1&&i.type===2?this.W_=this.W_.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):K():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,i)=>{e.push(i)}),e}},Zs=class n{constructor(e,t,i,r,s,o,c,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,r,s){let o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new n(e,t,Hu.emptySet(t),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_c(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}};var tg=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},ng=class{constructor(){this.queries=ib(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,i){let r=$(t),s=r.queries;r.queries=ib(),s.forEach((o,c)=>{for(let l of c.j_)l.onError(i)})})(this,new L(V.ABORTED,"Firestore shutting down"))}};function ib(){return new qn(n=>Vb(n),_c)}function Hg(n,e){return E(this,null,function*(){let t=$(n),i=3,r=e.query,s=t.queries.get(r);s?!s.H_()&&e.J_()&&(i=2):(s=new tg,i=e.J_()?0:1);try{switch(i){case 0:s.z_=yield t.onListen(r,!0);break;case 1:s.z_=yield t.onListen(r,!1);break;case 2:yield t.onFirstRemoteStoreListen(r)}}catch(o){let c=lo(o,`Initialization of query '${ks(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Qg(t)})}function Kg(n,e){return E(this,null,function*(){let t=$(n),i=e.query,r=3,s=t.queries.get(i);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?r=e.J_()?0:1:!s.H_()&&e.J_()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}})}function hD(n,e){let t=$(n),i=!1;for(let r of e){let s=r.query,o=t.queries.get(s);if(o){for(let c of o.j_)c.X_(r)&&(i=!0);o.z_=r}}i&&Qg(t)}function fD(n,e,t){let i=$(n),r=i.queries.get(e);if(r)for(let s of r.j_)s.onError(t);i.queries.delete(e)}function Qg(n){n.Y_.forEach(e=>{e.next()})}var ig,rb;(rb=ig||(ig={})).ea="default",rb.Cache="cache";var dc=class{constructor(e,t,i){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(e){if(!this.options.includeMetadataChanges){let i=[];for(let r of e.docChanges)r.type!==3&&i.push(r);e=new Zs(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let i=t!=="Offline";return(!this.options._a||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Zs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ig.Cache}};var rg=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var Qu=class{constructor(e){this.serializer=e}Es(e){return Ln(this.serializer,e)}ds(e){return e.metadata.exists?rI(this.serializer,e.document,!1):ut.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return rt(e)}},sg=class{constructor(e,t,i){this.ca=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=DI(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let i=Ee.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,i=new Qu(this.serializer);for(let r of e)if(r.metadata.queries){let s=i.Es(r.metadata.name);for(let o of r.metadata.queries){let c=(t.get(o)||fe()).add(s);t.set(o,c)}}return t}complete(){return E(this,null,function*(){let e=yield Zx(this.localStore,new Qu(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let i of this.queries)yield eD(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function DI(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ju=class{constructor(e){this.key=e}},Yu=class{constructor(e){this.key=e}},Xu=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=fe(),this.mutatedKeys=fe(),this.Aa=Lb(e),this.Ra=new Hu(this.Aa)}get Va(){return this.Ta}ma(e,t){let i=t?t.fa:new Ku,r=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=r,c=!1,l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,g)=>{let v=r.get(h),b=yc(this.query,g)?g:null,O=!!v&&this.mutatedKeys.has(v.key),M=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),x=!1;v&&b?v.data.isEqual(b.data)?O!==M&&(i.track({type:3,doc:b}),x=!0):this.ga(v,b)||(i.track({type:2,doc:b}),x=!0,(l&&this.Aa(b,l)>0||u&&this.Aa(b,u)<0)&&(c=!0)):!v&&b?(i.track({type:0,doc:b}),x=!0):v&&!b&&(i.track({type:1,doc:v}),x=!0,(l||u)&&(c=!0)),x&&(b?(o=o.add(b),s=M?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{Ra:o,fa:i,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((h,g)=>function(b,O){let M=x=>{switch(x){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K()}};return M(b)-M(O)}(h.type,g.type)||this.Aa(h.doc,g.doc)),this.pa(i),r=r!=null&&r;let c=t&&!r?this.ya():[],l=this.da.size===0&&this.current&&!r?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new Zs(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ku,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=fe(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let t=[];return e.forEach(i=>{this.da.has(i)||t.push(new Yu(i))}),this.da.forEach(i=>{e.has(i)||t.push(new Ju(i))}),t}ba(e){this.Ta=e.Ts,this.da=fe();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Zs.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},og=class{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}},ag=class{constructor(e){this.key=e,this.va=!1}},cg=class{constructor(e,t,i,r,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new qn(c=>Vb(c),_c),this.Ma=new Map,this.xa=new Set,this.Oa=new Ue(z.comparator),this.Na=new Map,this.La=new cc,this.Ba={},this.ka=new Map,this.qa=Qs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function pD(n,e,t=!0){return E(this,null,function*(){let i=fd(n),r,s=i.Fa.get(e);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield MI(i,e,t,!0),r})}function mD(n,e){return E(this,null,function*(){let t=fd(n);yield MI(t,e,!0,!1)})}function MI(n,e,t,i){return E(this,null,function*(){let r=yield Js(n.localStore,jt(e)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return i&&(c=yield Jg(n,e,s,o==="current",r.resumeToken)),n.isPrimaryClient&&t&&hd(n.remoteStore,r),c})}function Jg(n,e,t,i,r){return E(this,null,function*(){n.Ka=(g,v,b)=>function(M,x,B,H){return E(this,null,function*(){let F=x.view.ma(B);F.ns&&(F=yield ju(M.localStore,x.query,!1).then(({documents:C})=>x.view.ma(C,F)));let G=H&&H.targetChanges.get(x.targetId),re=H&&H.targetMismatches.get(x.targetId)!=null,ee=x.view.applyChanges(F,M.isPrimaryClient,G,re);return lg(M,x.targetId,ee.wa),ee.snapshot})}(n,g,v,b);let s=yield ju(n.localStore,e,!0),o=new Xu(e,s.Ts),c=o.ma(s.documents),l=rc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),u=o.applyChanges(c,n.isPrimaryClient,l);lg(n,t,u.wa);let h=new og(e,t,o);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot})}function gD(n,e,t){return E(this,null,function*(){let i=$(n),r=i.Fa.get(e),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(o=>!_c(o,e))),void i.Fa.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Ys(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),t&&Xs(i.remoteStore,r.targetId),eo(i,r.targetId)}).catch(Yi))):(eo(i,r.targetId),yield Ys(i.localStore,r.targetId,!0))})}function _D(n,e){return E(this,null,function*(){let t=$(n),i=t.Fa.get(e),r=t.Ma.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Xs(t.remoteStore,i.targetId))})}function yD(n,e,t){return E(this,null,function*(){let i=e_(n);try{let r=yield function(o,c){let l=$(o),u=He.now(),h=c.reduce((b,O)=>b.add(O.key),fe()),g,v;return l.persistence.runTransaction("Locally write mutations","readwrite",b=>{let O=Gt(),M=fe();return l.cs.getEntries(b,h).next(x=>{O=x,O.forEach((B,H)=>{H.isValidDocument()||(M=M.add(B))})}).next(()=>l.localDocuments.getOverlayedDocuments(b,O)).next(x=>{g=x;let B=[];for(let H of c){let F=Mx(H,g.get(H.key).overlayedDocument);F!=null&&B.push(new En(H.key,F,Pb(F.value.mapValue),et.exists(!0)))}return l.mutationQueue.addMutationBatch(b,u,B,c)}).next(x=>{v=x;let B=x.applyToLocalDocumentSet(g,M);return l.documentOverlayCache.saveOverlays(b,x.batchId,B)})}).then(()=>({batchId:v.batchId,changes:jb(g)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),function(o,c,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new Ue(he)),u=u.insert(c,l),o.Ba[o.currentUser.toKey()]=u}(i,r.batchId,t),yield fi(i,r.changes),yield ao(i.remoteStore)}catch(r){let s=lo(r,"Failed to persist write");t.reject(s)}})}function kI(n,e){return E(this,null,function*(){let t=$(n);try{let i=yield Yx(t.localStore,e);e.targetChanges.forEach((r,s)=>{let o=t.Na.get(s);o&&(J(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?J(o.va):r.removedDocuments.size>0&&(J(o.va),o.va=!1))}),yield fi(t,i,e)}catch(i){yield Yi(i)}})}function sb(n,e,t){let i=$(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){let r=[];i.Fa.forEach((s,o)=>{let c=o.view.Z_(e);c.snapshot&&r.push(c.snapshot)}),function(o,c){let l=$(o);l.onlineState=c;let u=!1;l.queries.forEach((h,g)=>{for(let v of g.j_)v.Z_(c)&&(u=!0)}),u&&Qg(l)}(i.eventManager,e),r.length&&i.Ca.d_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function vD(n,e,t){return E(this,null,function*(){let i=$(n);i.sharedClientState.updateQueryState(e,"rejected",t);let r=i.Na.get(e),s=r&&r.key;if(s){let o=new Ue(z.comparator);o=o.insert(s,ut.newNoDocument(s,ie.min()));let c=fe().add(s),l=new ic(ie.min(),new Map,new Ue(he),o,c);yield kI(i,l),i.Oa=i.Oa.remove(s),i.Na.delete(e),Zg(i)}else yield Ys(i.localStore,e,!1).then(()=>eo(i,e,t)).catch(Yi)})}function wD(n,e){return E(this,null,function*(){let t=$(n),i=e.batch.batchId;try{let r=yield Jx(t.localStore,e);Xg(t,i,null),Yg(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield fi(t,r)}catch(r){yield Yi(r)}})}function ED(n,e,t){return E(this,null,function*(){let i=$(n);try{let r=yield function(o,c){let l=$(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,c).next(g=>(J(g!==null),h=g.keys(),l.mutationQueue.removeMutationBatch(u,g))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(i.localStore,e);Xg(i,e,t),Yg(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield fi(i,r)}catch(r){yield Yi(r)}})}function bD(n,e){return E(this,null,function*(){let t=$(n);Zi(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield function(o){let c=$(o);return c.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>c.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(i===-1)return void e.resolve();let r=t.ka.get(i)||[];r.push(e),t.ka.set(i,r)}catch(i){let r=lo(i,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}})}function Yg(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Xg(n,e,t){let i=$(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),i.Ba[i.currentUser.toKey()]=r}}function eo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let i of n.Ma.get(e))n.Fa.delete(i),t&&n.Ca.$a(i,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(i=>{n.La.containsKey(i)||OI(n,i)})}function OI(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Xs(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Zg(n))}function lg(n,e,t){for(let i of t)i instanceof Ju?(n.La.addReference(i.key,e),ID(n,i)):i instanceof Yu?(U("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,e),n.La.containsKey(i.key)||OI(n,i.key)):K()}function ID(n,e){let t=e.key,i=t.path.canonicalString();n.Oa.get(t)||n.xa.has(i)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(i),Zg(n))}function Zg(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new z(Ee.fromString(e)),i=n.qa.next();n.Na.set(i,new ag(t)),n.Oa=n.Oa.insert(t,i),hd(n.remoteStore,new Ks(jt(so(t.path)),i,"TargetPurposeLimboResolution",tn.oe))}}function fi(n,e,t){return E(this,null,function*(){let i=$(n),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((c,l)=>{o.push(i.Ka(l,e,t).then(u=>{var h;if((u||t)&&i.isPrimaryClient){let g=u?!u.fromCache:(h=t?.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;i.sharedClientState.updateQueryState(l.targetId,g?"current":"not-current")}if(u){r.push(u);let g=Bm.Wi(l.targetId,u);s.push(g)}}))}),yield Promise.all(o),i.Ca.d_(r),yield function(l,u){return E(this,null,function*(){let h=$(l);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>k.forEach(u,v=>k.forEach(v.$i,b=>h.persistence.referenceDelegate.addReference(g,v.targetId,b)).next(()=>k.forEach(v.Ui,b=>h.persistence.referenceDelegate.removeReference(g,v.targetId,b)))))}catch(g){if(!Xi(g))throw g;U("LocalStore","Failed to update sequence numbers: "+g)}for(let g of u){let v=g.targetId;if(!g.fromCache){let b=h.os.get(v),O=b.snapshotVersion,M=b.withLastLimboFreeSnapshotVersion(O);h.os=h.os.insert(v,M)}}})}(i.localStore,s))})}function TD(n,e){return E(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());let i=yield vI(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(c=>{c.forEach(l=>{l.reject(new L(V.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield fi(t,i.hs)}})}function CD(n,e){let t=$(n),i=t.Na.get(e);if(i&&i.va)return fe().add(i.key);{let r=fe(),s=t.Ma.get(e);if(!s)return r;for(let o of s){let c=t.Fa.get(o);r=r.unionWith(c.view.Va)}return r}}function AD(n,e){return E(this,null,function*(){let t=$(n),i=yield ju(t.localStore,e.query,!0),r=e.view.ba(i);return t.isPrimaryClient&&lg(t,e.targetId,r.wa),r})}function SD(n,e){return E(this,null,function*(){let t=$(n);return II(t.localStore,e).then(i=>fi(t,i))})}function RD(n,e,t,i){return E(this,null,function*(){let r=$(n),s=yield function(c,l){let u=$(c),h=$(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",g=>h.Mn(g,l).next(v=>v?u.localDocuments.getDocuments(g,v):k.resolve(null)))}(r.localStore,e);s!==null?(t==="pending"?yield ao(r.remoteStore):t==="acknowledged"||t==="rejected"?(Xg(r,e,i||null),Yg(r,e),function(c,l){$($(c).mutationQueue).On(l)}(r.localStore,e)):K(),yield fi(r,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)})}function PD(n,e){return E(this,null,function*(){let t=$(n);if(fd(t),e_(t),e===!0&&t.Qa!==!0){let i=t.sharedClientState.getAllActiveQueryTargets(),r=yield ob(t,i.toArray());t.Qa=!0,yield Zm(t.remoteStore,!0);for(let s of r)hd(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let i=[],r=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(eo(t,o),Ys(t.localStore,o,!0))),Xs(t.remoteStore,o)}),yield r,yield ob(t,i),function(o){let c=$(o);c.Na.forEach((l,u)=>{Xs(c.remoteStore,u)}),c.La.pr(),c.Na=new Map,c.Oa=new Ue(z.comparator)}(t),t.Qa=!1,yield Zm(t.remoteStore,!1)}})}function ob(n,e,t){return E(this,null,function*(){let i=$(n),r=[],s=[];for(let o of e){let c,l=i.Ma.get(o);if(l&&l.length!==0){c=yield Js(i.localStore,jt(l[0]));for(let u of l){let h=i.Fa.get(u),g=yield AD(i,h);g.snapshot&&s.push(g.snapshot)}}else{let u=yield bI(i.localStore,o);c=yield Js(i.localStore,u),yield Jg(i,NI(u),o,!1,c.resumeToken)}r.push(c)}return i.Ca.d_(s),r})}function NI(n){return Nb(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function xD(n){return function(t){return $($(t).persistence).Qi()}($(n).localStore)}function DD(n,e,t,i){return E(this,null,function*(){let r=$(n);if(r.Qa)return void U("SyncEngine","Ignoring unexpected query state notification.");let s=r.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield II(r.localStore,Fb(s[0])),c=ic.createSynthesizedRemoteEventForCurrentChange(e,t==="current",st.EMPTY_BYTE_STRING);yield fi(r,o,c);break}case"rejected":yield Ys(r.localStore,e,!0),eo(r,e,i);break;default:K()}})}function MD(n,e,t){return E(this,null,function*(){let i=fd(n);if(i.Qa){for(let r of e){if(i.Ma.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){U("SyncEngine","Adding an already active target "+r);continue}let s=yield bI(i.localStore,r),o=yield Js(i.localStore,s);yield Jg(i,NI(s),o.targetId,!1,o.resumeToken),hd(i.remoteStore,o)}for(let r of t)i.Ma.has(r)&&(yield Ys(i.localStore,r,!1).then(()=>{Xs(i.remoteStore,r),eo(i,r)}).catch(Yi))}})}function fd(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=kI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vD.bind(null,e),e.Ca.d_=hD.bind(null,e.eventManager),e.Ca.$a=fD.bind(null,e.eventManager),e}function e_(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ED.bind(null,e),e}function kD(n,e,t){let i=$(n);(function(s,o,c){return E(this,null,function*(){try{let l=yield o.getMetadata();if(yield function(b,O){let M=$(b),x=rt(O.createTime);return M.persistence.runTransaction("hasNewerBundle","readonly",B=>M.Gr.getBundleMetadata(B,O.id)).then(B=>!!B&&B.createTime.compareTo(x)>=0)}(s.localStore,l))return yield o.close(),c._completeWith(function(b){return{taskState:"Success",documentsLoaded:b.totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}}(l)),Promise.resolve(new Set);c._updateProgress(DI(l));let u=new sg(l,s.localStore,o.serializer),h=yield o.Ua();for(;h;){let v=yield u.la(h);v&&c._updateProgress(v),h=yield o.Ua()}let g=yield u.complete();return yield fi(s,g.Ia,void 0),yield function(b,O){let M=$(b);return M.persistence.runTransaction("Save bundle","readwrite",x=>M.Gr.saveBundleMetadata(x,O))}(s.localStore,l),c._completeWith(g.progress),Promise.resolve(g.Pa)}catch(l){return vn("SyncEngine",`Loading bundle failed with ${l}`),c._failWith(l),Promise.resolve(new Set)}})})(i,e,t).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}var ug=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return E(this,null,function*(){this.serializer=vc(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,i){return null}Ha(t,i){return null}za(t){return yI(this.persistence,new Uu,t.initialUser,this.serializer)}Ga(t){return new Fu(Lu.Zr,this.serializer)}Wa(t){return new $u}terminate(){return E(this,null,function*(){var t,i;(t=this.gcScheduler)===null||t===void 0||t.stop(),(i=this.indexBackfillerScheduler)===null||i===void 0||i.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var Zu=class n extends ug{constructor(e,t,i){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return E(this,null,function*(){yield Xc(n.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield e_(this.Ja.syncEngine),yield ao(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return yI(this.persistence,new Uu,e.initialUser,this.serializer)}ja(e,t){let i=this.persistence.referenceDelegate.garbageCollector;return new Cm(i,e.asyncQueue,t)}Ha(e,t){let i=new qp(t,this.persistence);return new Bp(e.asyncQueue,i)}Ga(e){let t=$g(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?un.withCacheSize(this.cacheSizeBytes):un.DEFAULT;return new jm(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,CI(),hu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new $u}},dg=class n extends Zu{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return E(this,null,function*(){yield Xc(n.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof Ha&&(this.sharedClientState.syncEngine={no:RD.bind(null,t),ro:DD.bind(null,t),io:MD.bind(null,t),Qi:xD.bind(null,t),eo:SD.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(i=>E(this,null,function*(){yield PD(this.Ja.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=CI();if(!Ha.D(t))throw new L(V.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=$g(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ha(t,e.asyncQueue,i,e.clientId,e.initialUser)}},t_=(()=>{class n{initialize(t,i){return E(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(i),this.remoteStore=this.createRemoteStore(i),this.eventManager=this.createEventManager(i),this.syncEngine=this.createSyncEngine(i,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>sb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=TD.bind(null,this.syncEngine),yield Zm(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new ng}()}createDatastore(t){let i=vc(t.databaseInfo.databaseId),r=function(o){return new Hm(o)}(t.databaseInfo);return function(o,c,l,u){return new Jm(o,c,l,u)}(t.authCredentials,t.appCheckCredentials,r,i)}createRemoteStore(t){return function(r,s,o,c,l){return new Xm(r,s,o,c,l)}(this.localStore,this.datastore,t.asyncQueue,i=>sb(this.syncEngine,i,0),function(){return zu.D()?new zu:new Wm}())}createSyncEngine(t,i){return function(s,o,c,l,u,h,g){let v=new cg(s,o,c,l,u,h);return g&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,i)}terminate(){return E(this,null,function*(){var t,i;yield function(s){return E(this,null,function*(){let o=$(s);U("RemoteStore","RemoteStore shutting down."),o.L_.add(5),yield oo(o),o.k_.shutdown(),o.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(i=this.eventManager)===null||i===void 0||i.terminate()})}}return n.provider={build:()=>new n},n})();function ab(n,e=10240){let t=0;return{read(){return E(this,null,function*(){if(t<n.byteLength){let r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})},cancel(){return E(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var to=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):nt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var hg=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new ft,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.aa)}`))},i=>this.metadata.reject(i))}close(){return this.Xa.cancel()}getMetadata(){return E(this,null,function*(){return this.metadata.promise})}Ua(){return E(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return E(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),i=Number(t);isNaN(i)&&this.ru(`length string (${t}) is not valid number`);let r=yield this.iu(i);return new rg(JSON.parse(r),e.length+i)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return E(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return E(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return E(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var fg=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return E(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new L(V.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(r,s){return E(this,null,function*(){let o=$(r),c={documents:s.map(g=>sc(o.serializer,g))},l=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,Ee.emptyPath(),c,s.length),u=new Map;l.forEach(g=>{let v=Lx(o.serializer,g);u.set(v.key.toString(),v)});let h=[];return s.forEach(g=>{let v=u.get(g.toString());J(!!v),h.push(v)}),h})}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Qi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return E(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{let r=z.fromPath(i);this.mutations.push(new ec(r,this.precondition(r)))}),yield function(i,r){return E(this,null,function*(){let s=$(i),o={writes:r.map(c=>oc(s.serializer,c))};yield s.Mo("Commit",s.serializer.databaseId,Ee.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw K();t=ie.min()}let i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new L(V.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ie.min())?et.exists(!1):et.updateTime(t):et.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ie.min()))throw new L(V.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return et.updateTime(t)}return et.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var pg=class{constructor(e,t,i,r,s){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=r,this.deferred=s,this._u=i.maxAttempts,this.t_=new uc(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>E(this,null,function*(){let e=new fg(this.datastore),t=this.cu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.lu(r)}))}).catch(i=>{this.lu(i)})}))}cu(e){try{let t=this.updateFunction(e);return!mc(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Jb(t)}return!1}};var mg=class{constructor(e,t,i,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=r,this.user=lt.UNAUTHENTICATED,this.clientId=pu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(i,o=>E(this,null,function*(){U("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,o=>(U("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>E(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let i=lo(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}};function xp(n,e){return E(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(r=>E(this,null,function*(){i.isEqual(r)||(yield vI(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function cb(n,e){return E(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield n_(n);U("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>nb(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>nb(e.remoteStore,r)),n._onlineComponents=e})}function n_(n){return E(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield xp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(r){return r.name==="FirebaseError"?r.code===V.FAILED_PRECONDITION||r.code===V.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(t))throw t;vn("Error using user provided cache. Falling back to memory cache: "+t),yield xp(n,new ug)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield xp(n,new ug);return n._offlineComponents})}function pd(n){return E(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield cb(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield cb(n,new t_))),n._onlineComponents})}function VI(n){return n_(n).then(e=>e.persistence)}function i_(n){return n_(n).then(e=>e.localStore)}function FI(n){return pd(n).then(e=>e.remoteStore)}function r_(n){return pd(n).then(e=>e.syncEngine)}function OD(n){return pd(n).then(e=>e.datastore)}function no(n){return E(this,null,function*(){let e=yield pd(n),t=e.eventManager;return t.onListen=pD.bind(null,e.syncEngine),t.onUnlisten=gD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_D.bind(null,e.syncEngine),t})}function ND(n){return n.asyncQueue.enqueue(()=>E(this,null,function*(){let e=yield VI(n),t=yield FI(n);return e.setNetworkEnabled(!0),function(r){let s=$(r);return s.L_.delete(0),wc(s)}(t)}))}function VD(n){return n.asyncQueue.enqueue(()=>E(this,null,function*(){let e=yield VI(n),t=yield FI(n);return e.setNetworkEnabled(!1),function(r){return E(this,null,function*(){let s=$(r);s.L_.add(0),yield oo(s),s.q_.set("Offline")})}(t)}))}function FD(n,e){let t=new ft;return n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(r,s,o){return E(this,null,function*(){try{let c=yield function(u,h){let g=$(u);return g.persistence.runTransaction("read document","readonly",v=>g.localDocuments.getDocument(v,h))}(r,s);c.isFoundDocument()?o.resolve(c):c.isNoDocument()?o.resolve(null):o.reject(new L(V.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){let l=lo(c,`Failed to get document '${s} from cache`);o.reject(l)}})}(yield i_(n),e,t)})),t.promise}function LI(n,e,t={}){let i=new ft;return n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(s,o,c,l,u){let h=new to({next:v=>{h.Za(),o.enqueueAndForget(()=>Kg(s,g));let b=v.docs.has(c);!b&&v.fromCache?u.reject(new L(V.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&v.fromCache&&l&&l.source==="server"?u.reject(new L(V.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(v)},error:v=>u.reject(v)}),g=new dc(so(c.path),h,{includeMetadataChanges:!0,_a:!0});return Hg(s,g)}(yield no(n),n.asyncQueue,e,t,i)})),i.promise}function LD(n,e){let t=new ft;return n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(r,s,o){return E(this,null,function*(){try{let c=yield ju(r,s,!0),l=new Xu(s,c.Ts),u=l.ma(c.documents),h=l.applyChanges(u,!1);o.resolve(h.snapshot)}catch(c){let l=lo(c,`Failed to execute query '${s} against cache`);o.reject(l)}})}(yield i_(n),e,t)})),t.promise}function UI(n,e,t={}){let i=new ft;return n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(s,o,c,l,u){let h=new to({next:v=>{h.Za(),o.enqueueAndForget(()=>Kg(s,g)),v.fromCache&&l.source==="server"?u.reject(new L(V.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(v)},error:v=>u.reject(v)}),g=new dc(c,h,{includeMetadataChanges:!0,_a:!0});return Hg(s,g)}(yield no(n),n.asyncQueue,e,t,i)})),i.promise}function UD(n,e){let t=new to(e);return n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(r,s){$(r).Y_.add(s),s.next()}(yield no(n),t)})),()=>{t.Za(),n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return function(r,s){$(r).Y_.delete(s)}(yield no(n),t)}))}}function jD(n,e,t,i){let r=function(o,c){let l;return l=typeof o=="string"?Xb().encode(o):o,function(h,g){return new hg(h,g)}(function(h,g){if(h instanceof Uint8Array)return ab(h,g);if(h instanceof ArrayBuffer)return ab(new Uint8Array(h),g);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),c)}(t,vc(e));n.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){kD(yield r_(n),r,i)}))}function BD(n,e){return n.asyncQueue.enqueue(()=>E(this,null,function*(){return function(i,r){let s=$(i);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,r))}(yield i_(n),e)}))}function jI(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var lb=new Map;function s_(n,e,t){if(!t)throw new L(V.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function o_(n,e,t,i){if(e===!0&&i===!0)throw new L(V.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function ub(n){if(!z.isDocumentKey(n))throw new L(V.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function db(n){if(z.isDocumentKey(n))throw new L(V.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function md(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":K()}function Ie(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(V.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=md(n);throw new L(V.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function BI(n,e){if(e<=0)throw new L(V.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var ed=class{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new L(V.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(V.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jI((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(V.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Mr=class{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ed({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(V.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(V.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ed(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Dp;switch(i.type){case"firstParty":return new Np(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new L(V.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return E(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let i=lb.get(t);i&&(U("ComponentProvider","Removing Datastore"),lb.delete(t),i.terminate())}(this),Promise.resolve()}};function gd(n,e,t,i={}){var r;let s=(n=Ie(n,Mr))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&vn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let c,l;if(typeof i.mockUserToken=="string")c=i.mockUserToken,l=lt.MOCK_USER;else{c=hl(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new L(V.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new lt(u)}n._authCredentials=new Mp(new fu(c,l))}}var Tt=class n{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Fe=class n{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Un(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Un=class n extends Tt{constructor(e,t,i){super(e,t,so(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Fe(this.firestore,null,new z(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function _d(n,e,...t){if(n=Ae(n),s_("collection","path",e),n instanceof Mr){let i=Ee.fromString(e,...t);return db(i),new Un(n,null,i)}{if(!(n instanceof Fe||n instanceof Un))throw new L(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Ee.fromString(e,...t));return db(i),new Un(n.firestore,null,i)}}function a_(n,e){if(n=Ie(n,Mr),s_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(V.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Tt(n,null,function(i){return new wn(Ee.emptyPath(),i)}(e))}function uo(n,e,...t){if(n=Ae(n),arguments.length===1&&(e=pu.newId()),s_("doc","path",e),n instanceof Mr){let i=Ee.fromString(e,...t);return ub(i),new Fe(n,null,new z(i))}{if(!(n instanceof Fe||n instanceof Un))throw new L(V.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(Ee.fromString(e,...t));return ub(i),new Fe(n.firestore,n instanceof Un?n.converter:null,new z(i))}}function yd(n,e){return n=Ae(n),e=Ae(e),(n instanceof Fe||n instanceof Un)&&(e instanceof Fe||e instanceof Un)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function vd(n,e){return n=Ae(n),e=Ae(e),n instanceof Tt&&e instanceof Tt&&n.firestore===e.firestore&&_c(n._query,e._query)&&n.converter===e.converter}var td=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new uc(this,"async_queue_retry"),this.Vu=()=>{let i=hu();i&&U("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;let t=hu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=hu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new ft;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return E(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Xi(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;let r=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(i);throw nt("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let r=eg.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&K()}verifyOperationInProgress(){}wu(){return E(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function gg(n){return function(t,i){if(typeof t!="object"||t===null)return!1;let r=t;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}var _g=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ft,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var qI=-1,Ke=class extends Mr{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new td,this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return E(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new td(e),this._firestoreClient=void 0,yield e}})}};function $I(n,e){let t=typeof n=="object"?n:fs(),i=typeof n=="string"?n:e||"(default)",r=gl(t,"firestore").getImmediate({identifier:i});if(!r._initialized){let s=zh("firestore");s&&gd(r,...s)}return r}function Ct(n){if(n._terminated)throw new L(V.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||zI(n),n._firestoreClient}function zI(n){var e,t,i;let r=n._freezeSettings(),s=function(c,l,u,h){return new $p(c,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,jI(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,r);n._componentsProvider||!((t=r.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),n._firestoreClient=new mg(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}function c_(n,e){vn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return WI(n,t_.provider,{build:i=>new Zu(i,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function l_(n){return E(this,null,function*(){vn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings();WI(n,t_.provider,{build:t=>new dg(t,e.cacheSizeBytes)})})}function WI(n,e,t){if((n=Ie(n,Ke))._firestoreClient||n._terminated)throw new L(V.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new L(V.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},zI(n)}function u_(n){if(n._initialized&&!n._terminated)throw new L(V.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ft;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>E(this,null,function*(){try{yield function(i){return E(this,null,function*(){if(!qi.D())return Promise.resolve();let r=i+"main";yield qi.delete(r)})}($g(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function d_(n){return function(t){let i=new ft;return t.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return bD(yield r_(t),i)})),i.promise}(Ct(n=Ie(n,Ke)))}function h_(n){return ND(Ct(n=Ie(n,Ke)))}function f_(n){return VD(Ct(n=Ie(n,Ke)))}function p_(n,e){let t=Ct(n=Ie(n,Ke)),i=new _g;return jD(t,n._databaseId,e,i),i}function m_(n,e){return BD(Ct(n=Ie(n,Ke)),e).then(t=>t?new Tt(n,null,t.query):null)}var $n=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(st.fromBase64String(e))}catch(t){throw new L(V.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(st.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var bn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(V.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var di=class{constructor(e){this._methodName=e}};var kr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(V.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(V.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return he(this._lat,e._lat)||he(this._long,e._long)}};var hc=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,e._values)}};var qD=/^__.*__$/,yg=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new En(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ki(e,this.data,t,this.fieldTransforms)}},nd=class{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new En(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function GI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}var id=class n{constructor(e,t,i,r,s,o){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.Ou(e),r}Nu(e){var t;let i=(t=this.path)===null||t===void 0?void 0:t.child(e),r=this.Fu({path:i,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return rd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(GI(this.Cu)&&qD.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},vg=class{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||vc(e)}Qu(e,t,i,r=!1){return new id({Cu:e,methodName:t,qu:i,path:it.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Fr(n){let e=n._freezeSettings(),t=vc(n._databaseId);return new vg(n._databaseId,!!e.ignoreUndefinedProperties,t)}function wd(n,e,t,i,r,s={}){let o=n.Qu(s.merge||s.mergeFields?2:0,e,t,r);y_("Data must be an object, but it was:",o,i);let c=QI(i,o),l,u;if(s.merge)l=new nn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let g of s.mergeFields){let v=Tg(e,g,t);if(!o.contains(v))throw new L(V.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);YI(h,v)||h.push(v)}l=new nn(h),u=o.fieldTransforms.filter(g=>l.covers(g.field))}else l=null,u=o.fieldTransforms;return new yg(new Nt(c),l,u)}var fc=class n extends di{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function HI(n,e,t){return new id({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var wg=class n extends di{_toFieldTransform(e){return new Pr(e.path,new Gi)}isEqual(e){return e instanceof n}},Eg=class n extends di{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=HI(this,e,!0),i=this.Ku.map(s=>Lr(s,t)),r=new li(i);return new Pr(e.path,r)}isEqual(e){return e instanceof n&&Hh(this.Ku,e.Ku)}},bg=class n extends di{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=HI(this,e,!0),i=this.Ku.map(s=>Lr(s,t)),r=new ui(i);return new Pr(e.path,r)}isEqual(e){return e instanceof n&&Hh(this.Ku,e.Ku)}},Ig=class n extends di{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new Hi(e.serializer,$b(e.serializer,this.$u));return new Pr(e.path,t)}isEqual(e){return e instanceof n&&this.$u===e.$u}};function g_(n,e,t,i){let r=n.Qu(1,e,t);y_("Data must be an object, but it was:",r,i);let s=[],o=Nt.empty();Vr(i,(l,u)=>{let h=v_(e,l,t);u=Ae(u);let g=r.Nu(h);if(u instanceof fc)s.push(h);else{let v=Lr(u,g);v!=null&&(s.push(h),o.set(h,v))}});let c=new nn(s);return new nd(o,c,r.fieldTransforms)}function __(n,e,t,i,r,s){let o=n.Qu(1,e,t),c=[Tg(e,i,t)],l=[r];if(s.length%2!=0)throw new L(V.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<s.length;v+=2)c.push(Tg(e,s[v])),l.push(s[v+1]);let u=[],h=Nt.empty();for(let v=c.length-1;v>=0;--v)if(!YI(u,c[v])){let b=c[v],O=l[v];O=Ae(O);let M=o.Nu(b);if(O instanceof fc)u.push(b);else{let x=Lr(O,M);x!=null&&(u.push(b),h.set(b,x))}}let g=new nn(u);return new nd(h,g,o.fieldTransforms)}function KI(n,e,t,i=!1){return Lr(t,n.Qu(i?4:3,e))}function Lr(n,e){if(JI(n=Ae(n)))return y_("Unsupported field value:",e,n),QI(n,e);if(n instanceof di)return function(i,r){if(!GI(r.Cu))throw r.Bu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(i,r){let s=[],o=0;for(let c of i){let l=Lr(c,r.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(i,r){if((i=Ae(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return $b(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=He.fromDate(i);return{timestampValue:Hs(r.serializer,s)}}if(i instanceof He){let s=new He(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Hs(r.serializer,s)}}if(i instanceof kr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof $n)return{bytesValue:Zb(r.serializer,i._byteString)};if(i instanceof Fe){let s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:jg(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof hc)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw c.Bu("VectorValues must only contain numeric values.");return Ug(c.serializer,l)})}}}}}}(i,r);throw r.Bu(`Unsupported field value: ${md(i)}`)}(n,e)}function QI(n,e){let t={};return Cb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vr(n,(i,r)=>{let s=Lr(r,e.Mu(i));s!=null&&(t[i]=s)}),{mapValue:{fields:t}}}function JI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof kr||n instanceof $n||n instanceof Fe||n instanceof di||n instanceof hc)}function y_(n,e,t){if(!JI(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let i=md(t);throw i==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+i)}}function Tg(n,e,t){if((e=Ae(e))instanceof bn)return e._internalPath;if(typeof e=="string")return v_(n,e);throw rd("Field path arguments must be of type string or ",n,!1,void 0,t)}var $D=new RegExp("[~\\*/\\[\\]]");function v_(n,e,t){if(e.search($D)>=0)throw rd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new bn(...e.split("."))._internalPath}catch{throw rd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function rd(n,e,t,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${i}`),o&&(l+=` in document ${r}`),l+=")"),new L(V.INVALID_ARGUMENT,c+n+l)}function YI(n,e){return n.some(t=>t.isEqual(e))}var Or=class{constructor(e,t,i,r,s){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Cg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ed("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Cg=class extends Or{data(){return super.data()}};function Ed(n,e){return typeof e=="string"?v_(n,e):e instanceof bn?e._internalPath:e._delegate._internalPath}function XI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(V.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pc=class{},Nr=class extends pc{};function zn(n,e,...t){let i=[];e instanceof pc&&i.push(e),i=i.concat(t),function(s){let o=s.filter(l=>l instanceof Ag).length,c=s.filter(l=>l instanceof sd).length;if(o>1||o>0&&c>0)throw new L(V.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let r of i)n=r._apply(n);return n}var sd=class n extends Nr{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=this._parse(e);return eT(e._query,t),new Tt(e.firestore,e.converter,nm(e._query,t))}_parse(e){let t=Fr(e.firestore);return function(s,o,c,l,u,h,g){let v;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new L(V.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){fb(g,h);let b=[];for(let O of g)b.push(hb(l,s,O));v={arrayValue:{values:b}}}else v=hb(l,s,g)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||fb(g,h),v=KI(c,o,g,h==="in"||h==="not-in");return _e.create(u,h,v)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function w_(n,e,t){let i=e,r=Ed("where",n);return sd._create(r,i,t)}var Ag=class n extends pc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:xe.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,s){let o=r,c=s.getFlattenedFilters();for(let l of c)eT(o,l),o=nm(o,l)}(e._query,t),new Tt(e.firestore,e.converter,nm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Sg=class n extends Nr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(r,s,o){if(r.startAt!==null)throw new L(V.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new L(V.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Sr(s,o)}(e._query,this._field,this._direction);return new Tt(e.firestore,e.converter,function(r,s){let o=r.explicitOrderBy.concat([s]);return new wn(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}};function E_(n,e="asc"){let t=e,i=Ed("orderBy",n);return Sg._create(i,t)}var od=class n extends Nr{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){return new Tt(e.firestore,e.converter,Tu(e._query,this._limit,this._limitType))}};function b_(n){return BI("limit",n),od._create("limit",n,"F")}function I_(n){return BI("limitToLast",n),od._create("limitToLast",n,"L")}var ad=class n extends Nr{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=ZI(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(r,s){return new wn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,t))}};function T_(...n){return ad._create("startAt",n,!0)}function C_(...n){return ad._create("startAfter",n,!1)}var cd=class n extends Nr{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new n(e,t,i)}_apply(e){let t=ZI(e,this.type,this._docOrFields,this._inclusive);return new Tt(e.firestore,e.converter,function(r,s){return new wn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,t))}};function A_(...n){return cd._create("endBefore",n,!1)}function S_(...n){return cd._create("endAt",n,!0)}function ZI(n,e,t,i){if(t[0]=Ae(t[0]),t[0]instanceof Or)return function(s,o,c,l,u){if(!l)throw new L(V.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);let h=[];for(let g of Us(s))if(g.field.isKeyField())h.push(Ar(o,l.key));else{let v=l.data.field(g.field);if(ud(v))throw new L(V.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(v===null){let b=g.field.canonicalString();throw new L(V.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}h.push(v)}return new Bn(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{let r=Fr(n.firestore);return function(o,c,l,u,h,g){let v=o.explicitOrderBy;if(h.length>v.length)throw new L(V.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let b=[];for(let O=0;O<h.length;O++){let M=h[O];if(v[O].field.isKeyField()){if(typeof M!="string")throw new L(V.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof M}`);if(!Fg(o)&&M.indexOf("/")!==-1)throw new L(V.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${M}' contains a slash.`);let x=o.path.child(Ee.fromString(M));if(!z.isDocumentKey(x))throw new L(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);let B=new z(x);b.push(Ar(c,B))}else{let x=KI(l,u,M);b.push(x)}}return new Bn(b,g)}(n._query,n.firestore._databaseId,r,e,t,i)}}function hb(n,e,t){if(typeof(t=Ae(t))=="string"){if(t==="")throw new L(V.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fg(e)&&t.indexOf("/")!==-1)throw new L(V.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let i=e.path.child(Ee.fromString(t));if(!z.isDocumentKey(i))throw new L(V.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Ar(n,new z(i))}if(t instanceof Fe)return Ar(n,t._key);throw new L(V.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${md(t)}.`)}function fb(n,e){if(!Array.isArray(n)||n.length===0)throw new L(V.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function eT(n,e){let t=function(r,s){for(let o of r)for(let c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(V.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(V.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var io=class{convertValue(e,t="none"){switch(Cr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($i(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw K()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let i={};return Vr(e,(r,s)=>{i[r]=this.convertValue(s,t)}),i}convertVectorValue(e){var t,i,r;let s=(r=(i=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>ze(o.doubleValue));return new hc(s)}convertGeoPoint(e){return new kr(ze(e.latitude),ze(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":let i=Ng(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Ya(e));default:return null}}convertTimestamp(e){let t=ci(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){let i=Ee.fromString(e);J(uI(i));let r=new zi(i.get(1),i.get(3)),s=new z(i.popFirst(5));return r.isEqual(t)||nt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function bd(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}var Rg=class extends io{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};var ai=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},hn=class extends Or{constructor(e,t,i,r,s,o){super(e,t,i,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ji(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let i=this._document.data.field(Ed("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}},ji=class extends hn{data(e={}){return super.data(e)}},In=class{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ai(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new ji(this._firestore,this._userDataWriter,i.key,i,new ai(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(V.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(c=>{let l=new ji(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ai(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new ji(r._firestore,r._userDataWriter,c.doc.key,c.doc,new ai(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter),u=-1,h=-1;return c.type!==0&&(u=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:zD(c.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function zD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K()}}function Id(n,e){return n instanceof hn&&e instanceof hn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof In&&e instanceof In&&n._firestore===e._firestore&&vd(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function R_(n){n=Ie(n,Fe);let e=Ie(n.firestore,Ke);return LI(Ct(e),n._key).then(t=>F_(e,n,t))}var hi=class extends io{constructor(e){super(),this.firestore=e}convertBytes(e){return new $n(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fe(this.firestore,null,t)}};function P_(n){n=Ie(n,Fe);let e=Ie(n.firestore,Ke),t=Ct(e),i=new hi(e);return FD(t,n._key).then(r=>new hn(e,i,n._key,r,new ai(r!==null&&r.hasLocalMutations,!0),n.converter))}function x_(n){n=Ie(n,Fe);let e=Ie(n.firestore,Ke);return LI(Ct(e),n._key,{source:"server"}).then(t=>F_(e,n,t))}function D_(n){n=Ie(n,Tt);let e=Ie(n.firestore,Ke),t=Ct(e),i=new hi(e);return XI(n._query),UI(t,n._query).then(r=>new In(e,i,n,r))}function M_(n){n=Ie(n,Tt);let e=Ie(n.firestore,Ke),t=Ct(e),i=new hi(e);return LD(t,n._query).then(r=>new In(e,i,n,r))}function k_(n){n=Ie(n,Tt);let e=Ie(n.firestore,Ke),t=Ct(e),i=new hi(e);return UI(t,n._query,{source:"server"}).then(r=>new In(e,i,n,r))}function Td(n,e,t){n=Ie(n,Fe);let i=Ie(n.firestore,Ke),r=bd(n.converter,e,t);return ho(i,[wd(Fr(i),"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,et.none())])}function Cd(n,e,t,...i){n=Ie(n,Fe);let r=Ie(n.firestore,Ke),s=Fr(r),o;return o=typeof(e=Ae(e))=="string"||e instanceof bn?__(s,"updateDoc",n._key,e,t,i):g_(s,"updateDoc",n._key,e),ho(r,[o.toMutation(n._key,et.exists(!0))])}function O_(n){return ho(Ie(n.firestore,Ke),[new Qi(n._key,et.none())])}function N_(n,e){let t=Ie(n.firestore,Ke),i=uo(n),r=bd(n.converter,e);return ho(t,[wd(Fr(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,et.exists(!1))]).then(()=>i)}function Ad(n,...e){var t,i,r;n=Ae(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||gg(e[o])||(s=e[o],o++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(gg(e[o])){let g=e[o];e[o]=(t=g.next)===null||t===void 0?void 0:t.bind(g),e[o+1]=(i=g.error)===null||i===void 0?void 0:i.bind(g),e[o+2]=(r=g.complete)===null||r===void 0?void 0:r.bind(g)}let l,u,h;if(n instanceof Fe)u=Ie(n.firestore,Ke),h=so(n._key.path),l={next:g=>{e[o]&&e[o](F_(u,n,g))},error:e[o+1],complete:e[o+2]};else{let g=Ie(n,Tt);u=Ie(g.firestore,Ke),h=g._query;let v=new hi(u);l={next:b=>{e[o]&&e[o](new In(u,v,g,b))},error:e[o+1],complete:e[o+2]},XI(n._query)}return function(v,b,O,M){let x=new to(M),B=new dc(b,x,O);return v.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return Hg(yield no(v),B)})),()=>{x.Za(),v.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return Kg(yield no(v),B)}))}}(Ct(u),h,c,l)}function V_(n,e){return UD(Ct(n=Ie(n,Ke)),gg(e)?e:{next:e})}function ho(n,e){return function(i,r){let s=new ft;return i.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){return yD(yield r_(i),r,s)})),s.promise}(Ct(n),e)}function F_(n,e,t){let i=t.docs.get(e._key),r=new hi(n);return new hn(n,r,e._key,i,new ai(t.hasPendingWrites,t.fromCache),e.converter)}var WD={maxAttempts:5};var ld=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fr(e)}set(e,t,i){this._verifyNotCommitted();let r=Li(e,this._firestore),s=bd(r.converter,t,i),o=wd(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,et.none())),this}update(e,t,i,...r){this._verifyNotCommitted();let s=Li(e,this._firestore),o;return o=typeof(t=Ae(t))=="string"||t instanceof bn?__(this._dataReader,"WriteBatch.update",s._key,t,i,r):g_(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,et.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Li(e,this._firestore);return this._mutations=this._mutations.concat(new Qi(t._key,et.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(V.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Li(n,e){if((n=Ae(n)).firestore!==e)throw new L(V.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var Pg=class extends class{constructor(t,i){this._firestore=t,this._transaction=i,this._dataReader=Fr(t)}get(t){let i=Li(t,this._firestore),r=new Rg(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||s.length!==1)return K();let o=s[0];if(o.isFoundDocument())return new Or(this._firestore,r,o.key,o,i.converter);if(o.isNoDocument())return new Or(this._firestore,r,i._key,null,i.converter);throw K()})}set(t,i,r){let s=Li(t,this._firestore),o=bd(s.converter,i,r),c=wd(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,r);return this._transaction.set(s._key,c),this}update(t,i,r,...s){let o=Li(t,this._firestore),c;return c=typeof(i=Ae(i))=="string"||i instanceof bn?__(this._dataReader,"Transaction.update",o._key,i,r,s):g_(this._dataReader,"Transaction.update",o._key,i),this._transaction.update(o._key,c),this}delete(t){let i=Li(t,this._firestore);return this._transaction.delete(i._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Li(e,this._firestore),i=new hi(this._firestore);return super.get(e).then(r=>new hn(this._firestore,i,t._key,r._document,new ai(!1,!1),t.converter))}};function L_(n,e,t){n=Ie(n,Ke);let i=Object.assign(Object.assign({},WD),t);return function(s){if(s.maxAttempts<1)throw new L(V.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,c){let l=new ft;return s.asyncQueue.enqueueAndForget(()=>E(this,null,function*(){let u=yield OD(s);new pg(s.asyncQueue,u,c,o,l).au()})),l.promise}(Ct(n),r=>e(new Pg(n,r)),i)}function U_(){return new fc("deleteField")}function j_(){return new wg("serverTimestamp")}function B_(...n){return new Eg("arrayUnion",n)}function q_(...n){return new bg("arrayRemove",n)}function $_(n){return new Ig("increment",n)}(function(e,t=!0){(function(r){ro=r})(_l),lr(new mn("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),c=new Ke(new kp(i.getProvider("auth-internal")),new Fp(i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new L(V.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new zi(u.options.projectId,h)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),ht(dE,"4.7.3",e),ht(dE,"4.7.3","esm2017")})();var GD="@firebase/firestore-compat",HD="0.3.38";function Q_(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function tT(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function nT(){if(!Ab())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Sd=class n{constructor(e){this._delegate=e}static fromBase64String(e){return nT(),new n($n.fromBase64String(e))}static fromUint8Array(e){return tT(),new n($n.fromUint8Array(e))}toBase64(){return nT(),this._delegate.toBase64()}toUint8Array(){return tT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function z_(n){return KD(n,["next","error","complete"])}function KD(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let i of e)if(i in t&&typeof t[i]=="function")return!0;return!1}var W_=class{enableIndexedDbPersistence(e,t){return c_(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return l_(e._delegate)}clearIndexedDbPersistence(e){return u_(e._delegate)}},Rd=class{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof zi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&vn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,i={}){gd(this._delegate,e,t,i)}enableNetwork(){return h_(this._delegate)}disableNetwork(){return f_(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,o_("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return d_(this._delegate)}onSnapshotsInSync(e){return V_(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new mo(this,_d(this._delegate,e))}catch(t){throw Bt(t,"collection()","Firestore.collection()")}}doc(e){try{return new Wn(this,uo(this._delegate,e))}catch(t){throw Bt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new qr(this,a_(this._delegate,e))}catch(t){throw Bt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return L_(this._delegate,t=>e(new Pd(this,t)))}batch(){return Ct(this._delegate),new xd(new ld(this._delegate,e=>ho(this._delegate,e)))}loadBundle(e){return p_(this._delegate,e)}namedQuery(e){return m_(this._delegate,e).then(t=>t?new qr(this,t):null)}},fo=class extends io{constructor(e){super(),this.firestore=e}convertBytes(e){return new Sd(new $n(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Wn.forKey(t,this.firestore,null)}};function QD(n){xg(n)}var Pd=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new fo(e)}get(e){let t=Ur(e);return this._delegate.get(t).then(i=>new jr(this._firestore,new hn(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){let r=Ur(e);return i?(Q_("Transaction.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Ur(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Ur(e);return this._delegate.delete(t),this}},xd=class{constructor(e){this._delegate=e}set(e,t,i){let r=Ur(e);return i?(Q_("WriteBatch.set",i),this._delegate.set(r,t,i)):this._delegate.set(r,t),this}update(e,t,i,...r){let s=Ur(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,i,...r),this}delete(e){let t=Ur(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},po=class n{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){let i=new ji(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Br(this._firestore,i),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let i=n.INSTANCES,r=i.get(e);r||(r=new WeakMap,i.set(e,r));let s=r.get(t);return s||(s=new n(e,new fo(e),t),r.set(t,s)),s}};po.INSTANCES=new WeakMap;var Wn=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fo(e)}static forPath(e,t,i){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Fe(t._delegate,i,new z(e)))}static forKey(e,t,i){return new n(t,new Fe(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new mo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new mo(this.firestore,_d(this._delegate,e))}catch(t){throw Bt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ae(e),e instanceof Fe?yd(this._delegate,e):!1}set(e,t){t=Q_("DocumentReference.set",t);try{return t?Td(this._delegate,e,t):Td(this._delegate,e)}catch(i){throw Bt(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return arguments.length===1?Cd(this._delegate,e):Cd(this._delegate,e,t,...i)}catch(r){throw Bt(r,"updateDoc()","DocumentReference.update()")}}delete(){return O_(this._delegate)}onSnapshot(...e){let t=iT(e),i=rT(e,r=>new jr(this.firestore,new hn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return Ad(this._delegate,t,i)}get(e){let t;return e?.source==="cache"?t=P_(this._delegate):e?.source==="server"?t=x_(this._delegate):t=R_(this._delegate),t.then(i=>new jr(this.firestore,new hn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(po.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Bt(n,e,t){return n.message=n.message.replace(e,t),n}function iT(n){for(let e of n)if(typeof e=="object"&&!z_(e))return e;return{}}function rT(n,e){var t,i;let r;return z_(n[0])?r=n[0]:z_(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(e(s))},error:(t=r.error)===null||t===void 0?void 0:t.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var jr=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Wn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Id(this._delegate,e._delegate)}},Br=class extends jr{data(e){let t=this._delegate.data(e);return this._delegate._converter||pb(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},qr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fo(e)}where(e,t,i){try{return new n(this.firestore,zn(this._delegate,w_(e,t,i)))}catch(r){throw Bt(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,zn(this._delegate,E_(e,t)))}catch(i){throw Bt(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,zn(this._delegate,b_(e)))}catch(t){throw Bt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,zn(this._delegate,I_(e)))}catch(t){throw Bt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,zn(this._delegate,T_(...e)))}catch(t){throw Bt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,zn(this._delegate,C_(...e)))}catch(t){throw Bt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,zn(this._delegate,A_(...e)))}catch(t){throw Bt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,zn(this._delegate,S_(...e)))}catch(t){throw Bt(t,"endAt()","Query.endAt()")}}isEqual(e){return vd(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=M_(this._delegate):e?.source==="server"?t=k_(this._delegate):t=D_(this._delegate),t.then(i=>new Ec(this.firestore,new In(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){let t=iT(e),i=rT(e,r=>new Ec(this.firestore,new In(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return Ad(this._delegate,t,i)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(po.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},G_=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Br(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Ec=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new qr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Br(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new G_(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Br(this._firestore,i))})}isEqual(e){return Id(this._delegate,e._delegate)}},mo=class n extends qr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Wn(this.firestore,e):null}doc(e){try{return e===void 0?new Wn(this.firestore,uo(this._delegate)):new Wn(this.firestore,uo(this._delegate,e))}catch(t){throw Bt(t,"doc()","CollectionReference.doc()")}}add(e){return N_(this._delegate,e).then(t=>new Wn(this.firestore,t))}isEqual(e){return yd(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(po.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ur(n){return Ie(n,Fe)}var H_=class n{constructor(...e){this._delegate=new bn(...e)}static documentId(){return new n(it.keyField().canonicalString())}isEqual(e){return e=Ae(e),e instanceof bn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var K_=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=j_();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=U_();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=B_(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=q_(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=$_(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var JD={Firestore:Rd,GeoPoint:kr,Timestamp:He,Blob:Sd,Transaction:Pd,WriteBatch:xd,DocumentReference:Wn,DocumentSnapshot:jr,Query:qr,QueryDocumentSnapshot:Br,QuerySnapshot:Ec,CollectionReference:mo,FieldPath:H_,FieldValue:K_,setLogLevel:QD,CACHE_SIZE_UNLIMITED:qI};function YD(n,e){n.INTERNAL.registerComponent(new mn("firestore-compat",t=>{let i=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(i,r)},"PUBLIC").setServiceProps(Object.assign({},JD)))}function XD(n){YD(n,(e,t)=>new Rd(e,t,new W_)),n.registerVersion(GD,HD)}XD(tt);function ZD(n,e=Zc){return new wt(t=>{let i;return e!=null?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{i?.()}})}function sT(n,e){return ZD(n,e)}function eM(n,e){return sT(n,e).pipe(ts(void 0),tl(),se(t=>{let[i,r]=t;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function X_(n,e){return sT(n,e).pipe(se(t=>({payload:t,type:"query"})))}var Dd=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let i=this.ref.collection(e),{ref:r,query:s}=uT(i,t);return new kd(r,s,this.afs)}snapshotChanges(){return eM(this.ref,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return this.snapshotChanges().pipe(se(({payload:t})=>e.idField?je(Y({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return be(this.ref.get(e)).pipe(yt)}};function Md(n,e){return X_(n,e).pipe(ts(void 0),tl(),se(t=>{let[i,r]=t,s=r.payload.docChanges(),o=s.map(c=>({type:c.type,payload:c}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((c,l)=>{let u=s.find(g=>g.doc.ref.isEqual(c.ref)),h=i?.payload.docs.find(g=>g.ref.isEqual(c.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(c.metadata)||!u&&h&&JSON.stringify(h.metadata)===JSON.stringify(c.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:c}})}),o}))}function oT(n,e,t){return Md(n,t).pipe(es((i,r)=>tM(i,r.map(s=>s.payload),e),[]),tv(),se(i=>i.map(r=>({type:r.type,payload:r}))))}function tM(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=nM(n,i))}),n}function J_(n,e,t,...i){let r=n.slice();return r.splice(e,t,...i),r}function nM(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return J_(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return J_(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return J_(n,e.oldIndex,1);break}return n}function aT(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var kd=class{ref;query;afs;constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=Md(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(se(i=>i.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(ts(void 0),tl(),Kt(([i,r])=>r.length>0||!i),se(([,i])=>i),yt)}auditTrail(e){return this.stateChanges(e).pipe(es((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=aT(e);return oT(this.query,t,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return X_(this.query,this.afs.schedulers.outsideAngular).pipe(se(t=>t.payload.docs.map(i=>e.idField?je(Y({},i.data()),{[e.idField]:i.id}):i.data())),yt)}get(e){return be(this.query.get(e)).pipe(yt)}add(e){return this.ref.add(e)}doc(e){return new Dd(this.ref.doc(e),this.afs)}},Y_=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Md(this.query,this.afs.schedulers.outsideAngular).pipe(yt):Md(this.query,this.afs.schedulers.outsideAngular).pipe(se(t=>t.filter(i=>e.indexOf(i.type)>-1)),Kt(t=>t.length>0),yt)}auditTrail(e){return this.stateChanges(e).pipe(es((t,i)=>[...t,...i],[]))}snapshotChanges(e){let t=aT(e);return oT(this.query,t,this.afs.schedulers.outsideAngular).pipe(yt)}valueChanges(e={}){return X_(this.query,this.afs.schedulers.outsideAngular).pipe(se(i=>i.payload.docs.map(r=>e.idField?Y({[e.idField]:r.id},r.data()):r.data())),yt)}get(e){return be(this.query.get(e)).pipe(yt)}},cT=new te("angularfire2.enableFirestorePersistence"),lT=new te("angularfire2.firestore.persistenceSettings"),iM=new te("angularfire2.firestore.settings"),rM=new te("angularfire2.firestore.use-emulator");function uT(n,e=t=>t){return{query:e(n),ref:n}}var rn=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,i,r,s,o,c,l,u,h,g,v,b,O,M,x,B,H){this.schedulers=l;let F=ri(t,c,i),G=h;g&&vp(F,c,v,O,M,x,b,B),[this.firestore,this.persistenceEnabled$]=ki(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let re=c.runOutsideAngular(()=>F.firestore());if(s&&re.settings(s),G&&re.useEmulator(...G),r&&!Ci(o)){let ee=()=>{try{return be(re.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(C){return typeof console<"u"&&console.warn(C),X(!1)}};return[re,c.runOutsideAngular(ee)]}else return[re,X(!1)]},[s,G,r])}collection(t,i){let r;typeof t=="string"?r=this.firestore.collection(t):r=t;let{ref:s,query:o}=uT(r,i),c=this.schedulers.ngZone.run(()=>s);return new kd(c,o,this)}collectionGroup(t,i){let r=i||(o=>o),s=this.firestore.collectionGroup(t);return new Y_(r(s),this)}doc(t){let i;typeof t=="string"?i=this.firestore.doc(t):i=t;let r=this.schedulers.ngZone.run(()=>i);return new Dd(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(j(kn),j(On,8),j(cT,8),j(iM,8),j(dt),j(Re),j(Wt),j(lT,8),j(rM,8),j(en,8),j(fp,8),j(pp,8),j(mp,8),j(gp,8),j(_p,8),j(yp,8),j(Zt,8))};static \u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),dT=(()=>{class n{constructor(){tt.registerVersion("angularfire",_t.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:cT,useValue:!0},{provide:lT,useValue:t}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[rn]})}return n})();function sM(n,e){if(n&1&&(p(0,"div",10),y(1),m()),n&2){let t=Z();S(),$e(" ",t.errChange," ")}}function oM(n,e){if(n&1&&(p(0,"option",19),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.operateur+"("+t.pays+")")}}function aM(n,e){if(n&1&&(p(0,"option",19),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.operateur+"("+t.pays+")")}}function cM(n,e){if(n&1&&(p(0,"h4"),y(1),m()),n&2){let t=Z();S(),sl("1 ",t.monaieS," = ",t.tauxApplicable,"")}}function lM(n,e){n&1&&(p(0,"div",73)(1,"span",60),y(2,"Loading..."),m()())}function uM(n,e){if(n&1&&(p(0,"tr")(1,"th",74),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td")(8,"span",75),y(9,"Success"),m()()()),n&2){let t=e.$implicit;S(2),de(t.num),S(2),de(t.amount+" "+t.monaieSender),S(2),de(t.amountR+" "+t.monaieRecepteur)}}function dM(n,e){}function hM(n,e){if(n&1&&(p(0,"div",76)(1,"div",77),y(2),m()()),n&2){let t=Z().$implicit;S(2),$e(" ",t.message," ")}}function fM(n,e){if(n&1&&(p(0,"div",78)(1,"div",77),y(2),m()()),n&2){let t=Z().$implicit;S(2),$e(" ",t.message," ")}}function pM(n,e){if(n&1&&ge(0,hM,3,1,"div",76)(1,fM,3,1),n&2){let t=e.$implicit;me(0,t.admin?0:1)}}function mM(n,e){if(n&1&&Xe(0,pM,2,1,null,null,Ye),n&2){let t=Z(2);Ze(t.messages)}}function gM(n,e){if(n&1&&(p(0,"div",76)(1,"div",77),y(2," HI. Comment pouvons nous vous aider? "),m()(),ge(3,dM,0,0)(4,mM,2,0)),n&2){let t=Z();S(3),me(3,t.messages.length==0?3:4)}}function _M(n,e){if(n&1){let t=gt();p(0,"div",79)(1,"h2"),y(2,"Vous devez cr\xE9er un compte avant de lancer la discussion."),m(),p(3,"button",80),ne("click",function(){ye(t);let r=Z();return ve(r.goTo("inscription"))}),y(4,"S'inscrire maintenant"),m()()}}var Z_=(()=>{class n{goTo(t){this.router.navigate(["/"+t])}ngOnInit(){this.getMonaie(),this.getAuth()}constructor(t,i){this.firestore=t,this.Auth=i,this.router=Q(kt),this.send=[{}],this.monaies=[],this.hasUser=!1,this.montantSend=0,this.isAddingTrans=!1,this.msgErr="",this.transferts=[],this.nbreEncour=0,this.nbreSuccess=0,this.nbreEchec=0,this.messages=[],this.errChange=""}getMonaie(){return E(this,null,function*(){this.firestore.collection("devises").get().subscribe(t=>{this.monaies=[],t.forEach(i=>{this.monaies.push({id:i.id,monaie:i.data().monaie,pays:i.data().pays,operateur:i.data().operateur})}),console.log(this.monaies)})})}getAuth(){this.Auth.authState.subscribe(t=>{t?(this.idUser=t?.uid,this.hasUser=!0,this.getTransfert(),this.getMsg()):this.router.navigate(["/acceuil"])})}getTransfert(){this.firestore.collection("transferts").get().subscribe(t=>{let i=0,r="";this.transferts=[],this.nbreEncour=0,this.nbreSuccess=0,this.nbreEchec=0,t.forEach(s=>{i++,s.data().etat=="En cour"&&(r="warning",this.nbreEncour++),s.data().etat=="success"&&(r="success",this.nbreSuccess++),s.data().etat=="echec"&&(r="danger",this.nbreEchec++);let o=this.formatTimestampToDate(s.data().date);this.transferts.push({num:i,id:s.id,etat:s.data().etat,montant:s.data().montant+" => "+s.data().montantRecept,amount:s.data().montant,amountR:s.data().montantRecept,taux:s.data().taux,couleur:r,date:o,telRecepteur:s.data().telRecepteur,nomRecepteur:s.data().nomRecepteur,monaieRecepteur:s.data().monaieRecepteur,monaieSender:s.data().monaieSender})}),console.log(this.transferts)})}formatTimestampToDate(t){if(!t||typeof t.seconds!="number")throw new Error("Le timestamp est invalide.");let i=new Date(t.seconds*1e3),r=String(i.getDate()).padStart(2,"0"),s=String(i.getMonth()+1).padStart(2,"0"),o=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0");return`${r}/${s}/${o} ${c}:${l}`}sendMsg(){this.msg&&this.idUser&&this.firestore.collection("messages").add({message:this.msg,date:new Date,idUser:this.idUser,admin:!1}).then(()=>{this.msg=""})}getMsg(){return E(this,null,function*(){yield this.firestore.collection("messages",t=>t.where("idUser","==",this.idUser)).snapshotChanges(["added"]).subscribe(t=>{this.messages=[],t.forEach(i=>{this.messages.push({message:i.payload.doc.data().message,date:i.payload.doc.data().date,idUser:i.payload.doc.data().idUser,admin:i.payload.doc.data().admin}),this.messages=this.sortMessagesByDate(this.messages)})})})}sortMessagesByDate(t){return t.sort((i,r)=>{let s=i.date,o=r.date;return s<o?-1:s>o?1:0})}getNameOfMonaie(t){return E(this,null,function*(){try{let i=yield this.firestore.collection("devises").doc(t).get().toPromise();return i.exists?i.data().monaie:null}catch(i){return console.error("Erreur lors de la r\xE9cup\xE9ration de la monnaie :",i),null}})}calcul(){return E(this,null,function*(){if(this.errChange="",this.opSend)if(this.opRe)try{if(this.monaieS=yield this.getNameOfMonaie(this.opSend),this.monaieR=yield this.getNameOfMonaie(this.opRe),!this.monaieS||!this.monaieR){this.errChange="Impossible de r\xE9cup\xE9rer les informations des devises.";return}console.log("Monnaie \xE9metteur :",this.monaieS),console.log("Monnaie r\xE9cepteur :",this.monaieR);let t=yield this.firestore.collection("tauxChange",i=>i.where("sender","==",this.opSend).where("reciever","==",this.opRe)).get().toPromise();t.empty?(this.errChange="Aucun taux de change trouv\xE9 pour ces devises.",this.tauxApplicable=null):(t.forEach(i=>{this.tauxApplicable=i.data().taux,this.montantMinim=i.data().montantMinim,console.log(this.montantMinim)}),console.log("Taux applicable :",this.tauxApplicable))}catch(t){console.error("Erreur lors de la r\xE9cup\xE9ration des donn\xE9es :",t),this.errChange="Une erreur est survenue lors de la r\xE9cup\xE9ration des donn\xE9es."}else{this.errChange="Choisissez le recepteur";return}else{this.errChange="Choisissez l'envoyeur";return}})}applyTaux(){this.montantRec="",this.errChange="",this.montantMinim="",this.calcul().then(()=>{this.opSend&&this.tauxApplicable&&this.montantSend&&(console.log("hello"),this.montantSend>=this.montantMinim?this.montantRec=this.montantSend*this.tauxApplicable:this.errChange="Le montant minimum est de "+this.montantMinim)})}swapp(){this.idUser?(alert("initiez le transfert a partir de votre tableau de bord"),this.goTo("dash")):(alert("Connectez-vous avant de commencer un transfert"),this.goTo("inscription"))}static{this.\u0275fac=function(i){return new(i||n)(le(rn),le(en))}}static{this.\u0275cmp=De({type:n,selectors:[["app-acceuil"]],standalone:!0,features:[Me],decls:226,vars:10,consts:[[1,"content"],[1,"titre","mb-4"],[1,"text-center","ww-x"],[1,"bi","bi-gift-fill","text-success","mx-4"],[1,"text-warning"],[1,"w-50","text-center","w-100"],[1,"btn","btn-info",3,"click"],["id","transfert",1,"p-4","center"],[1,"card","card-change"],[1,"card-body","border-0"],["role","alert",1,"alert","alert-primary"],[1,"table","border-0","table-dark","table-striped"],[1,"border-0"],[1,"text-center"],["scope","col"],[1,"col-sm-10"],["type","text","value","0",1,"form-control",3,"ngModelChange","input","ngModel"],["type","number","value","0","disabled","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"p-2","text-white"],[1,"card-footer","border-0"],[1,"btn","btn-warning","w-100",3,"click"],[1,"second","p-4","text-light"],[1,"w-100","process"],[1,"card","bg-dark","shadow-lg"],[1,"text-light"],[1,"third","p-4","text-center","text-light"],[1,"container-about","center"],[1,"l"],[1,"btn","btn-info"],[1,"four","p-4","text-light","mt-4"],[1,"table","table-warning","table-striped","mt-4"],[1,"tete-tab"],[1,"p-4","text-light","mt-4"],["id","accordionExample",1,"accordion","my-4"],[1,"accordion-item"],["id","headingOne",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseOne","aria-expanded","true","aria-controls","collapseOne",1,"accordion-button"],["id","collapseOne","aria-labelledby","headingOne","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse","show"],[1,"accordion-body"],["id","headingTwo",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseTwo","aria-expanded","false","aria-controls","collapseTwo",1,"accordion-button","collapsed"],["id","collapseTwo","aria-labelledby","headingTwo","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse"],["id","headingThree",1,"accordion-header"],["type","button","data-bs-toggle","collapse","data-bs-target","#collapseThree","aria-expanded","false","aria-controls","collapseThree",1,"accordion-button","collapsed"],["id","collapseThree","aria-labelledby","headingThree","data-bs-parent","#accordionExample",1,"accordion-collapse","collapse"],[1,"p-4","text-light"],[1,"container-avis","mt-4"],[1,"card","bg-dark","p-4","text-light","shadow-lg"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"text-info"],[1,"note","d-flex"],[1,"bi","bi-star-fill","text-warning"],[1,"bi","bi-star-fill","text-white"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"message","center","flex-column"],[1,"fs-1","center","text-info","position-relative"],[1,"bi","bi-chat-dots-fill"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-danger","text-small"],[1,"visually-hidden"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","modal-xl","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-info"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body","position-relative","bg-dark"],[1,"modal-footer","w-100"],[1,"msb-reply","w-100","position-relative"],["placeholder","What's on your mind...",3,"ngModelChange","ngModel"],[1,"btn","btn-success",3,"click","disabled"],[1,"bi","bi-send-fill"],["role","status",1,"spinner-grow","text-info"],["scope","row"],[1,"badge","bg-success"],[1,"receiver"],[1,"msg-box"],[1,"sender"],[1,"w-100","p-5","text-white"],["data-bs-dismiss","modal",1,"btn","btn-success",3,"click"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),W(4,"i",3),p(5,"span",4),y(6,"Profitez"),m(),p(7,"span"),y(8," de nos tarifs exceptionnels"),m()(),p(9,"h1"),y(10,"\xC9change de devises fiable et s\xE9curis\xE9"),m(),p(11,"p",5),y(12,"N\xE9gociez le yuan chinois, l'USD, l'EURO, le NAIRA, le XOF, le XAF, le GHS et tous les types de devises \xE9lectroniques en utilisant notre plateforme de trading."),m(),p(13,"button",6),ne("click",function(){return r.goTo("dash")}),y(14,"Commencer"),m()()(),p(15,"div",7)(16,"div",8)(17,"div",9),ge(18,sM,2,1,"div",10),p(19,"table",11)(20,"thead",12)(21,"tr",13)(22,"th",14),y(23,"Envoyer"),m(),p(24,"th",14),y(25,"Recevoir"),m()()(),p(26,"tbody",12)(27,"tr")(28,"td")(29,"div",15)(30,"input",16),ce("ngModelChange",function(o){return ae(r.montantSend,o)||(r.montantSend=o),o}),ne("input",function(){return r.applyTaux()}),m()()(),p(31,"td")(32,"div",15)(33,"input",17),ce("ngModelChange",function(o){return ae(r.montantRec,o)||(r.montantRec=o),o}),m()()()(),p(34,"tr")(35,"td")(36,"div",15)(37,"select",18),ce("ngModelChange",function(o){return ae(r.opSend,o)||(r.opSend=o),o}),ne("change",function(){return r.applyTaux()}),Xe(38,oM,2,2,"option",19,Ye),m()()(),p(40,"td")(41,"div",15)(42,"select",18),ce("ngModelChange",function(o){return ae(r.opRe,o)||(r.opRe=o),o}),ne("change",function(){return r.applyTaux()}),Xe(43,aM,2,2,"option",19,Ye),m()()()()()(),p(45,"div",20),ge(46,cM,2,2,"h4")(47,lM,3,0),m()(),p(48,"div",21)(49,"button",22),ne("click",function(){return r.swapp()}),y(50,"Swapp currency"),m()()()(),p(51,"div",23)(52,"div",13)(53,"h3",4),y(54,"Processus"),m(),p(55,"h1"),y(56,"Comment ca marche?"),m(),p(57,"p"),y(58,"S\xE9lectionnez ce que vous avez (Envoyer) et s\xE9lectionnez l'autre devise dont vous avez besoin en \xE9change (Recevoir)."),m()(),p(59,"div",24)(60,"div",25)(61,"h2",4),y(62,"Gagnez de l'argent"),m(),p(63,"p",26),y(64," Gagnez de l'argent en recommandant \xE0 davantage de clients d'utiliser nos services en partageant votre lien de parrainage. "),m()(),p(65,"div",25)(66,"h2",4),y(67,"Commencez le transfert"),m(),p(68,"p",26),y(69," Commencez \xE0 trader avec votre devise locale. "),m()(),p(70,"div",25)(71,"h2",4),y(72,"Devise de d\xE9p\xF4t"),m(),p(73,"p",26),y(74," Make payment to the provided account. "),m()()()(),p(75,"div",27)(76,"div",13)(77,"h3",4),y(78,"En savoir plus"),m(),p(79,"h2"),y(80,"A propos de Nous"),m(),p(81,"p"),y(82,"Notre mission et notre vision sont de fournir \xE0 nos utilisateurs la meilleure exp\xE9rience de change possible."),m()(),p(83,"div",28)(84,"div",29)(85,"p",13),y(86," Bienvenue \xE0 kscXchange, votre source de confiance pour les services de change mondiaux. Nous sommes une \xE9quipe d\u2019experts en devises exp\xE9riment\xE9s et comp\xE9tents qui se consacrent \xE0 vous aider \xE0 tirer le meilleur parti de votre argent. Que vous cherchiez \xE0 acheter, vendre ou simplement \xE9changer des devises, nous avons les solutions adapt\xE9es \xE0 vos besoins. Chez kscXchange, nous comprenons que le taux de change fluctue quotidiennement, nous veillons donc \xE0 surveiller le march\xE9 pour que vous n'ayez pas \xE0 le faire. Notre \xE9quipe d\u2019experts en devises est disponible pour fournir un service client exceptionnel et des conseils adapt\xE9s \xE0 votre situation individuelle. Avec nous, vous pouvez toujours compter sur d\u2019excellents tarifs et un service rapide et efficace. Nous proposons une large gamme de devises, notamment le Yuan, l'USD, l'Euro, le Naira, le XOF, le GBP, l'IDR, d'autres monnaies \xE9lectroniques telles que Paypal, PerfectMoney Usdt, et nous en ajoutons toujours d'autres. Notre objectif est d'offrir \xE0 nos clients la meilleure exp\xE9rience de change possible. Merci d'avoir choisi kscXchange\xA0! Au plaisir de vous servir ! "),m(),p(87,"button",30),y(88,"Commencer"),m()()()(),p(89,"div",31)(90,"div",13)(91,"h3",4),y(92,"Transfert"),m(),p(93,"h1"),y(94,"Nos derniers transferts"),m(),p(95,"p"),y(96,"Voici les tranfers les plus recent!"),m()(),p(97,"table",32)(98,"thead")(99,"tr",33)(100,"th",14),y(101,"#"),m(),p(102,"th",14),y(103,"Envoyer"),m(),p(104,"th",14),y(105,"Recevoir"),m(),p(106,"th",14),y(107,"Status"),m()()(),p(108,"tbody"),Xe(109,uM,10,3,"tr",null,Ye),m()()(),p(111,"div",34)(112,"div",13)(113,"h3",4),y(114,"FaQs"),m(),p(115,"h1"),y(116,"Questions fr\xE9quentes"),m(),p(117,"p"),y(118,"Qu\u2019aimerez-vous savoir ? Obtenez quelques r\xE9ponses ci-dessous\xA0!"),m()(),p(119,"div",28)(120,"div",35)(121,"div",36)(122,"h2",37)(123,"button",38),y(124," Puis-je utiliser le compte d'une autre personne pour effectuer des paiements ou des d\xE9p\xF4ts sur votre plateforme "),m()(),p(125,"div",39)(126,"div",40),y(127," Gardez toujours cela \xE0 l\u2019esprit, nous n\u2019acceptons aucun tiers sur aucun de nos comptes, votre nom sur notre plateforme doit correspondre au nom que vous utilisez pour nous envoyer de l\u2019argent. Mais nous pouvons vous aider \xE0 payer/approvisionner un autre compte en votre nom, cela ne va pas \xE0 l'encontre de nos conditions de services. Par exemple, nous pouvons financer le compte de votre (vos) fournisseur(s) s'il ne figure pas \xE0 votre nom. Vous avez encore besoin de pr\xE9cisions suppl\xE9mentaires, contactez-nous au support en direct ou par courrier. "),m()()(),p(128,"div",36)(129,"h2",41)(130,"button",42),y(131," \xCAtes-vous disponible pour r\xE9pondre aux questions \xE0 tout moment ? "),m()(),p(132,"div",43)(133,"div",40)(134,"p"),y(135," Nous fournissons une assistance 24h/24 et 7j/7 et une mise \xE0 jour rapide de vos transactions. "),m()()()(),p(136,"div",36)(137,"h2",44)(138,"button",45),y(139," Quel est le processus pour conna\xEEtre l'\xE9quivalent d'une devise dans une autre ? "),m()(),p(140,"div",46)(141,"div",40)(142,"p"),y(143," Le taux est calcul\xE9 en fonction des mouvements du march\xE9, utilisez le calculateur de swap de devises pour v\xE9rifier le taux en s\xE9lectionnant votre devise d'envoi et votre devise de r\xE9ception, tapez le montant que vous souhaitez \xE9changer, le calculateur vous donnera l'\xE9quivalent dans une autre devise. Ne vous inqui\xE9tez pas, nous mettons \xE0 jour les tarifs de temps en temps pour vous offrir le meilleur tarif jamais vu. "),m()()()()()()(),p(144,"div",47)(145,"div",13)(146,"h3",4),y(147,"AVIS"),m(),p(148,"h1"),y(149,"Que disent nos clients?"),m(),p(150,"p"),y(151,"Aimez-vous ce que vous voyez ? Un essai vous \xE9patera s\xFBrement\xA0!"),m()(),p(152,"div",48)(153,"div",49)(154,"div",50)(155,"h5",51),y(156,"MASSOH"),m(),p(157,"small"),y(158,"3 days ago"),m()(),p(159,"div")(160,"span",52),y(161,"Custumer"),m()(),p(162,"p",51),y(163,"J'adore ce service. Vous etes efficace et le service client est juste wahouu."),m(),p(164,"div",53),W(165,"i",54)(166,"i",54)(167,"i",54)(168,"i",54)(169,"i",55),m()(),p(170,"div",49)(171,"div",50)(172,"h5",51),y(173,"MASSOH"),m(),p(174,"small"),y(175,"3 days ago"),m()(),p(176,"div")(177,"span",52),y(178,"Custumer"),m()(),p(179,"p",51),y(180,"J'adore ce service. Vous etes efficace et le service client est juste wahouu."),m(),p(181,"div",53),W(182,"i",54)(183,"i",54)(184,"i",54)(185,"i",54)(186,"i",55),m()(),p(187,"div",49)(188,"div",50)(189,"h5",51),y(190,"MASSOH"),m(),p(191,"small"),y(192,"3 days ago"),m()(),p(193,"div")(194,"span",52),y(195,"Custumer"),m()(),p(196,"p",51),y(197,"J'adore ce service. Vous etes efficace et le service client est juste wahouu."),m(),p(198,"div",53),W(199,"i",54)(200,"i",54)(201,"i",55)(202,"i",55)(203,"i",55),m()()()(),p(204,"div",56)(205,"div",57),W(206,"i",58),p(207,"span",59),y(208),p(209,"span",60),y(210,"unread messages"),m()()()()(),p(211,"div",61)(212,"div",62)(213,"div",63)(214,"div",64)(215,"h5",65),y(216,"Hello! besoin d'aide? Discutons \u{1F603}"),m(),W(217,"button",66),m(),p(218,"div",67),ge(219,gM,5,1)(220,_M,5,0),m(),p(221,"div",68)(222,"div",69)(223,"textarea",70),ce("ngModelChange",function(o){return ae(r.msg,o)||(r.msg=o),o}),m(),p(224,"button",71),ne("click",function(){return r.sendMsg()}),W(225,"i",72),m()()()()()()),i&2&&(S(18),me(18,r.errChange!=""?18:-1),S(12),oe("ngModel",r.montantSend),S(3),oe("ngModel",r.montantRec),S(4),oe("ngModel",r.opSend),S(),Ze(r.monaies),S(4),oe("ngModel",r.opRe),S(),Ze(r.monaies),S(3),me(46,r.monaieR&&r.tauxApplicable&&r.monaieR?46:47),S(63),Ze(r.transferts),S(99),$e(" ",r.messages.length," "),S(11),me(219,r.idUser?219:220),S(4),oe("ngModel",r.msg),S(),bt("disabled",!r.hasUser))},dependencies:[ln,xi,Di,zt,Ma,Mn,cn,Xt],styles:['@charset "UTF-8";.content[_ngcontent-%COMP%]{background-color:#12222b;padding-bottom:300px;min-height:100vh;position:relative}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:40vh;display:flex;flex-direction:column;justify-content:center;align-items:center}.ww-x[_ngcontent-%COMP%]{width:80%}.table[_ngcontent-%COMP%]{box-shadow:0 0 250px #000;border-radius:10px}.card-change[_ngcontent-%COMP%]{width:60%;box-shadow:0 0 250px #000;text-align:center;padding:4rem 2rem;background:transparent}table[_ngcontent-%COMP%]{background:transparent;border:none}.first[_ngcontent-%COMP%]{background-color:#e3f2fd;display:flex;flex-direction:row;justify-content:space-around;align-items:center;width:40%}.logo-currency[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:contain;border-radius:50%}.around[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;align-items:center}.img-back[_ngcontent-%COMP%]{width:80%}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.flex-column[_ngcontent-%COMP%]{flex-direction:column}.process[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:2rem;flex-wrap:wrap}.process[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:350px;min-height:180px;transition:all ease-in-out .3s;cursor:pointer;padding:2rem;margin:.8rem}.process[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.four[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.four[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:80%}.container-about[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:justify}.container-about[_ngcontent-%COMP%]   .l[_ngcontent-%COMP%], .container-about[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]{width:80%}.text-small[_ngcontent-%COMP%]{font-size:15px}.container-faq[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;min-height:70vh}.container-faq[_ngcontent-%COMP%]   .l[_ngcontent-%COMP%]{width:50%}.container-faq[_ngcontent-%COMP%]   .r[_ngcontent-%COMP%]{width:35%}.container-faq[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:400px;height:400px;object-fit:contain;border-radius:50%}.container-avis[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center}.container-avis[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:300px;min-height:200px}.container-avis[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#bbb}.message[_ngcontent-%COMP%]{cursor:pointer;position:fixed;top:80vh;right:2rem;padding:.2rem;width:5rem;height:5rem;background:#edeff01a;transition:.5s all ease-in-out;border-radius:10px}.message[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.modal-body[_ngcontent-%COMP%]{height:70vh;overflow-y:auto}.receiver[_ngcontent-%COMP%]{display:flex;margin:1rem 0rem;cursor:pointer}.receiver[_ngcontent-%COMP%]   .logo-person[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:50%;background:#bbb}.receiver[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%]{background:#bbb;max-width:80%;padding:.5rem;border-radius:10px;margin-left:1rem;margin-bottom:.5rem}.sender[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:flex-end;cursor:pointer}.sender[_ngcontent-%COMP%]   .logo-person[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:50%;background:#bbb}.sender[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%]{background:#bbb;max-width:80%;padding:.5rem;border-radius:10px;margin-right:1rem;margin-bottom:.5rem}.msb-reply[_ngcontent-%COMP%]{display:flex}.msb-reply[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;font-size:13px;border:0;padding:10px 15px;resize:none;height:60px;background:0 0}@media (max-width: 768px){.ww-x[_ngcontent-%COMP%]{width:80%}.table[_ngcontent-%COMP%]{box-shadow:0 0 250px #000;border-radius:10px}.card-change[_ngcontent-%COMP%]{width:95%;box-shadow:0 0 250px #000;text-align:center;padding:1rem;background:transparent}table[_ngcontent-%COMP%]{background:transparent;border:none}.first[_ngcontent-%COMP%]{background-color:#e3f2fd;display:flex;flex-direction:row;justify-content:space-around;align-items:center;width:40%}.logo-currency[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:contain;border-radius:50%}.around[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;align-items:center}.img-back[_ngcontent-%COMP%]{width:80%}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.process[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;padding:2rem;flex-wrap:wrap}.process[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:350px;min-height:180px;transition:all ease-in-out .3s;cursor:pointer;padding:2rem;margin:.8rem}.process[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.four[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.four[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:80%}.container-about[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:justify}.container-about[_ngcontent-%COMP%]   .l[_ngcontent-%COMP%], .container-about[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]{width:90%}.container-faq[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;min-height:70vh}.container-faq[_ngcontent-%COMP%]   .l[_ngcontent-%COMP%]{width:90%}.container-faq[_ngcontent-%COMP%]   .r[_ngcontent-%COMP%]{width:35%}.container-faq[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:400px;height:400px;object-fit:contain;border-radius:50%}.container-avis[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;flex-wrap:wrap}.container-avis[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:80%;height:auto;margin:1rem}.container-avis[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#bbb}}']})}}return n})();var hT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-contact"]],standalone:!0,features:[Me],decls:26,vars:0,consts:[[1,"content"],[1,"titre"],[1,"p-4","content-connect"],[1,"grid","align__item"],[1,"register"],["xmlns","http://www.w3.org/2000/svg","width","56","height","84","viewBox","77.7 214.9 274.7 412",1,"site__logo"],["id","a","x1","0%","y1","0%","y2","0%"],["offset","0%","stop-color","#8ceabb"],["offset","100%","stop-color","#378f7b"],["fill","url(#a)","d","M215 214.9c-83.6 123.5-137.3 200.8-137.3 275.9 0 75.2 61.4 136.1 137.3 136.1s137.3-60.9 137.3-136.1c0-75.1-53.7-152.4-137.3-275.9z"],["action","","method","post",1,"form"],[1,"form__field"],["type","text","placeholder","Votre nom"],["type","email","placeholder","Votre adresse mail"],["type","text","placeholder","Sujet"],["placeholder","message"],["type","submit","value","Envoyer"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Contactez nous"),m()(),p(4,"div",2)(5,"div",3)(6,"div",4),ss(),p(7,"svg",5)(8,"defs")(9,"linearGradient",6),W(10,"stop",7)(11,"stop",8),m()(),W(12,"path",9),m(),os(),p(13,"h2"),y(14,"Ecrivez nous"),m(),p(15,"form",10)(16,"div",11),W(17,"input",12),m(),p(18,"div",11),W(19,"input",13),m(),p(20,"div",11),W(21,"input",14),m(),p(22,"div",11),W(23,"textarea",15),m(),p(24,"div",11),W(25,"input",16),m()()()()()())},styles:[`.content[_ngcontent-%COMP%]{background-color:#12222b;min-height:100vh;padding-bottom:300px}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:40vh;display:flex;justify-content:center;align-items:center}html[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{background-color:#354152;color:#7e8ba3;font:300 1rem/1.5 Helvetica Neue,sans-serif;margin:0;min-height:100%}.align[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.align__item--start[_ngcontent-%COMP%]{align-self:flex-start}.align__item--end[_ngcontent-%COMP%]{align-self:flex-end}.site__logo[_ngcontent-%COMP%]{margin-bottom:2rem}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:0;font:inherit}input[_ngcontent-%COMP%]::placeholder, textarea[_ngcontent-%COMP%]::placeholder{color:#7e8ba3}.form__field[_ngcontent-%COMP%]{margin-bottom:1rem}.form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{outline:0;padding:.5rem 1rem}.form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   textarea[type=email][_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   textarea[type=text][_ngcontent-%COMP%]{width:100%}.grid[_ngcontent-%COMP%]{margin:0 auto;max-width:25rem;width:100%}h2[_ngcontent-%COMP%]{font-size:2.75rem;font-weight:100;margin:0 0 1rem;text-transform:uppercase;color:#fff}svg[_ngcontent-%COMP%]{height:auto;max-width:100%;vertical-align:middle}a[_ngcontent-%COMP%]{color:#f3f5f7;cursor:pointer;text-decoration:underline}.register[_ngcontent-%COMP%]{box-shadow:0 0 250px #000;text-align:center;padding:4rem 2rem}.register[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;resize:none;color:#e6e6e6}.register[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border:1px solid #242c37;border-radius:999px;background-color:transparent;text-align:center;color:#e6e6e6}.register[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=email][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=text][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=password][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:1.5rem;background-position:1rem 50%}.register[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=email][_ngcontent-%COMP%]{background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#242c37"><path d="M256.017 273.436l-205.17-170.029h410.904l-205.734 170.029zm-.034 55.462l-205.983-170.654v250.349h412v-249.94l-206.017 170.245z"/></svg>')}.register[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=password][_ngcontent-%COMP%]{background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#242c37"><path d="M195.334 223.333h-50v-62.666c0-61.022 49.645-110.667 110.666-110.667 61.022 0 110.667 49.645 110.667 110.667v62.666h-50v-62.666c0-33.452-27.215-60.667-60.667-60.667-33.451 0-60.666 27.215-60.666 60.667v62.666zm208.666 30v208.667h-296v-208.667h296zm-121 87.667c0-14.912-12.088-27-27-27s-27 12.088-27 27c0 7.811 3.317 14.844 8.619 19.773 4.385 4.075 6.881 9.8 6.881 15.785v22.942h23v-22.941c0-5.989 2.494-11.708 6.881-15.785 5.302-4.93 8.619-11.963 8.619-19.774z"/></svg>')}.register[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=text][_ngcontent-%COMP%]{background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#242c37"><path d="M195.334 223.333h-50v-62.666c0-61.022 49.645-110.667 110.666-110.667 61.022 0 110.667 49.645 110.667 110.667v62.666h-50v-62.666c0-33.452-27.215-60.667-60.667-60.667-33.451 0-60.666 27.215-60.666 60.667v62.666zm208.666 30v208.667h-296v-208.667h296zm-121 87.667c0-14.912-12.088-27-27-27s-27 12.088-27 27c0 7.811 3.317 14.844 8.619 19.773 4.385 4.075 6.881 9.8 6.881 15.785v22.942h23v-22.941c0-5.989 2.494-11.708 6.881-15.785 5.302-4.93 8.619-11.963 8.619-19.774z"/></svg>')}.register[_ngcontent-%COMP%]   input[type=submit][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   textarea[type=submit][_ngcontent-%COMP%]{background-image:linear-gradient(160deg,#8ceae5,#378f7b);color:#fff;margin-bottom:6rem;width:100%}@media (max-width: 768px){.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:20vh;display:flex;justify-content:center;align-items:center}}`]})}}return n})();var fT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-propos"]],standalone:!0,features:[Me],decls:2,vars:0,template:function(i,r){i&1&&(p(0,"p"),y(1,"propos works!"),m())}})}}return n})();function yM(n,e){if(n&1&&(p(0,"tr")(1,"td"),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td"),y(8),m()()),n&2){let t=e.$implicit;S(2),de(t.slNo),S(2),de(t.currency),S(2),de(t.sellRate),S(2),de(t.buyRate)}}var pT=(()=>{class n{constructor(){this.CurrencyRate=[{slNo:1,currency:"Alipay (Chinese Yuan)",sellRate:0,buyRate:6.87},{slNo:2,currency:"Nigerian Naira",sellRate:1684.68201,buyRate:1550},{slNo:3,currency:"Paypal Usd",sellRate:1.15,buyRate:.8},{slNo:4,currency:"Cote D'ivore (F CFA)",sellRate:651.56454,buyRate:624},{slNo:5,currency:"Tether TRC20 USDT",sellRate:1,buyRate:1},{slNo:6,currency:"Perfect Money USD",sellRate:1.1,buyRate:.9},{slNo:7,currency:"Mtn Mobile Money (Cameroon)",sellRate:659.65809,buyRate:620},{slNo:8,currency:"Ghana Bank (Cedi)",sellRate:18.32851,buyRate:15.5},{slNo:9,currency:"Tether BEP20 USDT",sellRate:1.039,buyRate:.9},{slNo:10,currency:"Benin Republic (XOF)",sellRate:685.57104,buyRate:609},{slNo:11,currency:"Tmoney (Togo)",sellRate:625.65159,buyRate:618},{slNo:12,currency:"Zambian Kwacha",sellRate:33.30357,buyRate:20},{slNo:13,currency:"Congolese Franc",sellRate:3272.59762,buyRate:2380},{slNo:14,currency:"GIMACPAY",sellRate:750,buyRate:650},{slNo:15,currency:"Cameroon Bank (XAF)",sellRate:663.12675,buyRate:650},{slNo:16,currency:"Cote d'ivoire Bank (XOF)",sellRate:651.56454,buyRate:630},{slNo:17,currency:"Indian Rupee",sellRate:0,buyRate:84},{slNo:18,currency:"Orange Money (Cameroon)",sellRate:663.12675,buyRate:630},{slNo:19,currency:"Burkina Faso (F CFA)",sellRate:651.56454,buyRate:624},{slNo:20,currency:"Senegal (F CFA)",sellRate:651.56454,buyRate:624},{slNo:21,currency:"Mali (F CFA)",sellRate:651.56454,buyRate:624},{slNo:22,currency:"Moov (Togo)",sellRate:625.65159,buyRate:618},{slNo:23,currency:"Pi",sellRate:3.02083,buyRate:2.51129},{slNo:24,currency:"Nigerian Naira (bulk)",sellRate:1657.47681,buyRate:1500},{slNo:25,currency:"Sierra Leonean Leon (Orange Money)",sellRate:25153.97013,buyRate:23300}]}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-taux"]],standalone:!0,features:[Me],decls:19,vars:0,consts:[[1,"content"],[1,"titre"],[1,"my-4","p-4"],[1,"table","table-dark","table-striped"],["scope","col"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Taux de change"),m()(),p(4,"div",2)(5,"table",3)(6,"thead")(7,"tr")(8,"th",4),y(9,"#"),m(),p(10,"th",4),y(11,"Devise"),m(),p(12,"th",4),y(13,"Taux de vente"),m(),p(14,"th",4),y(15,"Taux d'achat"),m()()(),p(16,"tbody"),Xe(17,yM,9,4,"tr",null,Ye),m()()()()),i&2&&(S(17),Ze(r.CurrencyRate))},styles:[".content[_ngcontent-%COMP%]{padding-bottom:300px;background-color:#12222b;min-height:100vh}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:40vh;display:flex;justify-content:center;align-items:center}@media (max-width: 768px){.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:20vh;display:flex;justify-content:center;align-items:center}}"]})}}return n})();var mT=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-faq"]],standalone:!0,features:[Me],decls:10,vars:0,consts:[[1,"content"],[1,"receipt-header","center","back"],["src","../../assets/logo ksc xchange t.png","alt","",1,"img-logo"],[1,"receipt-body","back"],[1,"footer","back"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1),W(2,"img",2),p(3,"h1"),y(4,"Re\xE7u de Transfert"),m(),p(5,"p"),y(6,"Merci pour votre confiance"),m()(),W(7,"div",3),p(8,"div",4),y(9," Ce re\xE7u est g\xE9n\xE9r\xE9 automatiquement et peut \xEAtre utilis\xE9 comme preuve de votre transaction. "),m()())},styles:[".center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.back[_ngcontent-%COMP%]{background:#ddfafa}.img-logo[_ngcontent-%COMP%]{width:10rem;height:5rem;object-fit:contain}"]})}}return n})();var gT=function(n){let e=[],t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},vM=function(n){let e=[],t=0,i=0;for(;t<n.length;){let r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){let s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){let s=n[t++],o=n[t++],c=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},_T={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){let s=n[r],o=r+1<n.length,c=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,h=s>>2,g=(s&3)<<4|c>>4,v=(c&15)<<2|u>>6,b=u&63;l||(b=64,o||(v=64)),i.push(t[h],t[g],t[v],t[b])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(gT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vM(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){let s=t[n.charAt(r++)],c=r<n.length?t[n.charAt(r)]:0;++r;let u=r<n.length?t[n.charAt(r)]:64;++r;let g=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||c==null||u==null||g==null)throw new t0;let v=s<<2|c>>4;if(i.push(v),u!==64){let b=c<<4&240|u>>2;if(i.push(b),g!==64){let O=u<<6&192|g;i.push(O)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},t0=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},wM=function(n){let e=gT(n);return _T.encodeByteArray(e,!0)},i0=function(n){return wM(n).replace(/\./g,"")},r0=function(n){try{return _T.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function EM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var bM=()=>EM().__FIREBASE_DEFAULTS__,IM=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},TM=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&r0(n[1]);return e&&JSON.parse(e)},CM=()=>{try{return bM()||IM()||TM()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var yT=n=>{var e;return(e=CM())===null||e===void 0?void 0:e[`_${n}`]};function Tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function vT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())}function wT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ET(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function IT(){try{return typeof indexedDB=="object"}catch{return!1}}function TT(){return new Promise((n,e)=>{try{let t=!0,i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var AM="FirebaseError",Gn=class n extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=AM,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,pi.prototype.create)}},pi=class{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){let i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?SM(s,i):"Error",c=`${this.serviceName}: ${o} (${r}).`;return new Gn(r,c,i)}};function SM(n,e){return n.replace(RM,(t,i)=>{let r=e[i];return r!=null?String(r):`<${i}?>`})}var RM=/\{\$([^}]+)}/g;function s0(n){let e=[];for(let[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function CT(n,e){let t=new n0(n,e);return t.subscribe.bind(t)}var n0=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");PM(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=e0),r.error===void 0&&(r.error=e0),r.complete===void 0&&(r.complete=e0);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function PM(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function e0(){}var a4=4*60*60*1e3;function _o(n){return n&&n._delegate?n._delegate:n}var mi=class{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var xM=[],Ve=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Ve||{}),DM={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},MM=Ve.INFO,kM={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},OM=(n,e,...t)=>{if(e<n.logLevel)return;let i=new Date().toISOString(),r=kM[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},yo=class{constructor(e){this.name=e,this._logLevel=MM,this._logHandler=OM,this._userLogHandler=null,xM.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}};var a0=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VM(t)){let i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}};function VM(n){let e=n.getComponent();return e?.type==="VERSION"}var c0="@firebase/app",AT="0.10.17";var gi=new yo("@firebase/app"),FM="@firebase/app-compat",LM="@firebase/analytics-compat",UM="@firebase/analytics",jM="@firebase/app-check-compat",BM="@firebase/app-check",qM="@firebase/auth",$M="@firebase/auth-compat",zM="@firebase/database",WM="@firebase/data-connect",GM="@firebase/database-compat",HM="@firebase/functions",KM="@firebase/functions-compat",QM="@firebase/installations",JM="@firebase/installations-compat",YM="@firebase/messaging",XM="@firebase/messaging-compat",ZM="@firebase/performance",ek="@firebase/performance-compat",tk="@firebase/remote-config",nk="@firebase/remote-config-compat",ik="@firebase/storage",rk="@firebase/storage-compat",sk="@firebase/firestore",ok="@firebase/vertexai",ak="@firebase/firestore-compat",ck="firebase",lk="11.1.0";var uk={[c0]:"fire-core",[FM]:"fire-core-compat",[UM]:"fire-analytics",[LM]:"fire-analytics-compat",[BM]:"fire-app-check",[jM]:"fire-app-check-compat",[qM]:"fire-auth",[$M]:"fire-auth-compat",[zM]:"fire-rtdb",[WM]:"fire-data-connect",[GM]:"fire-rtdb-compat",[HM]:"fire-fn",[KM]:"fire-fn-compat",[QM]:"fire-iid",[JM]:"fire-iid-compat",[YM]:"fire-fcm",[XM]:"fire-fcm-compat",[ZM]:"fire-perf",[ek]:"fire-perf-compat",[tk]:"fire-rc",[nk]:"fire-rc-compat",[ik]:"fire-gcs",[rk]:"fire-gcs-compat",[sk]:"fire-fst",[ak]:"fire-fst-compat",[ok]:"fire-vertex","fire-js":"fire-js",[ck]:"fire-js-all"};var dk=new Map,hk=new Map,ST=new Map;function RT(n,e){try{n.container.addComponent(e)}catch(t){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function wo(n){let e=n.name;if(ST.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;ST.set(e,n);for(let t of dk.values())RT(t,n);for(let t of hk.values())RT(t,n);return!0}function Eo(n){return n.settings!==void 0}var fk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},d0=new pi("app","Firebase",fk);var Od=lk;function vo(n,e,t){var i;let r=(i=uk[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);let s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let c=[`Unable to register library "${r}" with version "${e}":`];s&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(c.join(" "));return}wo(new mi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var pk="firebase-heartbeat-database",mk=1,bc="firebase-heartbeat-store",o0=null;function MT(){return o0||(o0=Tv(pk,mk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bc)}catch(t){console.warn(t)}}}}).catch(n=>{throw d0.create("idb-open",{originalErrorMessage:n.message})})),o0}function gk(n){return E(this,null,function*(){try{let t=(yield MT()).transaction(bc),i=yield t.objectStore(bc).get(kT(n));return yield t.done,i}catch(e){if(e instanceof Gn)gi.warn(e.message);else{let t=d0.create("idb-get",{originalErrorMessage:e?.message});gi.warn(t.message)}}})}function PT(n,e){return E(this,null,function*(){try{let i=(yield MT()).transaction(bc,"readwrite");yield i.objectStore(bc).put(e,kT(n)),yield i.done}catch(t){if(t instanceof Gn)gi.warn(t.message);else{let i=d0.create("idb-set",{originalErrorMessage:t?.message});gi.warn(i.message)}}})}function kT(n){return`${n.name}!${n.options.appId}`}var _k=1024,yk=30*24*60*60*1e3,l0=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new u0(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){return E(this,null,function*(){var e,t;try{let r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=xT();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let c=new Date(o.date).valueOf();return Date.now()-c<=yk}),this._storage.overwrite(this._heartbeatsCache))}catch(i){gi.warn(i)}})}getHeartbeatsHeader(){return E(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=xT(),{heartbeatsToSend:i,unsentEntries:r}=vk(this._heartbeatsCache.heartbeats),s=i0(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return gi.warn(t),""}})}};function xT(){return new Date().toISOString().substring(0,10)}function vk(n,e=_k){let t=[],i=n.slice();for(let r of n){let s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),DT(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),DT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}var u0=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return E(this,null,function*(){return IT()?TT().then(()=>!0).catch(()=>!1):!1})}read(){return E(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield gk(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return E(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return PT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return E(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let r=yield this.read();return PT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return})}};function DT(n){return i0(JSON.stringify({version:2,heartbeats:n})).length}function wk(n){wo(new mi("platform-logger",e=>new a0(e),"PRIVATE")),wo(new mi("heartbeat",e=>new l0(e),"PRIVATE")),vo(c0,AT,n),vo(c0,AT,"esm2017"),vo("fire-js","")}wk("");function BT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var qT=BT,$T=new pi("auth","Firebase",BT());var Ld=new yo("@firebase/auth");function Ek(n,...e){Ld.logLevel<=Ve.WARN&&Ld.warn(`Auth (${Od}): ${n}`,...e)}function Vd(n,...e){Ld.logLevel<=Ve.ERROR&&Ld.error(`Auth (${Od}): ${n}`,...e)}function OT(n,...e){throw I0(n,...e)}function b0(n,...e){return I0(n,...e)}function zT(n,e,t){let i=Object.assign(Object.assign({},qT()),{[e]:t});return new pi("auth","Firebase",i).create(e,{appName:n.name})}function Fd(n){return zT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function I0(n,...e){if(typeof n!="string"){let t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return $T.create(n,...e)}function Se(n,e,...t){if(!n)throw I0(e,...t)}function Ic(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Vd(e),new Error(e)}function Ud(n,e){n||Ic(e)}function bk(){return NT()==="http:"||NT()==="https:"}function NT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Ik(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bk()||ET()||"connection"in navigator)?navigator.onLine:!0}function Tk(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var zr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ud(t>e,"Short delay should be less than long delay!"),this.isMobile=vT()||bT()}get(){return Ik()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ck(n,e){Ud(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var jd=class{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ic("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ic("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ic("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Ak={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Sk=new zr(3e4,6e4);function WT(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function zd(s,o,c,l){return E(this,arguments,function*(n,e,t,i,r={}){return GT(n,r,()=>E(this,null,function*(){let u={},h={};i&&(e==="GET"?h=i:u={body:JSON.stringify(i)});let g=s0(Object.assign({key:n.config.apiKey},h)).slice(1),v=yield n._getAdditionalHeaders();v["Content-Type"]="application/json",n.languageCode&&(v["X-Firebase-Locale"]=n.languageCode);let b=Object.assign({method:e,headers:v},u);return wT()||(b.referrerPolicy="no-referrer"),jd.fetch()(HT(n,n.config.apiHost,t,g),b)}))})}function GT(n,e,t){return E(this,null,function*(){n._canInitEmulator=!1;let i=Object.assign(Object.assign({},Ak),e);try{let r=new p0(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();let o=yield s.json();if("needConfirmation"in o)throw Nd(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[l,u]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nd(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Nd(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw Nd(n,"user-disabled",o);let h=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw zT(n,h,u);OT(n,h)}}catch(r){if(r instanceof Gn)throw r;OT(n,"network-request-failed",{message:String(r)})}})}function HT(n,e,t,i){let r=`${e}${t}?${i}`;return n.config.emulator?Ck(n.config,r):`${n.config.apiScheme}://${r}`}var p0=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(b0(this.auth,"network-request-failed")),Sk.get())})}};function Nd(n,e,t){let i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);let r=b0(n,e,i);return r.customData._tokenResponse=t,r}function Rk(n,e){return E(this,null,function*(){return zd(n,"POST","/v1/accounts:delete",e)})}function KT(n,e){return E(this,null,function*(){return zd(n,"POST","/v1/accounts:lookup",e)})}function Tc(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function QT(n,e=!1){return E(this,null,function*(){let t=_o(n),i=yield t.getIdToken(e),r=JT(i);Se(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");let s=typeof r.firebase=="object"?r.firebase:void 0,o=s?.sign_in_provider;return{claims:r,token:i,authTime:Tc(h0(r.auth_time)),issuedAtTime:Tc(h0(r.iat)),expirationTime:Tc(h0(r.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function h0(n){return Number(n)*1e3}function JT(n){let[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Vd("JWT malformed, contained fewer than 3 sections"),null;try{let r=r0(t);return r?JSON.parse(r):(Vd("Failed to decode base64 JWT payload"),null)}catch(r){return Vd("Caught error parsing JWT payload as JSON",r?.toString()),null}}function VT(n){let e=JT(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function m0(n,e,t=!1){return E(this,null,function*(){if(t)return e;try{return yield e}catch(i){throw i instanceof Gn&&Pk(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})}function Pk({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var g0=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;let r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>E(this,null,function*(){yield this.iteration()}),t)}iteration(){return E(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ac=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tc(this.lastLoginAt),this.creationTime=Tc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Bd(n){return E(this,null,function*(){var e;let t=n.auth,i=yield n.getIdToken(),r=yield m0(n,KT(t,{idToken:i}));Se(r?.users.length,t,"internal-error");let s=r.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?XT(s.providerUserInfo):[],c=xk(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!c?.length,h=l?u:!1,g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Ac(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,g)})}function YT(n){return E(this,null,function*(){let e=_o(n);yield Bd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function xk(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function XT(n){return n.map(e=>{var{providerId:t}=e,i=xh(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}function Dk(n,e){return E(this,null,function*(){let t=yield GT(n,{},()=>E(this,null,function*(){let i=s0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=HT(n,r,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",jd.fetch()(o,{method:"POST",headers:c,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Mk(n,e){return E(this,null,function*(){return zd(n,"POST","/v2/accounts:revokeToken",WT(n,e))})}var Cc=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):VT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");let t=VT(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return E(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return E(this,null,function*(){let{accessToken:i,refreshToken:r,expiresIn:s}=yield Dk(e,t);this.updateTokensAndExpiration(i,r,Number(s))})}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){let{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new n;return i&&(Se(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Se(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Se(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ic("not implemented")}};function er(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Sc=class n{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=xh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new g0(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ac(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return E(this,null,function*(){let t=yield m0(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return QT(this,e)}reload(){return YT(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return E(this,null,function*(){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield Bd(this)),yield this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)})}delete(){return E(this,null,function*(){if(Eo(this.auth.app))return Promise.reject(Fd(this.auth));let e=yield this.getIdToken();return yield m0(this,Rk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,c,l,u,h;let g=(i=t.displayName)!==null&&i!==void 0?i:void 0,v=(r=t.email)!==null&&r!==void 0?r:void 0,b=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,O=(o=t.photoURL)!==null&&o!==void 0?o:void 0,M=(c=t.tenantId)!==null&&c!==void 0?c:void 0,x=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,B=(u=t.createdAt)!==null&&u!==void 0?u:void 0,H=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:F,emailVerified:G,isAnonymous:re,providerData:ee,stsTokenManager:C}=t;Se(F&&C,e,"internal-error");let w=Cc.fromJSON(this.name,C);Se(typeof F=="string",e,"internal-error"),er(g,e.name),er(v,e.name),Se(typeof G=="boolean",e,"internal-error"),Se(typeof re=="boolean",e,"internal-error"),er(b,e.name),er(O,e.name),er(M,e.name),er(x,e.name),er(B,e.name),er(H,e.name);let I=new n({uid:F,auth:e,email:v,emailVerified:G,displayName:g,isAnonymous:re,photoURL:O,phoneNumber:b,tenantId:M,stsTokenManager:w,createdAt:B,lastLoginAt:H});return ee&&Array.isArray(ee)&&(I.providerData=ee.map(A=>Object.assign({},A))),x&&(I._redirectEventId=x),I}static _fromIdTokenResponse(e,t,i=!1){return E(this,null,function*(){let r=new Cc;r.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield Bd(s),s})}static _fromGetAccountInfoResponse(e,t,i){return E(this,null,function*(){let r=t.users[0];Se(r.localId!==void 0,"internal-error");let s=r.providerUserInfo!==void 0?XT(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!s?.length,c=new Cc;c.updateFromIdToken(i);let l=new n({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Ac(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!s?.length};return Object.assign(l,u),l})}};var FT=new Map;function $r(n){Ud(n instanceof Function,"Expected a class definition");let e=FT.get(n);return e?(Ud(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,FT.set(n,e),e)}var kk=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return E(this,null,function*(){return!0})}_set(t,i){return E(this,null,function*(){this.storage[t]=i})}_get(t){return E(this,null,function*(){let i=this.storage[t];return i===void 0?null:i})}_remove(t){return E(this,null,function*(){delete this.storage[t]})}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})(),_0=kk;function f0(n,e,t){return`firebase:${n}:${e}:${t}`}var qd=class n{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;let{config:r,name:s}=this.auth;this.fullUserKey=f0(this.userKey,r.apiKey,s),this.fullPersistenceKey=f0("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return E(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Sc._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return E(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return E(this,null,function*(){if(!t.length)return new n($r(_0),e,i);let r=(yield Promise.all(t.map(u=>E(this,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),s=r[0]||$r(_0),o=f0(i,e.config.apiKey,e.name),c=null;for(let u of t)try{let h=yield u._get(o);if(h){let g=Sc._fromJSON(e,h);u!==s&&(c=g),s=u;break}}catch{}let l=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,i):(s=l[0],c&&(yield s._set(o,c.toJSON())),yield Promise.all(t.map(u=>E(this,null,function*(){if(u!==s)try{yield u._remove(o)}catch{}}))),new n(s,e,i))})}};function LT(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Fk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ok(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uk(e))return"Blackberry";if(jk(e))return"Webos";if(Nk(e))return"Safari";if((e.includes("chrome/")||Vk(e))&&!e.includes("edge/"))return"Chrome";if(Lk(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if(i?.length===2)return i[1]}return"Other"}function Ok(n=Tn()){return/firefox\//i.test(n)}function Nk(n=Tn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vk(n=Tn()){return/crios\//i.test(n)}function Fk(n=Tn()){return/iemobile/i.test(n)}function Lk(n=Tn()){return/android/i.test(n)}function Uk(n=Tn()){return/blackberry/i.test(n)}function jk(n=Tn()){return/webos/i.test(n)}function ZT(n,e=[]){let t;switch(n){case"Browser":t=LT(Tn());break;case"Worker":t=`${LT(Tn())}-${n}`;break;default:t=n}let i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Od}/${i}`}var y0=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let i=s=>new Promise((o,c)=>{try{let l=e(s);o(l)}catch(l){c(l)}});i.onAbort=t,this.queue.push(i);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){return E(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let i of this.queue)yield i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(let r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})}};function Bk(t){return E(this,arguments,function*(n,e={}){return zd(n,"GET","/v2/passwordPolicy",WT(n,e))})}var qk=6,v0=class{constructor(e){var t,i,r,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:qk,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var w0=class{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $d(this),this.idTokenSubscription=new $d(this),this.beforeStateQueue=new y0(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$T,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$r(t)),this._initializationPromise=this.queue(()=>E(this,null,function*(){var i,r;if(!this._deleted&&(this.persistenceManager=yield qd.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return E(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return E(this,null,function*(){try{let t=yield KT(this,{idToken:e}),i=yield Sc._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return E(this,null,function*(){var t;if(Eo(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}let i=yield this.assertedPersistence.getCurrentUser(),r=i,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=r?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!o||o===c)&&l?.user&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)})}tryRedirectSignIn(e){return E(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return E(this,null,function*(){try{yield Bd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Tk()}_delete(){return E(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return E(this,null,function*(){if(Eo(this.app))return Promise.reject(Fd(this));let t=e?_o(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return E(this,null,function*(){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>E(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return E(this,null,function*(){return Eo(this.app)?Promise.reject(Fd(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Eo(this.app)?Promise.reject(Fd(this)):this.queue(()=>E(this,null,function*(){yield this.assertedPersistence.setPersistence($r(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return E(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return E(this,null,function*(){let e=yield Bk(this),t=new v0(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new pi("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let i=this.onAuthStateChanged(()=>{i(),e()},t)}})}revokeAccessToken(e){return E(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),yield Mk(this,i)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return E(this,null,function*(){let i=yield this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return E(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&$r(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=yield qd.create(this,[$r(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return E(this,null,function*(){var t,i;return this._isInitialized&&(yield this.queue(()=>E(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return E(this,null,function*(){if(e===this.currentUser)return this.queue(()=>E(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{let l=e.addObserver(t);return()=>{o=!0,l()}}}directlySetCurrentUser(e){return E(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return E(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let i=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();i&&(t["X-Firebase-Client"]=i);let r=yield this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t})}_getAppCheckToken(){return E(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Ek(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function $k(n){return _o(n)}var $d=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=CT(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var zk={loadJS(){return E(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Wk(n){zk=n}function Gk(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Hk(n,e){let t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map($r);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}function T0(n,e,t,i){return _o(n).onIdTokenChanged(e,t,i)}var U4=Gk("rcb"),j4=new zr(3e4,6e4);var B4=new zr(2e3,1e4);var q4=10*60*1e3;var $4=new zr(3e4,6e4);var z4=new zr(5e3,15e3);var W4=encodeURIComponent("fac");var UT="@firebase/auth",jT="1.8.1";var E0=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return E(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function Kk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Qk(n){wo(new mi("auth",(e,{options:t})=>{let i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=i.options;Se(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});let l={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZT(n)},u=new w0(i,r,s,l);return Hk(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),wo(new mi("auth-internal",e=>{let t=$k(e.getProvider("auth").getImmediate());return(i=>new E0(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),vo(UT,jT,Kk(n)),vo(UT,jT,"esm2017")}var Jk=5*60,G4=yT("authIdTokenMaxAge")||Jk;function Yk(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Wk({loadJS(n){return new Promise((e,t)=>{let i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{let s=b0("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",Yk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Qk("Browser");function eC(n){return new wt(function(e){var t=T0(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var tC="auth",Wr=class{constructor(e){return e}},Rc=class{constructor(){return ka(tC)}};var C0=new te("angularfire2.auth-instances");function KO(n,e){let t=Yl(tC,n,e);return t&&new Wr(t)}function QO(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Wr(i)}}var JO={provide:Rc,deps:[[new Et,C0]]},YO={provide:Wr,useFactory:KO,deps:[[new Et,C0],ii]},XO=(()=>{class n{constructor(){ht("angularfire",_t.full,"auth")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[YO,JO]})}return n})();function nC(n,...e){return{ngModule:XO,providers:[{provide:C0,useFactory:QO(n),multi:!0,deps:[Re,ei,Wt,gr,[new Et,Zt],...e]}]}}var iC=_n(eC,!0);var rC=_n(Kh,!0);var sC=_n(Xh,!0);var oC=_n(Qh,!0);var aC=_n(Yh,!0);var cC=_n(Jh,!0);var bo=(()=>{class n{register(t,i,r){let s=rC(this.firebaseAuth,t,i).then(o=>cC(o.user,{displayName:r}));return be(s)}login(t,i){let r=oC(this.firebaseAuth,t,i).then(()=>{});return be(r)}logOut(){let t=aC(this.firebaseAuth);return be(t)}constructor(){this.firebaseAuth=Q(Wr),this.user$=iC(this.firebaseAuth),this.currentUserSig=hv(void 0)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ZO=n=>({disabled:n});function eN(n,e){n&1&&(p(0,"div",17)(1,"span",20),y(2,"Loading..."),m()())}var lC=(()=>{class n{constructor(){this.router=Q(kt),this.statusLoader="invisible",this.authService=Q(bo),this.messageAlert="",this.colorAlert="",this.email="",this.password="",this.loading=!1,this.etat=""}ngOnInit(){this.idUser=this.authService.currentUserSig()?.id,this.idUser&&(this.messageAlert="Connectez vous pour ajouter vos chansons")}goTo(t){this.router.navigate(["/"+t])}connect(){this.controlPass()=="valide"?this.email&&this.password?(this.statusLoader="",this.loading=!0,this.etat="disabled",this.authService.login(this.email,this.password).subscribe({next:()=>{this.router.navigate(["/dash"]),this.statusLoader="invisible",this.loading=!1},error:i=>{this.messageAlert="Email ou mot de passe incorrect",this.colorAlert="alert-danger",this.statusLoader="invisible",this.loading=!1,this.etat=""}})):(this.messageAlert="Veillez remplir toutes les informations",this.colorAlert="alert-warning"):(this.messageAlert="Entrer une adresse mail valide",this.colorAlert="alert-warning")}controlPass(){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(this.email)?"valide":(this.errEmail="Veuillez entrer une adresse email valide.",console.log("valide"),"error")}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-connection"]],standalone:!0,features:[Me],decls:31,vars:10,consts:[[1,"content"],[1,"titre"],[1,"p-4","content-connect"],[1,"grid","align__item"],[1,"register"],["xmlns","http://www.w3.org/2000/svg","width","56","height","84","viewBox","77.7 214.9 274.7 412",1,"site__logo"],["id","a","x1","0%","y1","0%","y2","0%"],["offset","0%","stop-color","#8ceabb"],["offset","100%","stop-color","#378f7b"],["fill","url(#a)","d","M215 214.9c-83.6 123.5-137.3 200.8-137.3 275.9 0 75.2 61.4 136.1 137.3 136.1s137.3-60.9 137.3-136.1c0-75.1-53.7-152.4-137.3-275.9z"],["role","alert"],[1,"form"],[1,"form__field"],["type","email","placeholder","info@mailaddress.com",3,"ngModelChange","ngModel"],["type","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"ngModelChange","ngModel"],[1,"text-warning","mb-2"],["type","button","value","Connection",3,"click","ngClass"],["role","status",1,"spinner-border","spinner-border-sm","mx-1","text-warning"],[1,"text-white"],[1,"text-info",3,"click"],[1,"visually-hidden"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Connectez Vous"),m()(),p(4,"div",2)(5,"div",3)(6,"div",4),ss(),p(7,"svg",5)(8,"defs")(9,"linearGradient",6),W(10,"stop",7)(11,"stop",8),m()(),W(12,"path",9),m(),os(),p(13,"h2"),y(14,"Connection"),m(),p(15,"div",10),y(16),m(),p(17,"div",11)(18,"div",12)(19,"input",13),ce("ngModelChange",function(o){return ae(r.email,o)||(r.email=o),o}),m()(),p(20,"div",12)(21,"input",14),ce("ngModelChange",function(o){return ae(r.password,o)||(r.password=o),o}),m()(),p(22,"a",15),y(23,"Mot de passe oubli\xE9?"),m(),p(24,"div",12)(25,"input",16),ne("click",function(){return r.connect()}),m(),ge(26,eN,3,0,"div",17),m()(),p(27,"p",18),y(28,"Vous n'avez pas de compte? "),p(29,"a",19),ne("click",function(){return r.goTo("inscription")}),y(30,"Inscrivez vous vous"),m()()()()()()),i&2&&(S(15),ni("alert ",r.colorAlert," mt-2"),S(),$e(" ",r.messageAlert," "),S(3),oe("ngModel",r.email),S(2),oe("ngModel",r.password),S(4),bt("ngClass",gv(8,ZO,r.loading)),S(),me(26,r.loading?26:-1))},dependencies:[ln,zt,cn,Xt,wv],styles:[`.content[_ngcontent-%COMP%]{background-color:#12222b;min-height:100vh;padding-bottom:300px}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:40vh;display:flex;justify-content:center;align-items:center}html[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{background-color:#354152;color:#7e8ba3;font:300 1rem/1.5 Helvetica Neue,sans-serif;margin:0;min-height:100%}.align[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.align__item--start[_ngcontent-%COMP%]{align-self:flex-start}.align__item--end[_ngcontent-%COMP%]{align-self:flex-end}.site__logo[_ngcontent-%COMP%]{margin-bottom:2rem}input[_ngcontent-%COMP%]{border:0;font:inherit}input[_ngcontent-%COMP%]::placeholder{color:#7e8ba3}.form__field[_ngcontent-%COMP%]{margin-bottom:1rem}.form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{outline:0;padding:.5rem 1rem}.form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .form[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:100%}.grid[_ngcontent-%COMP%]{margin:0 auto;max-width:25rem;width:100%}h2[_ngcontent-%COMP%]{font-size:2.75rem;font-weight:100;margin:0 0 1rem;text-transform:uppercase;color:#fff}svg[_ngcontent-%COMP%]{height:auto;max-width:100%;vertical-align:middle}a[_ngcontent-%COMP%]{color:#f3f5f7;cursor:pointer;text-decoration:underline}.register[_ngcontent-%COMP%]{box-shadow:0 0 250px #000;text-align:center;padding:4rem 2rem}.register[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid #242c37;border-radius:999px;background-color:transparent;color:#e6e6e6}.register[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .register[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:1.5rem;background-position:1rem 50%}.register[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]{background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#242c37"><path d="M256.017 273.436l-205.17-170.029h410.904l-205.734 170.029zm-.034 55.462l-205.983-170.654v250.349h412v-249.94l-206.017 170.245z"/></svg>')}.register[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{background-image:url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="#242c37"><path d="M195.334 223.333h-50v-62.666c0-61.022 49.645-110.667 110.666-110.667 61.022 0 110.667 49.645 110.667 110.667v62.666h-50v-62.666c0-33.452-27.215-60.667-60.667-60.667-33.451 0-60.666 27.215-60.666 60.667v62.666zm208.666 30v208.667h-296v-208.667h296zm-121 87.667c0-14.912-12.088-27-27-27s-27 12.088-27 27c0 7.811 3.317 14.844 8.619 19.773 4.385 4.075 6.881 9.8 6.881 15.785v22.942h23v-22.941c0-5.989 2.494-11.708 6.881-15.785 5.302-4.93 8.619-11.963 8.619-19.774z"/></svg>')}.register[_ngcontent-%COMP%]   input[type=button][_ngcontent-%COMP%]{background-image:linear-gradient(160deg,#8ceae5,#378f7b);color:#fff;margin-bottom:6rem;width:100%}`]})}}return n})();var yC="firebasestorage.googleapis.com",vC="storageBucket",tN=2*60*1e3,nN=10*60*1e3,iN=1e3;var Qe=class n extends pl{constructor(e,t,i=0){super(A0(e),`Firebase Storage: ${t} (${A0(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return A0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},We=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(We||{});function A0(n){return"storage/"+n}function O0(){let n="An unknown error occurred, please check the error payload for server response.";return new Qe(We.UNKNOWN,n)}function rN(n){return new Qe(We.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function sN(n){return new Qe(We.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function oN(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Qe(We.UNAUTHENTICATED,n)}function aN(){return new Qe(We.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function cN(n){return new Qe(We.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function wC(){return new Qe(We.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function EC(){return new Qe(We.CANCELED,"User canceled the upload/download.")}function lN(n){return new Qe(We.INVALID_URL,"Invalid URL '"+n+"'.")}function uN(n){return new Qe(We.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function dN(){return new Qe(We.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+vC+"' property when initializing the app?")}function bC(){return new Qe(We.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function hN(){return new Qe(We.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function fN(){return new Qe(We.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function pN(n){return new Qe(We.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Gr(n){return new Qe(We.INVALID_ARGUMENT,n)}function IC(){return new Qe(We.APP_DELETED,"The Firebase app was deleted.")}function N0(n){return new Qe(We.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function xc(n,e){return new Qe(We.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Pc(n){throw new Qe(We.INTERNAL_ERROR,"Internal error: "+n)}var qt=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(i.path==="")return i;throw uN(e)}static makeFromUrl(e,t){let i=null,r="([A-Za-z0-9.\\-_]+)";function s(G){G.path.charAt(G.path.length-1)==="/"&&(G.path_=G.path_.slice(0,-1))}let o="(/(.*))?$",c=new RegExp("^gs://"+r+o,"i"),l={bucket:1,path:3};function u(G){G.path_=decodeURIComponent(G.path)}let h="v[A-Za-z0-9_]+",g=t.replace(/[.]/g,"\\."),v="(/([^?#]*).*)?$",b=new RegExp(`^https?://${g}/${h}/b/${r}/o${v}`,"i"),O={bucket:1,path:3},M=t===yC?"(?:storage.googleapis.com|storage.cloud.google.com)":t,x="([^?#]*)",B=new RegExp(`^https?://${M}/${r}/${x}`,"i"),F=[{regex:c,indices:l,postModify:s},{regex:b,indices:O,postModify:u},{regex:B,indices:{bucket:1,path:2},postModify:u}];for(let G=0;G<F.length;G++){let re=F[G],ee=re.regex.exec(e);if(ee){let C=ee[re.indices.bucket],w=ee[re.indices.path];w||(w=""),i=new n(C,w),re.postModify(i);break}}if(i==null)throw lN(e);return i}},R0=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function mN(n,e,t){let i=1,r=null,s=null,o=!1,c=0;function l(){return c===2}let u=!1;function h(...x){u||(u=!0,e.apply(null,x))}function g(x){r=setTimeout(()=>{r=null,n(b,l())},x)}function v(){s&&clearTimeout(s)}function b(x,...B){if(u){v();return}if(x){v(),h.call(null,x,...B);return}if(l()||o){v(),h.call(null,x,...B);return}i<64&&(i*=2);let F;c===1?(c=2,F=0):F=(i+Math.random())*1e3,g(F)}let O=!1;function M(x){O||(O=!0,v(),!u&&(r!==null?(x||(c=2),clearTimeout(r),g(0)):x||(c=1)))}return g(0),s=setTimeout(()=>{o=!0,M(!0)},t),M}function gN(n){n(!1)}function _N(n){return n!==void 0}function yN(n){return typeof n=="function"}function vN(n){return typeof n=="object"&&!Array.isArray(n)}function Hd(n){return typeof n=="string"||n instanceof String}function uC(n){return V0()&&n instanceof Blob}function V0(){return typeof Blob<"u"}function P0(n,e,t,i){if(i<e)throw Gr(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw Gr(`Invalid value for '${n}'. Expected ${t} or less.`)}function tr(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function TC(n){let e=encodeURIComponent,t="?";for(let i in n)if(n.hasOwnProperty(i)){let r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var Co=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Co||{});function CC(n,e){let t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}var x0=class{constructor(e,t,i,r,s,o,c,l,u,h,g,v=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=g,this.retry=v,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((b,O)=>{this.resolve_=b,this.reject_=O,this.start_()})}start_(){let e=(i,r)=>{if(r){i(!1,new To(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=c=>{let l=c.loaded,u=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let c=s.getErrorCode()===Co.NO_ERROR,l=s.getStatus();if(!c||CC(l,this.additionalRetryCodes_)&&this.retry){let h=s.getErrorCode()===Co.ABORT;i(!1,new To(!1,null,h));return}let u=this.successCodes_.indexOf(l)!==-1;i(!0,new To(u,s))})},t=(i,r)=>{let s=this.resolve_,o=this.reject_,c=r.connection;if(r.wasSuccessCode)try{let l=this.callback_(c,c.getResponse());_N(l)?s(l):s()}catch(l){o(l)}else if(c!==null){let l=O0();l.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,l)):o(l)}else if(r.canceled){let l=this.appDelete_?IC():EC();o(l)}else{let l=wC();o(l)}};this.canceled_?t(!1,new To(!1,null,!0)):this.backoffId_=mN(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&gN(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},To=class{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}};function wN(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function EN(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function bN(n,e){e&&(n["X-Firebase-GMPID"]=e)}function IN(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function TN(n,e,t,i,r,s,o=!0){let c=TC(n.urlParams),l=n.url+c,u=Object.assign({},n.headers);return bN(u,e),wN(u,t),EN(u,s),IN(u,i),new x0(l,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o)}function CN(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function AN(...n){let e=CN();if(e!==void 0){let t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(V0())return new Blob(n);throw new Qe(We.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function SN(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function RN(n){if(typeof atob>"u")throw pN("base-64");return atob(n)}var sn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Dc=class{constructor(e,t){this.data=e,this.contentType=t||null}};function F0(n,e){switch(n){case sn.RAW:return new Dc(AC(e));case sn.BASE64:case sn.BASE64URL:return new Dc(SC(n,e));case sn.DATA_URL:return new Dc(xN(e),DN(e))}throw O0()}function AC(n){let e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=i,o=n.charCodeAt(++t);i=65536|(s&1023)<<10|o&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function PN(n){let e;try{e=decodeURIComponent(n)}catch{throw xc(sn.DATA_URL,"Malformed data URL.")}return AC(e)}function SC(n,e){switch(n){case sn.BASE64:{let r=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(r||s)throw xc(n,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case sn.BASE64URL:{let r=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(r||s)throw xc(n,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=RN(e)}catch(r){throw r.message.includes("polyfill")?r:xc(n,"Invalid character found")}let i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i}var Gd=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw xc(sn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let i=t[1]||null;i!=null&&(this.base64=MN(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}};function xN(n){let e=new Gd(n);return e.base64?SC(sn.BASE64,e.rest):PN(e.rest)}function DN(n){return new Gd(n).contentType}function MN(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Ao=class n{constructor(e,t){let i=0,r="";uC(e)?(this.data_=e,i=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(uC(this.data_)){let i=this.data_,r=SN(i,e,t);return r===null?null:new n(r)}else{let i=new Uint8Array(this.data_.buffer,e,t-e);return new n(i,!0)}}static getBlob(...e){if(V0()){let t=e.map(i=>i instanceof n?i.data_:i);return new n(AN.apply(null,t))}else{let t=e.map(o=>Hd(o)?F0(sn.RAW,o).data:o.data_),i=0;t.forEach(o=>{i+=o.byteLength});let r=new Uint8Array(i),s=0;return t.forEach(o=>{for(let c=0;c<o.length;c++)r[s++]=o[c]}),new n(r,!0)}}uploadData(){return this.data_}};function L0(n){let e;try{e=JSON.parse(n)}catch{return null}return vN(e)?e:null}function kN(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function ON(n,e){let t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function RC(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function NN(n,e){return e}var At=class{constructor(e,t,i,r){this.server=e,this.local=t||e,this.writable=!!i,this.xform=r||NN}},Wd=null;function VN(n){return!Hd(n)||n.length<2?n:RC(n)}function Kd(){if(Wd)return Wd;let n=[];n.push(new At("bucket")),n.push(new At("generation")),n.push(new At("metageneration")),n.push(new At("name","fullPath",!0));function e(s,o){return VN(o)}let t=new At("name");t.xform=e,n.push(t);function i(s,o){return o!==void 0?Number(o):o}let r=new At("size");return r.xform=i,n.push(r),n.push(new At("timeCreated")),n.push(new At("updated")),n.push(new At("md5Hash",null,!0)),n.push(new At("cacheControl",null,!0)),n.push(new At("contentDisposition",null,!0)),n.push(new At("contentEncoding",null,!0)),n.push(new At("contentLanguage",null,!0)),n.push(new At("contentType",null,!0)),n.push(new At("metadata","customMetadata",!0)),Wd=n,Wd}function FN(n,e){function t(){let i=n.bucket,r=n.fullPath,s=new qt(i,r);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function LN(n,e,t){let i={};i.type="file";let r=t.length;for(let s=0;s<r;s++){let o=t[s];i[o.local]=o.xform(i,e[o.server])}return FN(i,n),i}function PC(n,e,t){let i=L0(e);return i===null?null:LN(n,i,t)}function UN(n,e,t,i){let r=L0(e);if(r===null||!Hd(r.downloadTokens))return null;let s=r.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(u=>{let h=n.bucket,g=n.fullPath,v="/b/"+o(h)+"/o/"+o(g),b=tr(v,t,i),O=TC({alt:"media",token:u});return b+O})[0]}function U0(n,e){let t={},i=e.length;for(let r=0;r<i;r++){let s=e[r];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var dC="prefixes",hC="items";function jN(n,e,t){let i={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[dC])for(let r of t[dC]){let s=r.replace(/\/$/,""),o=n._makeStorageReference(new qt(e,s));i.prefixes.push(o)}if(t[hC])for(let r of t[hC]){let s=n._makeStorageReference(new qt(e,r.name));i.items.push(s)}return i}function BN(n,e,t){let i=L0(t);return i===null?null:jN(n,e,i)}var Cn=class{constructor(e,t,i,r){this.url=e,this.method=t,this.handler=i,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function Kn(n){if(!n)throw O0()}function Qd(n,e){function t(i,r){let s=PC(n,r,e);return Kn(s!==null),s}return t}function qN(n,e){function t(i,r){let s=BN(n,e,r);return Kn(s!==null),s}return t}function $N(n,e){function t(i,r){let s=PC(n,r,e);return Kn(s!==null),UN(s,r,n.host,n._protocol)}return t}function Po(n){function e(t,i){let r;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?r=aN():r=oN():t.getStatus()===402?r=sN(n.bucket):t.getStatus()===403?r=cN(n.path):r=i,r.status=t.getStatus(),r.serverResponse=i.serverResponse,r}return e}function Jd(n){let e=Po(n);function t(i,r){let s=e(i,r);return i.getStatus()===404&&(s=rN(n.path)),s.serverResponse=r.serverResponse,s}return t}function xC(n,e,t){let i=e.fullServerUrl(),r=tr(i,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,c=new Cn(r,s,Qd(n,t),o);return c.errorHandler=Jd(e),c}function zN(n,e,t,i,r){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),i&&(s.pageToken=i),r&&(s.maxResults=r);let o=e.bucketOnlyServerUrl(),c=tr(o,n.host,n._protocol),l="GET",u=n.maxOperationRetryTime,h=new Cn(c,l,qN(n,e.bucket),u);return h.urlParams=s,h.errorHandler=Po(e),h}function WN(n,e,t){let i=e.fullServerUrl(),r=tr(i,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,c=new Cn(r,s,$N(n,t),o);return c.errorHandler=Jd(e),c}function GN(n,e,t,i){let r=e.fullServerUrl(),s=tr(r,n.host,n._protocol),o="PATCH",c=U0(t,i),l={"Content-Type":"application/json; charset=utf-8"},u=n.maxOperationRetryTime,h=new Cn(s,o,Qd(n,i),u);return h.headers=l,h.body=c,h.errorHandler=Jd(e),h}function HN(n,e){let t=e.fullServerUrl(),i=tr(t,n.host,n._protocol),r="DELETE",s=n.maxOperationRetryTime;function o(l,u){}let c=new Cn(i,r,o,s);return c.successCodes=[200,204],c.errorHandler=Jd(e),c}function KN(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DC(n,e,t){let i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=KN(null,e)),i}function QN(n,e,t,i,r){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function c(){let F="";for(let G=0;G<2;G++)F=F+Math.random().toString().slice(2);return F}let l=c();o["Content-Type"]="multipart/related; boundary="+l;let u=DC(e,i,r),h=U0(u,t),g="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,v=`\r
--`+l+"--",b=Ao.getBlob(g,i,v);if(b===null)throw bC();let O={name:u.fullPath},M=tr(s,n.host,n._protocol),x="POST",B=n.maxUploadRetryTime,H=new Cn(M,x,Qd(n,t),B);return H.urlParams=O,H.headers=o,H.body=b.uploadData(),H.errorHandler=Po(e),H}var So=class{constructor(e,t,i,r){this.current=e,this.total=t,this.finalized=!!i,this.metadata=r||null}};function j0(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{Kn(!1)}return Kn(!!t&&(e||["active"]).indexOf(t)!==-1),t}function JN(n,e,t,i,r){let s=e.bucketOnlyServerUrl(),o=DC(e,i,r),c={name:o.fullPath},l=tr(s,n.host,n._protocol),u="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},g=U0(o,t),v=n.maxUploadRetryTime;function b(M){j0(M);let x;try{x=M.getResponseHeader("X-Goog-Upload-URL")}catch{Kn(!1)}return Kn(Hd(x)),x}let O=new Cn(l,u,b,v);return O.urlParams=c,O.headers=h,O.body=g,O.errorHandler=Po(e),O}function YN(n,e,t,i){let r={"X-Goog-Upload-Command":"query"};function s(u){let h=j0(u,["active","final"]),g=null;try{g=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Kn(!1)}g||Kn(!1);let v=Number(g);return Kn(!isNaN(v)),new So(v,i.size(),h==="final")}let o="POST",c=n.maxUploadRetryTime,l=new Cn(t,o,s,c);return l.headers=r,l.errorHandler=Po(e),l}var fC=256*1024;function XN(n,e,t,i,r,s,o,c){let l=new So(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=i.size()),i.size()!==l.total)throw hN();let u=l.total-l.current,h=u;r>0&&(h=Math.min(h,r));let g=l.current,v=g+h,b="";h===0?b="finalize":u===h?b="upload, finalize":b="upload";let O={"X-Goog-Upload-Command":b,"X-Goog-Upload-Offset":`${l.current}`},M=i.slice(g,v);if(M===null)throw bC();function x(G,re){let ee=j0(G,["active","final"]),C=l.current+h,w=i.size(),I;return ee==="final"?I=Qd(e,s)(G,re):I=null,new So(C,w,ee==="final",I)}let B="POST",H=e.maxUploadRetryTime,F=new Cn(t,B,x,H);return F.headers=O,F.body=M.uploadData(),F.progressCallback=c||null,F.errorHandler=Po(n),F}var MC={STATE_CHANGED:"state_changed"},Vt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function S0(n){switch(n){case"running":case"pausing":case"canceling":return Vt.RUNNING;case"paused":return Vt.PAUSED;case"success":return Vt.SUCCESS;case"canceled":return Vt.CANCELED;case"error":return Vt.ERROR;default:return Vt.ERROR}}var D0=class{constructor(e,t,i){if(yN(e)||t!=null||i!=null)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Io(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var pC=null,M0=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Co.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Co.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Co.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,r){if(this.sent_)throw Pc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),r!==void 0)for(let s in r)r.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,r[s].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Pc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Pc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Pc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Pc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},k0=class extends M0{initXhr(){this.xhr_.responseType="text"}};function Hn(){return pC?pC():new k0}var Mc=class{constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=Kd(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{if(this._request=void 0,this._chunkMultiplier=1,r._codeEquals(We.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(CC(r.status,[]))if(s)r=wC();else{this.sleepTime=Math.max(this.sleepTime*2,iN),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=r,this._transition("error")}},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals(We.CANCELED)?this.completeTransitions_():(this._error=r,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((r,s)=>{this._resolve=r,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let i=JN(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Hn,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,i)=>{let r=YN(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,Hn,t,i);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=fC*this._chunkMultiplier,t=new So(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((r,s)=>{let o;try{o=XN(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}let c=this._ref.storage._makeRequest(o,Hn,r,s,!1);this._request=c,c.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){fC*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let i=xC(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(i,Hn,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let i=QN(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(i,Hn,e,t);this._request=r,r.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=EC(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=S0(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,r){let s=new D0(t||void 0,i||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(S0(this._state)){case Vt.SUCCESS:Io(this._resolve.bind(null,this.snapshot))();break;case Vt.CANCELED:case Vt.ERROR:let t=this._reject;Io(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(S0(this._state)){case Vt.RUNNING:case Vt.PAUSED:e.next&&Io(e.next.bind(e,this.snapshot))();break;case Vt.SUCCESS:e.complete&&Io(e.complete.bind(e))();break;case Vt.CANCELED:case Vt.ERROR:e.error&&Io(e.error.bind(e,this._error))();break;default:e.error&&Io(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Ro=class n{constructor(e,t){this._service=e,t instanceof qt?this._location=t:this._location=qt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new qt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RC(this._location.path)}get storage(){return this._service}get parent(){let e=kN(this._location.path);if(e===null)return null;let t=new qt(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw N0(e)}};function ZN(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Mc(n,new Ao(e),t)}function e2(n){let e={prefixes:[],items:[]};return kC(n,e).then(()=>e)}function kC(n,e,t){return E(this,null,function*(){let r=yield OC(n,{pageToken:t});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&(yield kC(n,e,r.nextPageToken))})}function OC(n,e){e!=null&&typeof e.maxResults=="number"&&P0("options.maxResults",1,1e3,e.maxResults);let t=e||{},i=zN(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(i,Hn)}function t2(n){n._throwIfRoot("getMetadata");let e=xC(n.storage,n._location,Kd());return n.storage.makeRequestWithTokens(e,Hn)}function n2(n,e){n._throwIfRoot("updateMetadata");let t=GN(n.storage,n._location,e,Kd());return n.storage.makeRequestWithTokens(t,Hn)}function i2(n){n._throwIfRoot("getDownloadURL");let e=WN(n.storage,n._location,Kd());return n.storage.makeRequestWithTokens(e,Hn).then(t=>{if(t===null)throw fN();return t})}function r2(n){n._throwIfRoot("deleteObject");let e=HN(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Hn)}function NC(n,e){let t=ON(n._location.path,e),i=new qt(n._location.bucket,t);return new Ro(n.storage,i)}function s2(n){return/^[A-Za-z]+:\/\//.test(n)}function o2(n,e){return new Ro(n,e)}function VC(n,e){if(n instanceof kc){let t=n;if(t._bucket==null)throw dN();let i=new Ro(t,t._bucket);return e!=null?VC(i,e):i}else return e!==void 0?NC(n,e):n}function a2(n,e){if(e&&s2(e)){if(n instanceof kc)return o2(n,e);throw Gr("To use ref(service, url), the first argument must be a Storage instance.")}else return VC(n,e)}function mC(n,e){let t=e?.[vC];return t==null?null:qt.makeFromBucketSpec(t,n)}function c2(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:r}=i;r&&(n._overrideAuthToken=typeof r=="string"?r:hl(r,n.app.options.projectId))}var kc=class{constructor(e,t,i,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=yC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=tN,this._maxUploadRetryTime=nN,this._requests=new Set,r!=null?this._bucket=qt.makeFromBucketSpec(r,this._host):this._bucket=mC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qt.makeFromBucketSpec(this._url,e):this._bucket=mC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){P0("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){P0("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return E(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return E(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ro(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new R0(IC());{let o=TN(e,this._appId,i,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return E(this,null,function*(){let[i,r]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()})}},gC="@firebase/storage",_C="0.13.2";var l2="storage";function FC(n,e,t){return n=Ae(n),ZN(n,e,t)}function LC(n){return n=Ae(n),t2(n)}function UC(n,e){return n=Ae(n),n2(n,e)}function jC(n,e){return n=Ae(n),OC(n,e)}function BC(n){return n=Ae(n),e2(n)}function qC(n){return n=Ae(n),i2(n)}function $C(n){return n=Ae(n),r2(n)}function B0(n,e){return n=Ae(n),a2(n,e)}function zC(n,e){return NC(n,e)}function WC(n,e,t,i={}){c2(n,e,t,i)}function u2(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new kc(t,i,r,e,_l)}function d2(){lr(new mn(l2,u2,"PUBLIC").setMultipleInstances(!0)),ht(gC,_C,""),ht(gC,_C,"esm2017")}d2();var xo=class{constructor(e,t,i){this._delegate=e,this.task=t,this.ref=i}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Yd=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new xo(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(i=>{if(e)return e(new xo(i,this,this._ref))},t)}on(e,t,i,r){let s;return t&&(typeof t=="function"?s=o=>t(new xo(o,this,this._ref)):s={next:t.next?o=>t.next(new xo(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,i||void 0,r||void 0)}},Xd=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Hr(e,this._service))}get items(){return this._delegate.items.map(e=>new Hr(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Hr=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=zC(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Yd(FC(this._delegate,e,t),this)}putString(e,t=sn.RAW,i){this._throwIfRoot("putString");let r=F0(t,e),s=Object.assign({},i);return s.contentType==null&&r.contentType!=null&&(s.contentType=r.contentType),new Yd(new Mc(this._delegate,new Ao(r.data,!0),s),this)}listAll(){return BC(this._delegate).then(e=>new Xd(e,this.storage))}list(e){return jC(this._delegate,e||void 0).then(t=>new Xd(t,this.storage))}getMetadata(){return LC(this._delegate)}updateMetadata(e){return UC(this._delegate,e)}getDownloadURL(){return qC(this._delegate)}delete(){return this._throwIfRoot("delete"),$C(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw N0(e)}};var Zd=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(GC(e))throw Gr("ref() expected a child path but got a URL, use refFromURL instead.");return new Hr(B0(this._delegate,e),this)}refFromURL(e){if(!GC(e))throw Gr("refFromURL() expected a full URL but got a child path, use ref() instead.");try{qt.makeFromUrl(e,this._delegate.host)}catch{throw Gr("refFromUrl() expected a valid full URL but got an invalid one.")}return new Hr(B0(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,i={}){WC(this._delegate,e,t,i)}};function GC(n){return/^[A-Za-z]+:\/\//.test(n)}var h2="@firebase/storage-compat",f2="0.3.12";var p2="storage-compat";function m2(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),i=n.getProvider("storage").getImmediate({identifier:e});return new Zd(t,i)}function g2(n){let e={TaskState:Vt,TaskEvent:MC,StringFormat:sn,Storage:Zd,Reference:Hr};n.INTERNAL.registerComponent(new mn(p2,m2,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(h2,f2)}g2(tt);function _2(n){return new wt(e=>{let t=o=>e.next(o),i=o=>e.error(o),r=()=>e.complete();t(n.snapshot);let s=n.on("state_changed",t);return n.then(o=>{t(o),r()},o=>{t(n.snapshot),i(o)}),function(){s()}}).pipe(Zy(0))}function HC(n){let e=_2(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(se(t=>t.bytesTransferred/t.totalBytes*100))}}function eh(n){return{getDownloadURL:()=>X(void 0).pipe(rp,Ce(()=>n.getDownloadURL()),yt),getMetadata:()=>X(void 0).pipe(rp,Ce(()=>n.getMetadata()),yt),delete:()=>be(n.delete()),child:e=>eh(n.child(e)),updateMetadata:e=>be(n.updateMetadata(e)),put:(e,t)=>{let i=n.put(e,t);return HC(i)},putString:(e,t,i)=>{let r=n.putString(e,t,i);return HC(r)},list:e=>be(n.list(e)),listAll:()=>be(n.listAll())}}var y2=new te("angularfire2.storageBucket"),v2=new te("angularfire2.storage.maxUploadRetryTime"),w2=new te("angularfire2.storage.maxOperationRetryTime"),E2=new te("angularfire2.storage.use-emulator"),_i=(()=>{class n{storage;constructor(t,i,r,s,o,c,l,u,h,g){let v=ri(t,o,i);this.storage=ki(`${v.name}.storage.${r}`,"AngularFireStorage",v.name,()=>{let b=o.runOutsideAngular(()=>v.storage(r||void 0)),O=h;return O&&b.useEmulator(...O),l&&b.setMaxUploadRetryTime(l),u&&b.setMaxOperationRetryTime(u),b},[l,u])}ref(t){return eh(this.storage.ref(t))}refFromURL(t){return eh(this.storage.refFromURL(t))}upload(t,i,r){let s=this.storage.ref(t);return eh(s).put(i,r)}static \u0275fac=function(i){return new(i||n)(j(kn),j(On,8),j(y2,8),j(dt),j(Re),j(Wt),j(v2,8),j(w2,8),j(E2,8),j(Zt,8))};static \u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var b2=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({})}return n})(),KC=(()=>{class n{constructor(){tt.registerVersion("angularfire",_t.full,"gcs-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[_i],imports:[b2]})}return n})();var nr=(()=>{class n{constructor(t,i,r){this.firestore=t,this.storage=i,this.http=r}ngOnInit(){}addDocuments(t,i){return E(this,null,function*(){try{let r=i.map(s=>this.firestore.collection(t).add(s));yield Promise.all(r),console.log("Ajout\xE9 avec succ\xE8s")}catch(r){console.error("Erreur lors de l\u2019ajout des documents :",r)}})}static{this.\u0275fac=function(i){return new(i||n)(j(rn),j(_i),j(gn))}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function I2(n,e){if(n&1&&(p(0,"div",10),y(1),m()),n&2){let t=Z();S(),$e(" ",t.errOrder," ")}}function T2(n,e){if(n&1&&(p(0,"span",15),y(1),m()),n&2){let t=Z();S(),de(t.errEmail)}}function C2(n,e){if(n&1&&(p(0,"option",18),y(1),m()),n&2){let t=e.$implicit;pn("value",t.code),S(),de(t.country+", "+t.code)}}function A2(n,e){n&1&&(p(0,"div",21)(1,"span",24),y(2,"Loading..."),m()())}var QC=(()=>{class n{constructor(t,i,r,s,o,c){this.firestore=t,this.storage=i,this.route=r,this.Auth=s,this.apiservice=o,this.http=c,this.router=Q(kt),this.nom="",this.email="",this.password="",this.confirmPassword="",this.statusLoader="invisible",this.authService=Q(bo),this.messageAlert="",this.colorAlert="",this.laoding=!1,this.etat="",this.type="artiste",this.isCheked=!1}goTo(t){this.router.navigate(["/"+t])}goToLogin(){this.router.navigate(["/login"])}ngOnInit(){this.getAuth(),this.fetchCountryDialCodes()}getAuth(){this.Auth.authState.subscribe(t=>{t&&(this.idUser=t?.uid,this.email=t.email,this.router.navigate(["/dash"]))})}uploadPro(t){this.fileCover=t.target.files[0]}addProfile(){this.Auth.authState.subscribe(t=>{t?(this.idUser=t?.uid,this.firestore.collection("profiles").add({idUser:this.idUser,email:this.email,tel:this.tel,codeTel:this.codeTel,nom:this.nom,prenom:this.prenom,username:this.username,date:new Date}).then(()=>{this.laoding=!1,this.etat="",alert("Inscription reussie"),this.router.navigate(["/login"]),this.statusLoader="invisible"})):alert("Un probleme est survenu")})}login(){this.controlPass()=="valide"?(this.statusLoader="",this.messageAlert="",this.colorAlert="",this.laoding=!0,this.etat="disabled",this.authService.register(this.email,this.password,this.username).subscribe({next:()=>{this.addProfile()},error:i=>{this.colorAlert="alert-danger",this.messageAlert=i.code,this.statusLoader="invisible",this.laoding=!1}})):(this.messageAlert=this.errMessage,this.colorAlert="alert-danger")}controlPass(){if(this.errMessage="",this.errEmail="",this.password.length<8)return this.errMessage="le mot de passe doit contenir minimum 8 carat\xE8res",this.colorAlert="alert-danger","error";if(this.password!=this.confirmPassword)return this.errMessage="Les mots de passe ne correspondent pas.",this.colorAlert="alert-danger","error";let t=/[A-Z]/.test(this.password),i=/\d/.test(this.password),r=/[!@#$%^&*(),.?":{}|<>]/.test(this.password);return!t||!i||!r?(this.errMessage="Le mot de passe doit contenir une majuscule, un chiffre et un caract\xE8re sp\xE9cial.",this.colorAlert="alert-danger","error"):/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(this.email)?!this.tel||!this.nom||!this.prenom||!this.username||!this.codeTel||!this.password||!this.confirmPassword?(this.errOrder="Remplissez tous les champs",this.colorAlert="alert-danger","error"):"valide":(this.errEmail="Veuillez entrer une adresse email valide.",this.colorAlert="alert-danger","error")}condition(){this.isCheked=!this.isCheked,this.isCheked}fetchCountryDialCodes(){this.http.get("https://restcountries.com/v3.1/all").subscribe(i=>{this.countries=i.map(r=>({country:r.name.common,code:r.idd.root+(r.idd.suffixes?r.idd.suffixes[0]:""),flag:r.flags?.svg||r.flags?.png||""})).sort((r,s)=>r.country.localeCompare(s.country)),console.log(this.countries)},i=>{console.error("Erreur lors de la r\xE9cup\xE9ration des donn\xE9es :",i)})}static{this.\u0275fac=function(i){return new(i||n)(le(rn),le(_i),le(xn),le(en),le(nr),le(gn))}}static{this.\u0275cmp=De({type:n,selectors:[["app-inscription"]],standalone:!0,features:[Me],decls:79,vars:12,consts:[[1,"content"],[1,"titre"],[1,"p-4","content-connect","w-100"],[1,"d-flex","justify-content-center","align-item-center","w-100"],[1,"register","shadow-lg","center"],["xmlns","http://www.w3.org/2000/svg","width","56","height","84","viewBox","77.7 214.9 274.7 412",1,"site__logo"],["id","a","x1","0%","y1","0%","y2","0%"],["offset","0%","stop-color","#8ceabb"],["offset","100%","stop-color","#378f7b"],["fill","url(#a)","d","M215 214.9c-83.6 123.5-137.3 200.8-137.3 275.9 0 75.2 61.4 136.1 137.3 136.1s137.3-60.9 137.3-136.1c0-75.1-53.7-152.4-137.3-275.9z"],["role","alert",1,"alert","alert-primary"],[1,"box-content","w-100","p-4","text-white"],[1,"row"],[1,"col","mb-3"],[1,"form-label"],[1,"text-danger"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],["type","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"btn","btn-info","w-100",3,"click","disabled"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"text-white"],[1,"text-info",3,"click"],[1,"visually-hidden"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Inscrivez vous"),m()(),p(4,"div",2)(5,"div",3)(6,"div",4),ss(),p(7,"svg",5)(8,"defs")(9,"linearGradient",6),W(10,"stop",7)(11,"stop",8),m()(),W(12,"path",9),m(),os(),p(13,"h2"),y(14,"Inscription"),m(),ge(15,I2,2,1,"div",10),p(16,"div",11)(17,"div",12)(18,"div",13)(19,"label",14),y(20,"Nom "),p(21,"span",15),y(22,"*"),m()(),p(23,"input",16),ce("ngModelChange",function(o){return ae(r.nom,o)||(r.nom=o),o}),m()(),p(24,"div",13)(25,"label",14),y(26,"Pr\xE9nom "),p(27,"span",15),y(28,"*"),m()(),p(29,"input",16),ce("ngModelChange",function(o){return ae(r.prenom,o)||(r.prenom=o),o}),m()()(),p(30,"div",12)(31,"div",13)(32,"label",14),y(33,"Nom d'utilisateur "),p(34,"span",15),y(35,"*"),m()(),p(36,"input",16),ce("ngModelChange",function(o){return ae(r.username,o)||(r.username=o),o}),m()(),p(37,"div",13)(38,"label",14),y(39,"Email "),p(40,"span",15),y(41,"*"),m()(),p(42,"input",16),ce("ngModelChange",function(o){return ae(r.email,o)||(r.email=o),o}),m(),ge(43,T2,2,1,"span",15),m()(),p(44,"div",12)(45,"div",13)(46,"label",14),y(47,"pays "),p(48,"span",15),y(49,"*"),m()(),p(50,"select",17),ce("ngModelChange",function(o){return ae(r.codeTel,o)||(r.codeTel=o),o}),Xe(51,C2,2,2,"option",18,Ye),m()(),p(53,"div",13)(54,"label",14),y(55,"Telephone "),p(56,"span",15),y(57,"*"),m()(),p(58,"input",16),ce("ngModelChange",function(o){return ae(r.tel,o)||(r.tel=o),o}),m()()(),p(59,"div",12)(60,"div",13)(61,"label",14),y(62,"Mot de passe "),p(63,"span",15),y(64,"*"),m()(),p(65,"input",19),ce("ngModelChange",function(o){return ae(r.password,o)||(r.password=o),o}),m()(),p(66,"div",13)(67,"label",14),y(68,"Confirmer le mot de passe "),p(69,"span",15),y(70,"*"),m()(),p(71,"input",19),ce("ngModelChange",function(o){return ae(r.confirmPassword,o)||(r.confirmPassword=o),o}),m()()(),p(72,"button",20),ne("click",function(){return r.login()}),y(73," Valider "),ge(74,A2,3,0,"div",21),m()(),p(75,"p",22),y(76,"Vous avez d\xE9j\xE0 un compte? "),p(77,"a",23),ne("click",function(){return r.goTo("login")}),y(78,"connectez vous"),m()()()()()()),i&2&&(S(15),me(15,r.errOrder?15:-1),S(8),oe("ngModel",r.nom),S(6),oe("ngModel",r.prenom),S(7),oe("ngModel",r.username),S(6),oe("ngModel",r.email),S(),me(43,r.errEmail?43:-1),S(7),oe("ngModel",r.codeTel),S(),Ze(r.countries),S(7),oe("ngModel",r.tel),S(7),oe("ngModel",r.password),S(6),oe("ngModel",r.confirmPassword),S(),bt("disabled",r.laoding),S(2),me(74,r.laoding?74:-1))},dependencies:[ln,xi,Di,zt,Mn,cn,Xt],styles:[".content[_ngcontent-%COMP%]{padding-bottom:300px;background-color:#12222b;min-height:100vh;width:100%}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:30vh;display:flex;justify-content:center;align-items:center}.site__logo[_ngcontent-%COMP%]{margin-bottom:2rem}h2[_ngcontent-%COMP%]{font-size:2.75rem;font-weight:100;margin:0 0 1rem;text-transform:uppercase;color:#fff}svg[_ngcontent-%COMP%]{height:auto;max-width:100%;vertical-align:middle}a[_ngcontent-%COMP%]{color:#f3f5f7;cursor:pointer;text-decoration:underline}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.register[_ngcontent-%COMP%]{width:70%;border-radius:20px}@media (max-width: 768px){.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:20vh;display:flex;justify-content:center;align-items:center}}"]})}}return n})();function S2(n,e){if(n&1){let t=gt();p(0,"button",51),ne("click",function(){ye(t);let r=Z().$implicit,s=Z();return ve(s.generateInvoice(r))}),W(1,"i",52),m()}}function R2(n,e){if(n&1){let t=gt();p(0,"tr")(1,"th"),y(2),m(),p(3,"td"),y(4),m(),p(5,"td")(6,"span"),y(7),m()(),p(8,"td"),y(9),m(),p(10,"td"),y(11),m(),p(12,"td"),y(13),m(),p(14,"td")(15,"button",48),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.deleteTransfert(r.id))}),W(16,"i",49),m(),ge(17,S2,2,0,"button",50),m()()}if(n&2){let t=e.$implicit;S(2),de(t.num),S(2),de(t.montant),S(2),ni("badge bg-",t.couleur,""),S(),de(t.etat),S(2),de(t.date),S(2),de(t.taux),S(2),de(t.telRecepteur),S(4),me(17,t.etat=="success"?17:-1)}}function P2(n,e){n&1&&(p(0,"tr")(1,"td",4)(2,"button",53),y(3," Aucun tranfert Pour le moment. "),m()()())}function x2(n,e){if(n&1&&(p(0,"div",27),y(1),m()),n&2){let t=Z();S(),$e(" ",t.errChange," ")}}function D2(n,e){if(n&1&&(p(0,"option",38),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.operateur+"("+t.pays+")")}}function M2(n,e){if(n&1&&(p(0,"option",38),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.operateur+"("+t.pays+")")}}function k2(n,e){if(n&1&&(p(0,"h4"),y(1),m()),n&2){let t=Z();S(),sl("1 ",t.monaieS," = ",t.tauxApplicable+" "+t.monaieR,"")}}function O2(n,e){n&1&&(p(0,"div",54)(1,"span",55),y(2,"Loading..."),m()())}function N2(n,e){n&1&&(p(0,"div",45)(1,"span",55),y(2,"Loading..."),m()())}var JC=(()=>{class n{constructor(t,i,r){this.Auth=t,this.apiservice=i,this.firestore=r,this.router=Q(kt),this.montantSend=0,this.isAddingTrans=!1,this.msgErr="",this.transferts=[],this.nbreEncour=0,this.nbreSuccess=0,this.nbreEchec=0,this.monaies=[],this.errChange=""}ngOnInit(){this.getAuth(),this.getMonaie()}goTo(t){this.router.navigate(["/"+t])}getAuth(){this.Auth.authState.subscribe(t=>{t?(this.idUser=t?.uid,this.getProfile(),this.getTransfert()):this.router.navigate(["/acceuil"])})}getProfile(){this.firestore.collection("profiles",t=>t.where("idUser","==",this.idUser)).get().subscribe(t=>{t.forEach(i=>{this.tel=i.data().tel,console.log(this.tel)})})}updateProfile(){}addTransfert(){console.log(this.opRe+" "+this.opSend+" "+this.monaieS+" "+this.monaieR+this.nomR+this.tauxApplicable+this.idUser+this.tel),this.opRe&&this.opSend&&this.montantSend&&this.nomR&&this.telR?(this.isAddingTrans=!0,this.msgErr="",this.firestore.collection("transferts").add({tel:this.tel,recepteur:this.opRe,initiateur:this.opSend,etat:"en cour",date:new Date,montant:this.montantSend,montantRecept:this.montantRec,taux:this.tauxApplicable,idUser:this.idUser,nomRecepteur:this.nomR,telRecepteur:this.telR,monaieSender:this.monaieS,monaieRecepteur:this.monaieR}).then(()=>{alert("Votre transfert a \xE9t\xE9 recut. Nous communiquerons avec vous pour la suite"),this.isAddingTrans=!1,this.opRe="",this.opSend="",this.montantSend=0,this.nomR="",this.telR="",this.montantRec=0,this.monaieR="",this.monaieS="",this.tauxApplicable="",this.getTransfert()})):this.errChange="remplissez toutes les informations"}getTransfert(){this.firestore.collection("transferts",t=>t.where("idUser","==",this.idUser)).get().subscribe(t=>{let i=0,r="";this.transferts=[],this.nbreEncour=0,this.nbreSuccess=0,this.nbreEchec=0,t.forEach(s=>{i++,s.data().etat=="en cour"&&(r="primary",this.nbreEncour++),s.data().etat=="success"&&(r="success",this.nbreSuccess++),s.data().etat=="echec"&&(r="danger",this.nbreEchec++);let o=this.formatTimestampToDate(s.data().date);this.transferts.push({num:i,id:s.id,etat:s.data().etat,montant:s.data().montant+" "+s.data().monaieSender+" => "+s.data().montantRecept+" "+s.data().monaieRecepteur,amount:s.data().montant,amountR:s.data().montantRecept,taux:s.data().taux,couleur:r,date:o,telRecepteur:s.data().telRecepteur,nomRecepteur:s.data().nomRecepteur,monaieRecepteur:s.data().monaieRecepteur,monaieSender:s.data().monaieSender})}),console.log(this.transferts)})}deleteTransfert(t){confirm("voulez supprimer ce transfert?")&&this.firestore.collection("transferts").doc(t).delete().then(()=>{alert("Suppression reussie"),this.getTransfert()})}generateInvoice(t){let i=prompt("A quel nom devons nous faire le recut?");if(i){let r=`
        <html>
          <head>
            <title>Facture - Transfert R\xE9ussi</title>
            <style>
              body {
                font-family: Arial, sans-serif;
                margin: 20px;
              }
              .invoice-header {
                text-align: center;
                margin-bottom: 20px;
              }
              .invoice-header h1 {
                margin: 0;
                font-size: 24px;
              }
              .invoice-details {
                margin-bottom: 20px;
              }
              .details-row {
                margin-bottom: 10px;
              }
              .table-recut {
                width: 100%;
                border-collapse: collapse;
              }
              .table-recut, th, td {
                border: 1px solid black;
              }
              .table-recut th, td {
                padding: 10px;
                text-align: left;
              }
              .footer {
                margin-top: 20px;
                text-align: center;
                font-size: 12px;
              }
              .img-logo{
                  width: 10rem;
                  height: 5rem;
                  object-fit: contain;
              }
            </style>
          </head>
          <body>
            <div class="invoice-header">
              <img src="../../assets/logo ksc xchange t.png" class="img-logo">
              <h1>Facture</h1>
              <p>kscXchange</p>
            </div>
            <div class="invoice-details">
              <div class="details-row"><strong>Nom de l'exp\xE9diteur :</strong> ${i}</div>
              <div class="details-row"><strong>Nom du destinataire :</strong> ${t.nomRecepteur}</div>
              <div class="details-row"><strong>Nom du destinataire :</strong> ${t.telRecepteur}</div>
              <div class="details-row"><strong>Montant transf\xE9r\xE9 :</strong> ${t.amount} ${t.monaieSender}</div>
              <div class="details-row"><strong>Taux de change :</strong> ${t.taux} </div>
              <div class="details-row"><strong>Date :</strong> ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}</div>
              <div class="details-row"><strong>ID de la transaction :</strong> ${t.id}</div>
            </div>
            <table class="table-recut">
              <thead>
                <tr>
                  <th>Description</th>
                  <th>Montant</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Montant transf\xE9r\xE9</td>
                  <td>${t.amount} ${t.monaieSender}</td>
                </tr>
                <tr>
                  <td>Taux de change</td>
                  <td>${t.taux} </td>
                </tr>
                <tr>
                  <td><strong>Total Montant recut</strong></td>
                  <td><strong>${t.amountR} ${t.monaieRecepteur}</strong></td>
                </tr>
              </tbody>
            </table>
            <div class="footer">
              Merci d'avoir utilis\xE9 notre service. \xC0 bient\xF4t !
            </div>
          </body>
        </html>
      `,s=window.open("","_blank");s?(s.document.write(r),s.document.close(),s.focus(),s.print(),s.close()):console.error("Impossible d'ouvrir une fen\xEAtre pour l'impression.")}}formatTimestampToDate(t){if(!t||typeof t.seconds!="number")throw new Error("Le timestamp est invalide.");let i=new Date(t.seconds*1e3),r=String(i.getDate()).padStart(2,"0"),s=String(i.getMonth()+1).padStart(2,"0"),o=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0");return`${r}/${s}/${o} ${c}:${l}`}getMonaie(){return E(this,null,function*(){this.firestore.collection("devises").get().subscribe(t=>{this.monaies=[],t.forEach(i=>{this.monaies.push({id:i.id,monaie:i.data().monaie,pays:i.data().pays,operateur:i.data().operateur})}),console.log(this.monaies)})})}getNameOfMonaie(t){return E(this,null,function*(){try{let i=yield this.firestore.collection("devises").doc(t).get().toPromise();return i.exists?i.data().monaie:null}catch(i){return console.error("Erreur lors de la r\xE9cup\xE9ration de la monnaie :",i),null}})}calcul(){return E(this,null,function*(){if(this.errChange="",this.opSend)if(this.opRe)try{if(this.monaieS=yield this.getNameOfMonaie(this.opSend),this.monaieR=yield this.getNameOfMonaie(this.opRe),!this.monaieS||!this.monaieR){this.errChange="Impossible de r\xE9cup\xE9rer les informations des devises.";return}console.log("Monnaie \xE9metteur :",this.monaieS),console.log("Monnaie r\xE9cepteur :",this.monaieR);let t=yield this.firestore.collection("tauxChange",i=>i.where("sender","==",this.opSend).where("reciever","==",this.opRe)).get().toPromise();t.empty?(this.errChange="Aucun taux de change trouv\xE9 pour ces devises.",this.tauxApplicable=null):(t.forEach(i=>{this.tauxApplicable=i.data().taux,this.montantMinim=i.data().montantMinim,console.log(this.montantMinim)}),console.log("Taux applicable :",this.tauxApplicable))}catch(t){console.error("Erreur lors de la r\xE9cup\xE9ration des donn\xE9es :",t),this.errChange="Une erreur est survenue lors de la r\xE9cup\xE9ration des donn\xE9es."}else{this.errChange="Choisissez le recepteur";return}else{this.errChange="Choisissez l'envoyeur";return}})}applyTaux(){this.montantRec="",this.errChange="",this.montantMinim="",this.calcul().then(()=>{this.opSend&&this.tauxApplicable&&this.montantSend&&(this.montantSend>=this.montantMinim?this.montantRec=this.montantSend*this.tauxApplicable:this.errChange="Le montant minimum est de "+this.montantMinim)})}static{this.\u0275fac=function(i){return new(i||n)(le(en),le(nr),le(rn))}}static{this.\u0275cmp=De({type:n,selectors:[["app-dashboard"]],standalone:!0,features:[Me],decls:130,vars:14,consts:[[1,"content"],[1,"titre"],[1,"p-4"],[1,"table","table-dark","table-striped","text-white","mt-4"],["colspan","7",1,"center","px-4"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn","btn-primary","w-100"],[1,"bi","bi-plus-circle"],[1,"text-warning","my-4","text-center"],[1,"p-4","text-white","option-container"],[1,"card","bg-info"],[1,"card-dash"],[1,"m-0"],[1,"log"],[1,"bi","bi-currency-dollar","text-primary"],[1,"card","bg-warning"],[1,"bi","bi-reception-1","text-danger"],[1,"card","bg-success"],[1,"bi","bi-check-circle-fill","text-success"],[1,"card","bg-danger"],[1,"bi","bi-x-circle-fill","text-warning"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","modal-lg","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-info"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["role","alert",1,"alert","alert-primary"],[1,"card","card-change","border-0","shadow"],[1,"card-body","border-0"],[1,"table","border-0","table-dark","table-striped"],[1,"border-0"],[1,"text-center"],["scope","col"],[1,"col-sm-10"],["type","text",1,"form-control",3,"ngModelChange","input","ngModel"],["type","text","disabled","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","change","ngModel"],[3,"value"],[1,"p-2"],[1,"mb-3"],["type","text","placeholder","Nom et pr\xE9nom",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","numero de t\xE9l\xE9phone",1,"form-control",3,"ngModelChange","ngModel"],[1,"card-footer","border-0"],[1,"btn","btn-warning","w-100","mb-2",3,"click","disabled"],["role","status",1,"spinner-border"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary","w-100"],["id","staticBackdrop2","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","modal-lg","fade"],[1,"btn","btn-danger","mx-1",3,"click"],[1,"bi","bi-trash"],[1,"btn","btn-info","mx-1"],[1,"btn","btn-info","mx-1",3,"click"],[1,"bi","bi-printer-fill"],["disabled","",1,"btn","btn-outline-light","w-100","border-0"],["role","status",1,"spinner-grow"],[1,"visually-hidden"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Tableau de Bord"),m()(),p(4,"div",2)(5,"table",3)(6,"thead")(7,"tr")(8,"th"),y(9,"Num\xE9ro"),m(),p(10,"th"),y(11,"Montant"),m(),p(12,"th"),y(13,"Etat"),m(),p(14,"th"),y(15,"Date d'initiation"),m(),p(16,"th"),y(17,"Taux de change"),m(),p(18,"th"),y(19,"Tel Recepteur"),m(),p(20,"th"),y(21,"Option"),m()()(),p(22,"tbody")(23,"tr")(24,"td",4)(25,"button",5),W(26,"i",6),y(27," Initier un transfert "),m()()(),Xe(28,R2,18,10,"tr",null,Ye),ge(30,P2,4,0,"tr"),m()()(),p(31,"h1",7),y(32,"Statistique"),m(),p(33,"div",8)(34,"div",9)(35,"div",10)(36,"div",2)(37,"h4",11),y(38,"0.00 $"),m(),p(39,"h5",11),y(40,"BALANCE"),m()(),p(41,"div",12),W(42,"i",13),m()()(),p(43,"div",14)(44,"div",10)(45,"div",2)(46,"h4",11),y(47),m(),p(48,"h5",11),y(49,"En cour..."),m()(),p(50,"div",12),W(51,"i",15),m()()(),p(52,"div",16)(53,"div",10)(54,"div",2)(55,"h4",11),y(56),m(),p(57,"h4",11),y(58,"Success"),m()(),p(59,"div",12),W(60,"i",17),m()()(),p(61,"div",18)(62,"div",10)(63,"div",2)(64,"h4",11),y(65),m(),p(66,"h4",11),y(67,"Echec"),m()(),p(68,"div",12),W(69,"i",19),m()()()()(),p(70,"div",20)(71,"div",21)(72,"div",22)(73,"div",23)(74,"h5",24),y(75,"Initier un tranfert"),m(),W(76,"button",25),m(),p(77,"div",26),ge(78,x2,2,1,"div",27),p(79,"div",28)(80,"div",29)(81,"table",30)(82,"thead",31)(83,"tr",32)(84,"th",33),y(85,"Envoyer"),m(),p(86,"th",33),y(87,"Recevoir"),m()()(),p(88,"tbody",31)(89,"tr")(90,"td")(91,"div",34)(92,"input",35),ce("ngModelChange",function(o){return ae(r.montantSend,o)||(r.montantSend=o),o}),ne("input",function(){return r.applyTaux()}),m()()(),p(93,"td")(94,"div",34)(95,"input",36),ce("ngModelChange",function(o){return ae(r.montantRec,o)||(r.montantRec=o),o}),m()()()(),p(96,"tr")(97,"td")(98,"div",34)(99,"select",37),ce("ngModelChange",function(o){return ae(r.opSend,o)||(r.opSend=o),o}),ne("change",function(){return r.applyTaux()}),Xe(100,D2,2,2,"option",38,Ye),m()()(),p(102,"td")(103,"div",34)(104,"select",37),ce("ngModelChange",function(o){return ae(r.opRe,o)||(r.opRe=o),o}),ne("change",function(){return r.applyTaux()}),Xe(105,M2,2,2,"option",38,Ye),m()()()()()(),p(107,"div",39),ge(108,k2,2,2,"h4")(109,O2,3,0),m(),p(110,"h5"),y(111,"Information Sur le recepteur"),m(),p(112,"div",40)(113,"input",41),ce("ngModelChange",function(o){return ae(r.nomR,o)||(r.nomR=o),o}),m()(),p(114,"div",40)(115,"input",42),ce("ngModelChange",function(o){return ae(r.telR,o)||(r.telR=o),o}),m()()(),p(116,"div",43)(117,"button",44),ne("click",function(){return r.addTransfert()}),y(118," Initier le transfert "),ge(119,N2,3,0,"div",45),m(),p(120,"button",46),y(121,"Anuler"),m()()()()()()(),p(122,"div",47)(123,"div",21)(124,"div",22)(125,"div",23)(126,"h5",24),y(127,"Transfert r\xE9ussi"),m(),W(128,"button",25),m(),W(129,"div",26),m()()()),i&2&&(S(28),Ze(r.transferts),S(2),me(30,r.transferts.length==0?30:-1),S(17),de(r.nbreEncour),S(9),de(r.nbreSuccess),S(9),de(r.nbreEchec),S(13),me(78,r.errChange!=""?78:-1),S(14),oe("ngModel",r.montantSend),S(3),oe("ngModel",r.montantRec),S(4),oe("ngModel",r.opSend),S(),Ze(r.monaies),S(4),oe("ngModel",r.opRe),S(),Ze(r.monaies),S(3),me(108,r.monaieR&&r.tauxApplicable&&r.monaieR?108:109),S(5),oe("ngModel",r.nomR),S(2),oe("ngModel",r.telR),S(2),bt("disabled",r.isAddingTrans),S(2),me(119,r.isAddingTrans?119:-1))},dependencies:[ln,xi,Di,zt,Mn,cn,Xt],styles:[".content[_ngcontent-%COMP%]{background-color:#12222b;min-height:100vh;padding-bottom:300px}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:30vh;display:flex;justify-content:center;align-items:center}.card-change[_ngcontent-%COMP%]{width:100%;text-align:center;padding:1rem;background:transparent;background:#def1fc}.logo-currency[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:contain;border-radius:50%}.around[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;align-items:center}.log[_ngcontent-%COMP%]{background-color:#fff;width:5rem;height:5rem;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:40px}.option-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-wrap:wrap}.option-container[_ngcontent-%COMP%]   .card-dash[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-right:2rem}.option-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:500px;height:150px;margin:2rem;transition:.5s all ease-in-out;border-radius:10px;cursor:pointer;-webkit-box-shadow:0px 0px 10px 0px rgba(0,0,0,.75);-moz-box-shadow:0px 0px 10px 0px rgba(0,0,0,.75);box-shadow:0 0 10px #000000bf}.option-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}"]})}}return n})();function V2(n,e){if(n&1){let t=gt();p(0,"tr")(1,"th",89),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td")(8,"span"),y(9),m()(),p(10,"td"),y(11),m(),p(12,"td",90)(13,"button",91),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.modifier(r))}),W(14,"i",10),m(),p(15,"button",92),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.annulerTrans(r.id))}),W(16,"i",93),m(),p(17,"button",94),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.writeToWhat(r.tel))}),W(18,"i",95),m()()()}if(n&2){let t=e.$implicit;S(2),de(t.num),S(2),de(t.tel),S(2),de(t.date),S(2),ni("badge bg-",t.couleur,""),S(),de(t.etat),S(2),de(t.montant)}}function F2(n,e){if(n&1&&(p(0,"div",36),y(1),m()),n&2){let t=Z();S(),$e(" ",t.msgErr," ")}}function L2(n,e){n&1&&(p(0,"div",44)(1,"span",25),y(2,"Loading..."),m()())}function U2(n,e){if(n&1&&(p(0,"div",36),y(1),m()),n&2){let t=Z();S(),$e(" ",t.msgErr," ")}}function j2(n,e){n&1&&(p(0,"div",50)(1,"span",25),y(2,"Loading..."),m()())}function B2(n,e){if(n&1){let t=gt();p(0,"tr")(1,"td"),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td")(8,"button",96),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.setMonaie(r))}),W(9,"i",97),m(),p(10,"button",98),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.deleteMonaie(r.id))}),W(11,"i",99),m()()()}if(n&2){let t=e.$implicit;S(2),de(t.pays),S(2),de(t.monaie),S(2),de(t.operateur)}}function q2(n,e){if(n&1&&(p(0,"div",36),y(1),m()),n&2){let t=Z();S(),$e(" ",t.msgErr," ")}}function $2(n,e){if(n&1&&(p(0,"option",56),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.monaie+", "+t.operateur+" ("+t.pays+")")}}function z2(n,e){if(n&1&&(p(0,"option",56),y(1),m()),n&2){let t=e.$implicit;pn("value",t.id),S(),de(t.monaie+", "+t.operateur+" ("+t.pays+")")}}function W2(n,e){if(n&1){let t=gt();p(0,"li",100),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.listOf(r.idUser))}),p(1,"div",101)(2,"div",102)(3,"div",103),y(4),m(),p(5,"div",104),y(6),m()(),p(7,"p",105),y(8),m()()()}if(n&2){let t=e.$implicit;S(4),de(t.tel),S(2),de(t.date),S(2),de(t.msg)}}function G2(n,e){if(n&1&&(p(0,"span",70),y(1),m()),n&2){let t=Z();S(),$e("to ",t.nomOf,"")}}function H2(n,e){}function K2(n,e){if(n&1&&(p(0,"div",106)(1,"div",107),y(2),m()()),n&2){let t=Z().$implicit;S(2),$e(" ",t.msg," ")}}function Q2(n,e){if(n&1&&(p(0,"div",108)(1,"div",107),y(2),m()()),n&2){let t=Z().$implicit;S(2),$e(" ",t.msg," ")}}function J2(n,e){if(n&1&&ge(0,K2,3,1,"div",106)(1,Q2,3,1),n&2){let t=e.$implicit;me(0,t.admin==!0?0:1)}}function Y2(n,e){if(n&1&&Xe(0,J2,2,1,null,null,Ye),n&2){let t=Z();Ze(t.msgOf)}}function X2(n,e){if(n&1){let t=gt();p(0,"tr",82)(1,"th",89),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td")(8,"button",109),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.deleteTaux(r.id))}),W(9,"i",93),m()()()}if(n&2){let t=e.$implicit;S(2),de(t.sender),S(2),de(t.reciever),S(2),de(t.taux)}}function Z2(n,e){if(n&1){let t=gt();p(0,"tr",82)(1,"th",89),y(2),m(),p(3,"td"),y(4),m(),p(5,"td"),y(6),m(),p(7,"td")(8,"button",109),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.deleteTaux(r.id))}),W(9,"i",97),m(),p(10,"button",109),ne("click",function(){let r=ye(t).$implicit,s=Z();return ve(s.deleteTaux(r.id))}),W(11,"i",93),m()()()}if(n&2){let t=e.$implicit;S(2),de(t.nom),S(2),de(t.telephone),S(2),de(t.email)}}var YC=(()=>{class n{goTo(t){this.router.navigate(["/"+t])}constructor(t,i,r,s,o){this.http=t,this.apiService=i,this.storage=r,this.Auth=s,this.firestore=o,this.router=Q(kt),this.selectedCountry="",this.pays="",this.countries=[],this.hasUser=!1,this.msgErr="",this.isadding=!1,this.monaies=[],this.isSaved=!1,this.nbreTransfert=0,this.transferts=[],this.messages=[],this.isSending=!1,this.msgOf=[],this.taux=[],this.verifications=[]}ngOnInit(){return E(this,null,function*(){this.getAuth(),this.getMonaie(),this.getTransfert(),yield this.getMsg(),this.getTaux()})}getAuth(){this.Auth.authState.subscribe(t=>{t&&(this.idUser=t?.uid,this.nom=t.email[0],this.hasUser=!0)})}setInitial(){this.monaie=this.pays}vider(){this.pays="",this.monaie="",this.operateur="",this.tVente="",this.tAchat=""}add(){return E(this,null,function*(){if(this.msgErr="",this.isadding=!0,this.pays,this.monaie){let t=[{pays:this.pays,monaie:this.monaie,operateur:this.operateur}];try{yield this.apiService.addDocuments("devises",t).then(()=>{this.msgErr="ajout\xE9 avec success",this.isadding=!1,this.vider()})}catch(i){this.msgErr="Erreur lors de l\u2019ajoutde la devise",console.error(i),this.isadding=!1}}else this.msgErr="Entrez toute les informations",this.isadding=!1})}getMonaie(){return E(this,null,function*(){this.firestore.collection("devises").get().subscribe(t=>{this.monaies=[],t.forEach(i=>{this.monaies.push({id:i.id,monaie:i.data().monaie,operateur:i.data().operateur,pays:i.data().pays})})})})}addTaux(){this.msgErr="",this.tauxChange&&this.currencyCode&&this.currencyCodeRecept?(this.isadding=!0,this.firestore.collection("tauxChange").add({taux:this.tauxChange,sender:this.currencyCode,reciever:this.currencyCodeRecept,montantMinim:this.montantMinim}).then(()=>{alert("ajout\xE9 avec success"),this.msgErr="",this.isadding=!1,this.currencyCode="",this.currencyCodeRecept="",this.tauxChange="",this.montantMinim=""})):this.msgErr="Remplir les champs obligatoire"}deleteMonaie(t){confirm("cette suppression est definitive")&&this.firestore.collection("devises").doc(t).delete().then(()=>{alert("Cette devise a \xE9t\xE9 supprim\xE9"),this.getMonaie()})}saveMonaie(t){try{this.isSaved=!0,this.firestore.collection("devises").doc(t).update({pays:this.pays,monaie:this.monaie,operateur:this.operateur}).then(()=>{alert("Modifi\xE9 avec success"),this.pays="",this.monaie="",this.operateur="",this.getMonaie(),this.isSaved=!1})}catch{this.isSaved=!1}}upload(t){this.fileSCover=t.target.files[0]}getTransfert(){this.transferts=[],this.firestore.collection("transferts").snapshotChanges(["added"]).subscribe(t=>{let i=0,r="";this.transferts=[],t.forEach(s=>{i++,s.payload.doc.data().etat=="en cour"&&(r="primary"),s.payload.doc.data().etat=="success"&&(r="success"),s.payload.doc.data().etat=="echec"&&(r="danger");let o=this.formatTimestampToDate(s.payload.doc.data().date);this.transferts.push({num:i,id:s.payload.doc.id,etat:s.payload.doc.data().etat,tel:s.payload.doc.data().tel,montant:s.payload.doc.data().montant+" => "+s.payload.doc.data().montantRecept,couleur:r,date:o})})})}formatTimestampToDate(t){if(!t||typeof t.seconds!="number")throw new Error("Le timestamp est invalide.");let i=new Date(t.seconds*1e3),r=String(i.getDate()).padStart(2,"0"),s=String(i.getMonth()+1).padStart(2,"0"),o=i.getFullYear(),c=String(i.getHours()).padStart(2,"0"),l=String(i.getMinutes()).padStart(2,"0");return`${r}/${s}/${o} ${c}:${l}`}extractTimestampValues(t){let i=/Timestamp\(seconds=(\d+), nanoseconds=(\d+)\)/,r=t.match(i);if(r){let s=parseInt(r[1],10),o=parseInt(r[2],10);return{seconds:s,nanoseconds:o}}return null}modifier(t){this.etatTrans=t.etat,this.numTrans=t.id,this.dateTrans=t.date}modifierEtat(){confirm("le client sera notifier du changement de statut. Voulez vous continuer?")&&this.firestore.collection("transferts").doc(this.numTrans).update({etat:this.status}).then(()=>{this.getTransfert()})}endTrans(t){}setMonaie(t){this.toUp=t.id,this.monaie=t.monaie,this.operateur=t.operateur,this.tAchat=t.tAchat,this.tVente=t.tVente,this.pays=t.pays}deleteTaux(t){confirm("Cette supression est d\xE9finitive. Voulez vous continuer?")&&this.firestore.collection("tauxChange").doc(t).delete().then(()=>{this.getTaux(),alert("supprim\xE9 avec success")})}annulerTrans(t){confirm("Voulez vous confirmer la suppression de ce transfert? cette suppression est definitive")&&this.firestore.collection("transferts").doc(t).delete().then(()=>{alert("suppression reussie"),this.getTransfert()})}writeToWhat(t){let r=`https://wa.me/${t.replace(/\D/g,"")}`;window.open(r,"_blank")}sendMsg(){this.msg&&this.idUserOf?(this.isSending=!0,this.firestore.collection("messages").add({message:this.msg,date:new Date,idUser:this.idUserOf,admin:!0}).then(()=>{this.msg="",this.isSending=!1})):alert("Erreur!")}listOf(t){this.msgOf=[],this.firestore.collection("messages",i=>i.where("idUser","==",t)).snapshotChanges(["added"]).subscribe(i=>{this.msgOf=[],i.forEach(r=>E(this,null,function*(){this.firestore.collection("profiles",s=>s.where("idUser","==",r.payload.doc.data().idUser)).get().subscribe(s=>{s.forEach(o=>{this.nomOf=o.data().tel,this.idUserOf=r.payload.doc.data().idUser;let c=this.formatTimestampToTime(r.payload.doc.data().date);this.msgOf.push({id:r.payload.doc.id,msg:r.payload.doc.data().message,idUser:r.payload.doc.data().idUser,date:c,email:o.data().email,tel:o.data().tel,nom:o.data().email[0],admin:r.payload.doc.data().admin}),this.sortMessagesByDate(this.msgOf)})})}))})}getUser(t){this.firestore.collection("profiles",i=>i.where("idUser","==",t)).get().subscribe(i=>{i.forEach(r=>r.data().tel)})}getMsg(){this.messages=[],this.firestore.collection("messages").snapshotChanges(["added"]).subscribe(t=>{this.messages=[],t.forEach(i=>E(this,null,function*(){let r=i.payload.doc.data().idUser;this.firestore.collection("profiles",s=>s.where("idUser","==",r)).get().subscribe(s=>{s.forEach(o=>{let c=this.formatTimestampToTime(i.payload.doc.data().date);this.messages.push({id:i.payload.doc.id,msg:i.payload.doc.data().message,idUser:r,date:c,email:o.data().email,tel:o.data().tel,nom:o.data().email[0]}),this.messages=this.filterMessagesByUser(this.messages)})})}))}),this.listOf(this.idUser)}filterMessagesByUser(t){let i=[],r=new Map;return t.forEach(s=>{let o=s.idUser,c=s.date;if(!r.has(o))r.set(o,s);else{let u=r.get(o).date;c>u&&r.set(o,s)}}),i=Array.from(r.values()),i}sortMessagesByDate(t){return t.sort((i,r)=>{let s=i.date,o=r.date;return s<o?-1:s>o?1:0})}formatTimestampToTime(t){let i=new Date(t.seconds*1e3),s=new Date-i,o=Math.floor(s/(1e3*3600*24));if(o>0)return o===1?"Plus t\xF4t il y a 1 jour":`Plus t\xF4t il y a ${o} jours`;let c=i.getHours().toString().padStart(2,"0"),l=i.getMinutes().toString().padStart(2,"0");return`${c}:${l}`}getTaux(){return E(this,null,function*(){this.taux=[];let i=(yield this.firestore.collection("tauxChange").get().toPromise()).docs.map(r=>E(this,null,function*(){let s=yield this.getDecOf(r.data().sender),o=yield this.getDecOf(r.data().reciever);console.log(r.id),this.taux.push({id:r.id,sender:s,reciever:o,taux:r.data().taux})}))})}getDecOf(t){return E(this,null,function*(){let r=(yield this.firestore.collection("devises").doc(t).get().toPromise()).data();return`${r.pays} (${r.pays})`})}getVerification(){this.firestore.collection("verifications").get().subscribe(t=>{t.forEach(i=>{})})}static{this.\u0275fac=function(i){return new(i||n)(le(gn),le(nr),le(_i),le(en),le(rn))}}static{this.\u0275cmp=De({type:n,selectors:[["app-admin"]],standalone:!0,features:[Me],decls:297,vars:30,consts:[[1,"content"],[1,"titre"],[1,"position-relative"],[1,"option"],[1,"card","bg-dark","p-2","text-warning","text-center","shadow"],[1,"text-white"],[1,"d-flex","btnOp","w-100"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn","btn-success"],[1,"bi","bi-patch-plus-fill"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop2",1,"btn","btn-danger",3,"click"],[1,"bi","bi-pencil-fill"],[1,"d-flex","center","w-100"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop3",1,"btn","btn-primary","mb-1"],[1,"bi","bi-graph-up-arrow"],["data-bs-toggle","modal","data-bs-target","#exampleModal3",1,"btn","btn-danger",3,"click"],[1,"bi","bi-trash-fill"],["data-bs-toggle","modal","data-bs-target","#exampleModal2",1,"card","bg-dark","p-2","text-warning","text-center","shadow"],[1,"btn","btn-primary","position-relative"],[1,"bi","bi-chat-dots-fill"],[1,"position-absolute","top-0","start-100","translate-middle","badge","rounded-pill","bg-danger"],["data-bs-toggle","modal","data-bs-target","#exampleModal4",1,"card","bg-dark","p-2","text-warning","text-center","shadow"],[1,"w-100","p-4","text-white","center"],[1,"text-center","text-white","bold"],["type","button",1,"btn","btn-primary","position-relative"],[1,"bi","bi-bell-fill"],[1,"visually-hidden"],[1,"table","table-dark","table-striped","text-white","w-100","mt-4"],["scope","col"],["scope","col",1,"text-center"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-info"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close","text-white"],[1,"modal-body"],[1,"alert","bg-info"],[1,"mb-3"],[1,"form-label"],[1,"text-danger"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button","id","closeModal","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["role","status",1,"spinner-border","spinner-border-sm"],["id","staticBackdrop2","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","modal-xl","fade"],[1,"row"],[1,"col"],[1,"p-4","text-center"],[1,"btn","btn-success","w-75",3,"click","disabled"],["role","status",1,"spinner-border"],[1,"container"],[1,"table","table-dark","table-striped","w-100"],["id","staticBackdrop3","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"form-label","fs-5"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],["type","number",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-success",3,"click","disabled"],["id","exampleModal2","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade","modal-xl"],[1,"modal-content","msg-list","m-0"],[1,"modal-body","m-0","p-0"],[1,"list"],[1,"w-100","center","p-2"],[1,"logo"],[1,"list-group"],[1,"pt-2"],[1,"body-msg"],[1,"w-100","shadow","p-3","d-flex","justify-content-between"],[1,"m-0"],[1,"text-sm","text-dark-50"],["data-bs-dismiss","modal",1,"btn","btn-outline-info"],[1,"bi","bi-x-lg"],[1,"w-100","p-2","text-sm","msg-box-contain","border-2"],[1,"footer","w-100","shadow-lg"],[1,"msb-reply","w-100","position-relative"],["placeholder","What's on your mind...",1,"border-0",3,"ngModelChange","ngModel"],[1,"btn","btn-success",3,"click","disabled"],[1,"bi","bi-send-fill"],["id","exampleModal3","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade","modal-xl"],[1,"w-100"],[1,"table","table-dark","table-striped"],[1,"pointer"],["id","staticBackdrop4","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"w-100","mb-3","text-center"],["value","en cour"],["value","success"],["value","echec"],["id","exampleModal4","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade","modal-xl"],["scope","row"],[1,"text-center"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop4",1,"btn","btn-primary","mx-2",3,"click"],[1,"btn","btn-danger","mx-2",3,"click"],[1,"bi","bi-trash"],[1,"btn","btn-success","mx-2",3,"click"],[1,"bi","bi-whatsapp"],[1,"btn","btn-info","mx-1",3,"click"],[1,"bi","bi-pencil"],[1,"btn","btn-danger","mx-1",3,"click"],[1,"bi","bi-trash3"],[3,"click"],[1,"contain"],[1,"tete"],[1,"nom"],[1,"heure"],[1,"text-dark-50"],[1,"receiver"],[1,"msg-box"],[1,"sender"],[1,"btn","btn-danger","mx-1","btn-sm",3,"click"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1)(2,"h1"),y(3,"Tableau de Bord administrateur"),m()(),p(4,"div",2)(5,"div",3)(6,"div",4)(7,"h4"),y(8," G\xE9rer les Devises"),m(),p(9,"p",5),y(10," Ajoutez une nouvelle devise! "),m(),p(11,"div",6)(12,"button",7),y(13,"Ajouter "),W(14,"i",8),m(),p(15,"button",9),ne("click",function(){return r.getMonaie()}),y(16,"Modifier "),W(17,"i",10),m()()(),p(18,"div",4)(19,"h4"),y(20,"Taux de change"),m(),p(21,"p",5),y(22," Gerer les taux de change ici! "),m(),p(23,"div",11)(24,"button",12),W(25,"i",13),y(26," Taux de change "),m(),p(27,"button",14),ne("click",function(){return r.getTaux()}),y(28,"Delete "),W(29,"i",15),m()()(),p(30,"div",16)(31,"h4"),y(32,"Messages"),m(),p(33,"p",5),y(34," G\xE9rez les messages ici! "),m(),p(35,"div",11)(36,"button",17),W(37,"i",18),p(38,"span",19),y(39),m()()()(),p(40,"div",20)(41,"h4"),y(42,"V\xE9rification"),m(),p(43,"p",5),y(44," Valider vos utilisateurs! "),m(),p(45,"div",11)(46,"button",17),W(47,"i",18),p(48,"span",19),y(49),m()()()()()(),p(50,"div",21)(51,"h1",22),y(52," Transfert en cour.. "),p(53,"button",23),W(54,"i",24),p(55,"span",19),y(56),p(57,"span",25),y(58,"unread messages"),m()()()(),p(59,"table",26)(60,"thead")(61,"tr")(62,"th",27),y(63,"Num\xE9ro"),m(),p(64,"th",27),y(65,"Telephone"),m(),p(66,"th",27),y(67,"Date"),m(),p(68,"th",27),y(69,"Etat"),m(),p(70,"th",27),y(71,"Montant"),m(),p(72,"th",28),y(73,"Option"),m()()(),p(74,"tbody"),Xe(75,V2,19,8,"tr",null,Ye),m()()()(),p(77,"div",29)(78,"div",30)(79,"div",31)(80,"div",32)(81,"h5",33),y(82,"Ajouter une Devise"),m(),W(83,"button",34),m(),p(84,"div",35),ge(85,F2,2,1,"div",36),p(86,"div",37)(87,"label",38),y(88,"Pays "),p(89,"span",39),y(90,"*"),m()(),p(91,"input",40),ce("ngModelChange",function(o){return ae(r.pays,o)||(r.pays=o),o}),m()(),p(92,"div",37)(93,"label",38),y(94," Code de la monaie(ex : XAF) "),p(95,"span",39),y(96,"*"),m()(),p(97,"input",40),ce("ngModelChange",function(o){return ae(r.monaie,o)||(r.monaie=o),o}),m()(),p(98,"div",37)(99,"label",38),y(100,"Op\xE9rateur(ex : Orange money)"),m(),p(101,"input",40),ce("ngModelChange",function(o){return ae(r.operateur,o)||(r.operateur=o),o}),m()()(),p(102,"div",41)(103,"button",42),y(104,"Fermer"),m(),p(105,"button",43),ne("click",function(){return r.add()}),y(106," Ajouter "),ge(107,L2,3,0,"div",44),m()()()()(),p(108,"div",45)(109,"div",30)(110,"div",31)(111,"div",32)(112,"h5",33),y(113,"Modifier vos Devises"),m(),W(114,"button",34),m(),p(115,"div",35),ge(116,U2,2,1,"div",36),p(117,"div",46)(118,"div",47)(119,"div",37)(120,"label",38),y(121,"Pays"),m(),p(122,"input",40),ce("ngModelChange",function(o){return ae(r.pays,o)||(r.pays=o),o}),m()()(),p(123,"div",47)(124,"div",37)(125,"label",38),y(126,"Monaie"),m(),p(127,"input",40),ce("ngModelChange",function(o){return ae(r.monaie,o)||(r.monaie=o),o}),m()()()(),p(128,"div",37)(129,"label",38),y(130,"Operateur"),m(),p(131,"input",40),ce("ngModelChange",function(o){return ae(r.operateur,o)||(r.operateur=o),o}),m()(),p(132,"div",48)(133,"button",49),ne("click",function(){return r.saveMonaie(r.toUp)}),y(134," Enregistrer "),ge(135,j2,3,0,"div",50),m()(),p(136,"div",51)(137,"table",52)(138,"thead")(139,"tr")(140,"th",27),y(141,"Pays"),m(),p(142,"th",27),y(143,"Monaie"),m(),p(144,"th",27),y(145,"Op\xE9rateur"),m(),p(146,"th",27),y(147,"Option"),m()()(),p(148,"tbody"),Xe(149,B2,12,3,"tr",null,Ye),m()()()(),p(151,"div",41)(152,"button",42),y(153,"Fermer"),m()()()()(),p(154,"div",53)(155,"div",30)(156,"div",31)(157,"div",32)(158,"h5",33),y(159,"Taux de change"),m(),W(160,"button",34),m(),p(161,"div",35),ge(162,q2,2,1,"div",36),p(163,"div",37)(164,"label",54),y(165,"Device source"),m(),p(166,"select",55),ce("ngModelChange",function(o){return ae(r.currencyCode,o)||(r.currencyCode=o),o}),Xe(167,$2,2,2,"option",56,Ye),m()(),p(169,"div",37)(170,"label",54),y(171,"Device recepteur"),m(),p(172,"select",55),ce("ngModelChange",function(o){return ae(r.currencyCodeRecept,o)||(r.currencyCodeRecept=o),o}),Xe(173,z2,2,2,"option",56,Ye),m()(),p(175,"div",37)(176,"label",54),y(177,"Taux de change"),m(),p(178,"input",57),ce("ngModelChange",function(o){return ae(r.tauxChange,o)||(r.tauxChange=o),o}),m()(),p(179,"div",37)(180,"label",54),y(181,"Montant minimum"),m(),p(182,"input",57),ce("ngModelChange",function(o){return ae(r.montantMinim,o)||(r.montantMinim=o),o}),m()()(),p(183,"div",41)(184,"button",42),y(185,"Fermer"),m(),p(186,"button",58),ne("click",function(){return r.addTaux()}),y(187,"Ajouter"),m()()()()(),p(188,"div",59)(189,"div",30)(190,"div",60)(191,"div",61)(192,"div",62)(193,"div",63)(194,"div",64),y(195,"KSC"),m()(),p(196,"ul",65),W(197,"div",66),Xe(198,W2,9,3,"li",null,Ye),m()(),p(200,"div",67)(201,"div",68)(202,"div")(203,"h5",69),y(204,"KscXchange"),m(),ge(205,G2,2,1,"span",70),m(),p(206,"div")(207,"button",71),W(208,"i",72),m()()(),p(209,"div",73),ge(210,H2,0,0)(211,Y2,2,0),m(),p(212,"div",74)(213,"div",75)(214,"textarea",76),ce("ngModelChange",function(o){return ae(r.msg,o)||(r.msg=o),o}),m(),p(215,"button",77),ne("click",function(){return r.sendMsg()}),W(216,"i",78),m()()()()()()()(),p(217,"div",79)(218,"div",30)(219,"div",60)(220,"div",32)(221,"h5",33),y(222,"Modifier le taux de change"),m(),W(223,"button",34),m(),p(224,"div",35)(225,"div",80)(226,"h4"),y(227,"Vos taux de change"),m(),p(228,"table",81)(229,"thead")(230,"tr")(231,"th",27),y(232,"Sender"),m(),p(233,"th",27),y(234,"Reciever"),m(),p(235,"th",27),y(236,"Taux de change"),m(),p(237,"th",27),y(238,"Action"),m()()(),p(239,"tbody"),Xe(240,X2,10,3,"tr",82,Ye),m()()()()()()(),p(242,"div",83)(243,"div",30)(244,"div",31)(245,"div",32)(246,"h5",33),y(247,"Etat Transfert"),m(),W(248,"button",34),m(),p(249,"div",35)(250,"div",84)(251,"h5"),y(252),m(),p(253,"h6"),y(254),m(),p(255,"h6"),y(256),m()(),p(257,"div",37)(258,"label",54),y(259,"Changer le Statut de ce tranfert"),m(),p(260,"select",55),ce("ngModelChange",function(o){return ae(r.status,o)||(r.status=o),o}),p(261,"option",85),y(262,"En cour"),m(),p(263,"option",86),y(264,"Succ\xE8s"),m(),p(265,"option",87),y(266,"Echec"),m()()()(),p(267,"div",41)(268,"button",42),y(269,"Fermer"),m(),p(270,"button",58),ne("click",function(){return r.modifierEtat()}),y(271,"Modifier"),m()()()()(),p(272,"div",88)(273,"div",30)(274,"div",60)(275,"div",32)(276,"h5",33),y(277,"G\xE9rer les v\xE9rifications"),m(),W(278,"button",34),m(),p(279,"div",35)(280,"div",80)(281,"h4"),y(282,"V\xE9rification"),m(),p(283,"table",81)(284,"thead")(285,"tr")(286,"th",27),y(287,"Nom"),m(),p(288,"th",27),y(289,"Telephone"),m(),p(290,"th",27),y(291,"email"),m(),p(292,"th",27),y(293,"Action"),m()()(),p(294,"tbody"),Xe(295,Z2,12,3,"tr",82,Ye),m()()()()()()()),i&2&&(S(39),$e(" ",r.messages.length," "),S(10),$e(" ",r.verifications.length," "),S(7),$e(" ",r.transferts.length," "),S(19),Ze(r.transferts),S(10),me(85,r.msgErr?85:-1),S(6),oe("ngModel",r.pays),S(6),oe("ngModel",r.monaie),S(4),oe("ngModel",r.operateur),S(4),bt("disabled",r.isadding),S(2),me(107,r.isadding?107:-1),S(9),me(116,r.msgErr?116:-1),S(6),oe("ngModel",r.pays),S(5),oe("ngModel",r.monaie),S(4),oe("ngModel",r.operateur),S(2),bt("disabled",r.isSaved),S(2),me(135,r.isSaved?135:-1),S(14),Ze(r.monaies),S(13),me(162,r.msgErr?162:-1),S(4),oe("ngModel",r.currencyCode),S(),Ze(r.monaies),S(5),oe("ngModel",r.currencyCodeRecept),S(),Ze(r.monaies),S(5),oe("ngModel",r.tauxChange),S(4),oe("ngModel",r.montantMinim),S(4),bt("disabled",r.isadding),S(12),Ze(r.messages),S(7),me(205,r.msgOf.length>0?205:-1),S(5),me(210,r.messages.length==0?210:211),S(4),oe("ngModel",r.msg),S(),bt("disabled",r.isSending||!r.msg),S(25),Ze(r.taux),S(12),$e("transfert numero ",r.numTrans," "),S(2),$e("Date: ",r.dateTrans,""),S(2),$e("Status: ",r.etatTrans,""),S(4),oe("ngModel",r.status),S(10),bt("disabled",r.isadding),S(25),Ze(r.verifications))},dependencies:[ln,xi,Di,zt,Ma,Mn,cn,Xt],styles:[".content[_ngcontent-%COMP%]{background-color:#12222b;min-height:100vh;padding-bottom:300px;position:relative}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:40vh;display:flex;justify-content:center;align-items:center}.text-sm[_ngcontent-%COMP%]{font-size:12px}.option[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;padding:2rem;flex-wrap:wrap}.option[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:300px;border-radius:10px;cursor:pointer;transition:.3s all ease-in-out;margin:2rem}.option[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .btnOp[_ngcontent-%COMP%]{justify-content:space-between}.option[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.center[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.message[_ngcontent-%COMP%]{cursor:pointer;position:fixed;top:80vh;right:2rem;padding:.2rem;width:5rem;height:5rem;background:#edeff01a;transition:.5s all ease-in-out;border-radius:10px}.message[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.modal-body-msg[_ngcontent-%COMP%]{min-height:50vh;display:flex}.msg-box-contain[_ngcontent-%COMP%]{height:75%;overflow:auto}.sender[_ngcontent-%COMP%]{display:flex;margin:.5rem 0rem;cursor:pointer}.sender[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%]{background:#7c7c7c;max-width:80%;padding:.5rem;border-radius:10px;margin:.2rem;color:#fff}.receiver[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:flex-end;cursor:pointer}.receiver[_ngcontent-%COMP%]   .msg-box[_ngcontent-%COMP%]{background:#222;max-width:80%;padding:.5rem;border-radius:10px;margin-right:1rem;margin:.2rem;color:#fff}.msb-reply[_ngcontent-%COMP%]{display:flex}.msb-reply[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;font-size:13px;border:0;padding:10px 15px;resize:none;height:60px;background:0 0}.msg-list[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{display:flex;background:#c3ffff4d;min-height:90vh}.msg-list[_ngcontent-%COMP%]   .list[_ngcontent-%COMP%]{width:35%;height:95%;overflow:auto}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;transition:all ease-in-out .2s}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#95e0e04d}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   .contain[_ngcontent-%COMP%]{padding:.5rem;border-bottom:1px solid rgba(20,110,161,.2);cursor:pointer;margin-top:10px;margin-left:20px}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   .contain[_ngcontent-%COMP%]   .tete[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   .contain[_ngcontent-%COMP%]   .tete[_ngcontent-%COMP%]   .heure[_ngcontent-%COMP%]{font-size:11px}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   .contain[_ngcontent-%COMP%]   .tete[_ngcontent-%COMP%]   .nom[_ngcontent-%COMP%]{font-weight:700}.msg-list[_ngcontent-%COMP%]   .list-group[_ngcontent-%COMP%]   .contain[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:11px;margin:0;padding:0;margin-left:.3rem}.msg-list[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:3rem;height:3rem;display:flex;justify-content:center;align-items:center;background:#1c5743;color:#e3f2fd;border-radius:50%}.msg-list[_ngcontent-%COMP%]   .body-msg[_ngcontent-%COMP%]{width:65%;padding:0;border-left:1px solid rgba(20,110,161,.2);position:relative}.msg-list[_ngcontent-%COMP%]   .body-msg[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{position:absolute;bottom:2px}"]})}}return n})();function eV(n,e){n&1&&(p(0,"div",11),y(1," Vous devez mettre vos informations \xE0 jour. "),m())}function tV(n,e){n&1&&(p(0,"div",23)(1,"span",24),y(2,"Loading..."),m()())}function nV(n,e){if(n&1){let t=gt();p(0,"div",10),ge(1,eV,2,0,"div",11),p(2,"div",12)(3,"div",13)(4,"label",14),y(5,"Nom "),p(6,"span",15),y(7,"*"),m()(),p(8,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.nom,r)||(s.nom=r),ve(r)}),m()(),p(9,"div",13)(10,"label",14),y(11,"Prenom "),p(12,"span",15),y(13,"*"),m()(),p(14,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.prenom,r)||(s.prenom=r),ve(r)}),m()()(),p(15,"div",12)(16,"div",13)(17,"label",14),y(18,"Nom d'utilisateur "),p(19,"span",15),y(20,"*"),m()(),p(21,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.username,r)||(s.username=r),ve(r)}),m()(),p(22,"div",13)(23,"label",17),y(24,"Adresse Email "),p(25,"span",15),y(26,"*"),m()(),p(27,"input",18),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.email,r)||(s.email=r),ve(r)}),m()()(),p(28,"div",12)(29,"div",13)(30,"label",14),y(31,"telephone"),p(32,"span",15),y(33,"*"),m()(),p(34,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.tel,r)||(s.tel=r),ve(r)}),m()()(),p(35,"div",19)(36,"textarea",20),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.adresse,r)||(s.adresse=r),ve(r)}),m(),p(37,"label",21),y(38,"Votre adresse"),m()(),p(39,"button",22),ne("click",function(){ye(t);let r=Z();return ve(r.updateProf())}),y(40," Mettre \xE0 jour "),ge(41,tV,3,0,"div",23),m()()}if(n&2){let t=Z();S(),me(1,!t.nom||!t.prenom||!t.username||!t.email?1:-1),S(7),oe("ngModel",t.nom),S(6),oe("ngModel",t.prenom),S(7),oe("ngModel",t.username),S(6),oe("ngModel",t.email),S(7),oe("ngModel",t.tel),S(2),oe("ngModel",t.adresse),S(3),bt("disabled",t.isUpdating),S(2),me(41,t.isUpdating?41:-1)}}function iV(n,e){n&1&&(p(0,"div",11),y(1," Vous devez mettre vos informations \xE0 jour. "),m())}function rV(n,e){n&1&&(p(0,"div",23)(1,"span",24),y(2,"Loading..."),m()())}function sV(n,e){if(n&1){let t=gt();p(0,"div",10),ge(1,iV,2,0,"div",11),p(2,"div",12)(3,"div",13)(4,"label",14),y(5,"Nom "),p(6,"span",15),y(7,"*"),m()(),p(8,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.nom,r)||(s.nom=r),ve(r)}),m()(),p(9,"div",13)(10,"label",14),y(11,"Prenom "),p(12,"span",15),y(13,"*"),m()(),p(14,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.prenom,r)||(s.prenom=r),ve(r)}),m()()(),p(15,"div",12)(16,"div",13)(17,"label",14),y(18,"num\xE9ro de la pi\xE8ce d'identit\xE9 "),p(19,"span",15),y(20,"*"),m()(),p(21,"input",16),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.idPiece,r)||(s.idPiece=r),ve(r)}),m()(),p(22,"div",25)(23,"label",14),y(24,"Selfie "),p(25,"span",15),y(26,"*"),m()(),p(27,"input",26),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.selfie,r)||(s.selfie=r),ve(r)}),m()()(),p(28,"div",12)(29,"div",25)(30,"label",14),y(31,"image recto de la pi\xE8ce d'identit\xE9(passport, CNI, permis de conduire)"),p(32,"span",15),y(33,"*"),m()(),p(34,"input",26),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.rectoId,r)||(s.rectoId=r),ve(r)}),m()(),p(35,"div",25)(36,"label",14),y(37,"image verseau de la pi\xE8ce d'identit\xE9(passport, CNI, permis de conduire)"),p(38,"span",15),y(39,"*"),m()(),p(40,"input",26),ce("ngModelChange",function(r){ye(t);let s=Z();return ae(s.verseauId,r)||(s.verseauId=r),ve(r)}),m()()(),p(41,"button",22),ne("click",function(){ye(t);let r=Z();return ve(r.sendToVerif())}),y(42," Envoyer "),ge(43,rV,3,0,"div",23),m()()}if(n&2){let t=Z();S(),me(1,!t.nom||!t.prenom||!t.username||!t.email?1:-1),S(7),oe("ngModel",t.nom),S(6),oe("ngModel",t.prenom),S(7),oe("ngModel",t.idPiece),S(6),oe("ngModel",t.selfie),S(7),oe("ngModel",t.rectoId),S(6),oe("ngModel",t.verseauId),S(),bt("disabled",t.isUpdating),S(2),me(43,t.isUpdating?43:-1)}}var XC=(()=>{class n{ngOnInit(){this.getAuth()}constructor(t,i,r,s,o,c){this.firestore=t,this.storage=i,this.route=r,this.Auth=s,this.apiservice=o,this.http=c,this.router=Q(kt),this.isUpdating=!1,this.option=!1,this.etatI="active",this.etatV="active"}getAuth(){this.Auth.authState.subscribe(t=>{t?(this.idUser=t?.uid,this.email=t.email,this.getProfile()):this.router.navigate(["/acceuil"])})}updateProf(){this.isUpdating=!0,this.firestore.collection("profiles").doc(this.idProfile).update({nom:this.nom,prenom:this.prenom,tel:this.tel,username:this.username,adresse:this.adresse}).then(()=>{this.isUpdating=!1,alert("modification r\xE9ussie")})}getProfile(){this.firestore.collection("profiles",t=>t.where("idUser","==",this.idUser)).get().subscribe(t=>{t.forEach(i=>{this.tel=i.data().tel,this.idProfile=i.id,this.email=i.data().email,this.prenom=i.data().prenom,this.nom=i.data().nom,this.username=i.data().username,this.adresse=i.data().adresse})})}setNav(t){t=="ip"?(this.option=!1,this.etatI="active",this.etatV=""):(this.option=!0,this.etatV="active",this.etatI=""),console.log(this.option)}sendToVerif(){}static{this.\u0275fac=function(i){return new(i||n)(le(rn),le(_i),le(xn),le(en),le(nr),le(gn))}}static{this.\u0275cmp=De({type:n,selectors:[["app-profile"]],standalone:!0,features:[Me],decls:16,vars:8,consts:[[1,"content"],[1,"titre"],["src","","alt",""],[1,"p-card","w-100","p-4"],[1,"box-pp","center"],[1,"nav","nav-tabs","mt-2","w-100"],[1,"nav-item",3,"click"],["aria-current","page"],[3,"click"],[1,"nav-link"],[1,"info-perso","text-white","p-4"],["role","alert",1,"alert","alert-danger"],[1,"row"],[1,"col","mb-3"],[1,"form-label"],[1,"text-danger"],["type","text",1,"form-control",3,"ngModelChange","ngModel"],["disabled","",1,"form-label"],["type","email",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-floating","mb-3"],["placeholder","saisir votre adresse",1,"form-control",2,"height","100px",3,"ngModelChange","ngModel"],[1,"form-label","text-dark"],[1,"btn","btn-primary","w-100",3,"click","disabled"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"visually-hidden"],[1,"mb-3"],["type","file",1,"form-control",3,"ngModelChange","ngModel"]],template:function(i,r){i&1&&(p(0,"div",0)(1,"div",1),W(2,"img",2),p(3,"h1"),y(4,"Profile"),m()(),p(5,"div",3)(6,"div",4)(7,"ul",5)(8,"li",6),ne("click",function(){return r.setNav("ip")}),p(9,"a",7),y(10,"Information personnelle"),m()(),p(11,"li",8),ne("click",function(){return r.setNav("verif")}),p(12,"a",9),y(13,"V\xE9rification"),m()()(),ge(14,nV,42,9,"div",10)(15,sV,44,9,"div",10),m()()()),i&2&&(S(9),ni("nav-link ",r.etatI,""),S(2),ni("nav-item ",r.etatV,""),S(3),me(14,r.option?-1:14),S(),me(15,r.option?15:-1))},dependencies:[ln,zt,cn,Xt],styles:[".content[_ngcontent-%COMP%]{background-color:#12222b;min-height:100vh;padding-bottom:500px}.titre[_ngcontent-%COMP%]{background-color:#e3f2fd;width:100%;min-height:30vh;display:flex;justify-content:center;align-items:center}.center[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.nav-item[_ngcontent-%COMP%]{cursor:pointer}.box-pp[_ngcontent-%COMP%]{width:100%}.info-perso[_ngcontent-%COMP%]{width:60%}"]})}}return n})();var ZC=[{path:"",component:Z_},{path:"acceuil",component:Z_},{path:"about",component:fT},{path:"rate",component:pT},{path:"faq",component:mT},{path:"contact",component:hT},{path:"login",component:lC},{path:"inscription",component:QC},{path:"dash",component:JC},{path:"admin",component:YC},{path:"profil",component:XC}];var oV="@",aV=(()=>{class n{constructor(t,i,r,s,o){this.doc=t,this.delegate=i,this.zone=r,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Q(uv,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-4RJWDF6T.js")).catch(i=>{throw new Ge(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:r})=>{this._engine=i(this.animationType,this.doc,this.scheduler);let s=new r(this.delegate,this._engine,this.zone);return this.delegate=s,s})}createRenderer(t,i){let r=this.delegate.createRenderer(t,i);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let s=new q0(r);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(t,i);s.use(c)}).catch(o=>{s.use(r)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(i){Lh()}}static{this.\u0275prov=ue({token:n,factory:n.\u0275fac})}}return n})(),q0=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,i,r){this.delegate.insertBefore(e,t,i,r)}removeChild(e,t,i){this.delegate.removeChild(e,t,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){this.shouldReplay(t)&&this.replay.push(r=>r.setProperty(e,t,i)),this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.shouldReplay(t)&&this.replay.push(r=>r.listen(e,t,i)),this.delegate.listen(e,t,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(oV)}};function eA(n="animations"){return Uh("NgAsyncAnimations"),cr([{provide:il,useFactory:(e,t,i)=>new aV(e,t,i,n),deps:[Mt,Sl,Re]},{provide:lv,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Oc=class{constructor(e){return e}},tA="firestore",$0=class{constructor(){return ka(tA)}};var z0=new te("angularfire2.firestore-instances");function cV(n,e){let t=Yl(tA,n,e);return t&&new Oc(t)}function lV(n){return(e,t)=>{let i=e.runOutsideAngular(()=>n(t));return new Oc(i)}}var uV={provide:$0,deps:[[new Et,z0]]},dV={provide:Oc,useFactory:cV,deps:[[new Et,z0],ii]},hV=(()=>{class n{constructor(){ht("angularfire",_t.full,"fst")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[dV,uV]})}return n})();function nA(n,...e){return{ngModule:hV,providers:[{provide:z0,useFactory:lV(n),multi:!0,deps:[Re,ei,Wt,gr,[new Et,Rc],[new Et,Zt],...e]}]}}var iA=_n($I,!0);var fV=new te("angularfire2.messaging.vapid-key"),pV=new te("angularfire2.messaging.service-worker-registeration"),mV=(()=>{class n{requestPermission;getToken;tokenChanges;messages;requestToken;deleteToken;constructor(t,i,r,s,o,c,l){let u=l,h=X(void 0).pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(Av),Ce(b=>b?import("./chunk-7E2WHDUH.js"):An),se(()=>ri(t,s,i)),Ce(b=>ki(`${b.name}.messaging`,"AngularFireMessaging",b.name,()=>X(b.messaging()),[])),Xo({bufferSize:1,refCount:!1}));this.requestPermission=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(()=>Notification.requestPermission())),this.getToken=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(b=>E(this,null,function*(){if(Notification.permission==="granted"){let O=u?yield u:null;return yield b.getToken({vapidKey:c,serviceWorkerRegistration:O})}else return null})));let g=new wt(b=>{navigator.permissions.query({name:"notifications"}).then(O=>{O.onchange=()=>b.next()})}),v=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),ns(g),ns(this.getToken));return this.tokenChanges=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(()=>el(this.getToken,v))),this.messages=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(b=>new wt(O=>b.onMessage(O)))),this.requestToken=h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(()=>this.requestPermission),bi(()=>X(null)),$t(()=>this.tokenChanges)),this.deleteToken=()=>h.pipe(Dt(o.outsideAngular),mt(o.insideAngular),Ce(b=>b.deleteToken()),Yo(!1)),tu(this,h,s)}static \u0275fac=function(i){return new(i||n)(j(kn),j(On,8),j(dt),j(Re),j(Wt),j(fV,8),j(pV,8))};static \u0275prov=ue({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),rA=(()=>{class n{constructor(){tt.registerVersion("angularfire",_t.full,"fcm-compat")}static \u0275fac=function(i){return new(i||n)};static \u0275mod=qe({type:n});static \u0275inj=Be({providers:[mV]})}return n})();var sA={apiKey:"AIzaSyC9zqi7yxliobvsBqJOZQUzlPbBLnXgEqE",authDomain:"kscxchange-f9e5a.firebaseapp.com",projectId:"kscxchange-f9e5a",storageBucket:"kscxchange-f9e5a.firebasestorage.app",messagingSenderId:"347996611117",appId:"1:347996611117:web:5652e5ba403fcc34248ea4",measurementId:"G-EWZ5QYQ5R7"},oA={providers:[Cw(ZC),eA(),sv([aE.initializeApp(sA),dT,KC,cE,rA,Wv,Hw(()=>Kw(sA)),nC(()=>sC()),nA(()=>iA())]),Nv(),gn]};function gV(n,e){if(n&1){let t=gt();p(0,"li",8)(1,"button",13),ne("click",function(){ye(t);let r=Z(2);return ve(r.goTo("profil"))}),W(2,"i",15),m()()}}function _V(n,e){if(n&1){let t=gt();ge(0,gV,3,0,"li",8),p(1,"li",8)(2,"button",13),ne("click",function(){ye(t);let r=Z();return ve(r.goTo("dash"))}),W(3,"i",14),m()()}if(n&2){let t=Z();me(0,t.firstLetterName?0:-1)}}function yV(n,e){if(n&1){let t=gt();p(0,"li",10),ne("click",function(){ye(t);let r=Z();return ve(r.goTo("login"))}),p(1,"a",11),y(2,"Se connecter"),m()(),p(3,"li",10),ne("click",function(){ye(t);let r=Z();return ve(r.goTo("inscription"))}),p(4,"a",11),y(5,"S'inscrire"),m()()}}var aA=(()=>{class n{constructor(){this.router=Q(kt),this.authService=Q(bo),this.connectVisible="d-bloc"}goTo(t){this.router.navigate(["/"+t]),console.log("heee")}ngOnInit(){this.authService.user$.subscribe(t=>{t?(this.authService.currentUserSig.set({email:t.email,nom:t.displayName,id:t.uid}),this.idUser=t.uid,this.connectVisible="d-none",this.firstLetterName=t.displayName[0]):this.authService.currentUserSig.set(null)})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-navbar"]],standalone:!0,features:[Me],decls:17,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-light","fixed-top",2,"background-color","#e3f2fd"],[1,"container-fluid"],["href","#",1,"navbar-brand"],["src","../../assets/logo ksc xchange t.png",1,"img-logo"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown","aria-controls","navbarNavDropdown","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNavDropdown",1,"collapse","navbar-collapse"],[1,"navbar-nav","w-100"],[1,"nav-item"],[1,"nav-link",3,"click"],[1,"nav-item",3,"click"],[1,"nav-link"],[1,"d-flex"],[1,"btn-connect","seeDesc",3,"click"],[1,"bi","bi-house-door-fill"],[1,"bi","bi-person"]],template:function(i,r){i&1&&(p(0,"nav",0)(1,"div",1)(2,"a",2),W(3,"img",3),m(),p(4,"button",4),W(5,"span",5),m(),p(6,"div",6)(7,"ul",7)(8,"li",8)(9,"a",9),ne("click",function(){return r.goTo("")}),y(10,"Acceuil"),m()(),p(11,"li",10),ne("click",function(){return r.goTo("contact")}),p(12,"a",11),y(13,"Contact"),m()(),ge(14,_V,4,1,"li",8)(15,yV,6,0),W(16,"div",12),m()()()()),i&2&&(S(14),me(14,r.idUser?14:-1),S(),me(15,r.firstLetterName?-1:15))},styles:["nav[_ngcontent-%COMP%]{height:60px}.img-logo[_ngcontent-%COMP%]{width:4rem;height:40px;object-fit:contain}.nav-link[_ngcontent-%COMP%]{color:#016070;font-weight:700;cursor:pointer}.nav-link.active[_ngcontent-%COMP%]{color:#1e1c2e}.navbar-nav[_ngcontent-%COMP%]{display:flex;justify-content:right}.nav-item[_ngcontent-%COMP%]{margin:0 2rem}.btn-connect[_ngcontent-%COMP%]{width:2rem;height:2rem;padding:.2rem;border-radius:50%;text-transform:capitalize;background-color:#1e1c2e;color:#fff;font-size:14px;border:none;transition:all .3s ease-in-out}.btn-connect[_ngcontent-%COMP%]:hover{background-color:#135a13}"]})}}return n})();var cA=(()=>{class n{static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-footer"]],standalone:!0,features:[Me],decls:15,vars:0,consts:[[1,"footer"],[1,"footer__parralax"],[1,"footer__parralax-trees"],[1,"footer__parralax-moto"],[1,"footer__parralax-secondplan"],[1,"footer__parralax-premierplan"],[1,"footer__parralax-voiture"],[1,"container"],[1,"footer__copyrights"],["href","https://twitter.com/silvereledev","target","_blank"],[1,"text-white-50"]],template:function(i,r){i&1&&(p(0,"footer",0)(1,"div",1),W(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),m(),p(7,"div",7)(8,"div",8)(9,"p"),y(10,"R\xE9alis\xE9 par "),p(11,"a",9),y(12,"NDZITE NSEGUET STEVIN"),m()(),p(13,"p",10),y(14,"+237 698 60 45 45"),m()()()())},styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%}body[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;display:flex;flex-direction:column;padding-top:300px}.container[_ngcontent-%COMP%]{width:100%;max-width:1600px;margin:0 auto}.footer[_ngcontent-%COMP%]{position:relative;padding:3rem 0;color:#fff;background:#000;margin-top:auto}.footer__columns[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.footer__col-title[_ngcontent-%COMP%]{font-size:1.6rem;margin-bottom:2rem;text-transform:uppercase;display:flex;align-items:center}.footer__col-title[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] ~ span[_ngcontent-%COMP%]{margin-left:1rem}.footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;text-decoration:none}.footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   *[_ngcontent-%COMP%] ~ span[_ngcontent-%COMP%]{margin-left:1rem}.footer__nav-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.footer__copyrights[_ngcontent-%COMP%]{padding-top:3rem;margin-top:3rem;border-top:1px solid rgba(255,255,255,.2)}.footer__copyrights[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex}.footer__copyrights[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:.5rem}@keyframes _ngcontent-%COMP%_parralax{0%{background-position:260px}to{background-position:-10000vw}}@keyframes _ngcontent-%COMP%_moto{0%{transform:translateY(0) rotate(0)}5%{transform:translateY(0) rotate(-5deg)}25%{transform:translateY(60px) rotate(-20deg)}49%{transform:translateY(0) rotate(-1deg)}51%{transform:translateY(0) rotate(1deg)}75%{transform:translateY(60px) rotate(20deg)}80%{transform:translateY(60px) rotate(0)}98%{transform:translateY(0) rotate(0)}}@keyframes _ngcontent-%COMP%_voiture{0%{transform:rotate(0)}25%{transform:rotate(-5deg)}50%{transform:rotate(0)}75%{transform:rotate(5deg)}to{transform:rotate(0)}}.footer__parralax[_ngcontent-%COMP%]{position:absolute;left:0;top:-300px;height:300px;width:100%;overflow:hidden}.footer__parralax-premierplan[_ngcontent-%COMP%]{background-position:260px}.footer__parralax-trees[_ngcontent-%COMP%], .footer__parralax-premierplan[_ngcontent-%COMP%], .footer__parralax-secondplan[_ngcontent-%COMP%]{position:absolute;inset:0;background-repeat:repeat-x;background-position-y:100%!important;animation:_ngcontent-%COMP%_parralax 600s linear infinite}.footer__parralax-moto[_ngcontent-%COMP%]{position:absolute;bottom:80px;left:50%;margin-left:-250px;height:200px;width:150px;background:url(https://i.ibb.co/JCGfFJd/moto-net.gif);background-repeat:no-repeat;transform-origin:50% 80%;animation:_ngcontent-%COMP%_moto 5s linear infinite}.footer__parralax-voiture[_ngcontent-%COMP%]{position:absolute;bottom:10px;left:50%;margin-left:250px;height:114px;width:206px;background:url(https://i.ibb.co/0Qhp4DN/voiture-fumee.gif);background-repeat:no-repeat;animation:_ngcontent-%COMP%_voiture 1s linear infinite}.footer__parralax-trees[_ngcontent-%COMP%]{background-image:url(https://i.ibb.co/nQM4PGJ/arbres.png);bottom:-60px;animation-duration:1000s}.footer__parralax-premierplan[_ngcontent-%COMP%]{background-image:url(https://i.ibb.co/RQhDWbk/premierplanv3.png);animation-duration:500s}.footer__parralax-secondplan[_ngcontent-%COMP%]{background-image:url(https://i.ibb.co/J3TjC4W/second-plan.png);animation-duration:600s}"]})}}return n})();var lA=(()=>{class n{constructor(){this.title="kscXchange"}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=De({type:n,selectors:[["app-root"]],standalone:!0,features:[Me],decls:4,vars:0,consts:[[1,"main"]],template:function(i,r){i&1&&W(0,"app-navbar")(1,"main",0)(2,"router-outlet")(3,"app-footer")},dependencies:[Wf,aA,cA],styles:["*[_ngcontent-%COMP%]{padding:0;margin:0}.main[_ngcontent-%COMP%]{padding-top:60px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:15px}[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#d1e5ff}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(#642bff,#90ebf1)}"]})}}return n})();qv(lA,oA).catch(n=>console.error(n));
